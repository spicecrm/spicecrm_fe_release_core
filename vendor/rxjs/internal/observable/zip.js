"use strict";var __extends=this&&this.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var fromArray_1=require("./fromArray"),isArray_1=require("../util/isArray"),Subscriber_1=require("../Subscriber"),OuterSubscriber_1=require("../OuterSubscriber"),subscribeToResult_1=require("../util/subscribeToResult"),iterator_1=require("../../internal/symbol/iterator");function zip(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];return"function"==typeof r&&t.pop(),fromArray_1.fromArray(t,void 0).lift(new ZipOperator(r))}exports.zip=zip;var ZipOperator=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new ZipSubscriber(t,this.resultSelector))},t}();exports.ZipOperator=ZipOperator;var ZipSubscriber=function(o){function t(t,e,r){void 0===r&&(r=Object.create(null));var i=o.call(this,t)||this;return i.iterators=[],i.active=0,i.resultSelector="function"==typeof e?e:null,i.values=r,i}return __extends(t,o),t.prototype._next=function(t){var e=this.iterators;isArray_1.isArray(t)?e.push(new StaticArrayIterator(t)):"function"==typeof t[iterator_1.iterator]?e.push(new StaticIterator(t[iterator_1.iterator]())):e.push(new ZipBufferIterator(this.destination,this,t))},t.prototype._complete=function(){var t=this.iterators,e=t.length;if(this.unsubscribe(),0!==e){this.active=e;for(var r=0;r<e;r++){var i=t[r];if(i.stillUnsubscribed)this.destination.add(i.subscribe(i,r));else this.active--}}else this.destination.complete()},t.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},t.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,r=this.destination,i=0;i<e;i++){if("function"==typeof(s=t[i]).hasValue&&!s.hasValue())return}var o=!1,n=[];for(i=0;i<e;i++){var s,u=(s=t[i]).next();if(s.hasCompleted()&&(o=!0),u.done)return void r.complete();n.push(u.value)}this.resultSelector?this._tryresultSelector(n):r.next(n),o&&r.complete()},t.prototype._tryresultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},t}(Subscriber_1.Subscriber);exports.ZipSubscriber=ZipSubscriber;var StaticIterator=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return t&&t.done},t}(),StaticArrayIterator=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[iterator_1.iterator]=function(){return this},t.prototype.next=function(t){var e=this.index++,r=this.array;return e<this.length?{value:r[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),ZipBufferIterator=function(o){function t(t,e,r){var i=o.call(this,t)||this;return i.parent=e,i.observable=r,i.stillUnsubscribed=!0,i.buffer=[],i.isComplete=!1,i}return __extends(t,o),t.prototype[iterator_1.iterator]=function(){return this},t.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},t.prototype.hasValue=function(){return 0<this.buffer.length},t.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},t.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},t.prototype.notifyNext=function(t,e,r,i,o){this.buffer.push(e),this.parent.checkIterators()},t.prototype.subscribe=function(t,e){return subscribeToResult_1.subscribeToResult(this,this.observable,this,e)},t}(OuterSubscriber_1.OuterSubscriber);