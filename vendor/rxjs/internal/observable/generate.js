"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable"),identity_1=require("../util/identity"),isScheduler_1=require("../util/isScheduler");function generate(e,c,o,r,n){var a,d;if(1==arguments.length){var t=e;d=t.initialState,c=t.condition,o=t.iterate,a=t.resultSelector||identity_1.identity,n=t.scheduler}else void 0===r||isScheduler_1.isScheduler(r)?(d=e,a=identity_1.identity,n=r):(d=e,a=r);return new Observable_1.Observable(function(r){var e=d;if(n)return n.schedule(dispatch,0,{subscriber:r,iterate:o,condition:c,resultSelector:a,state:e});for(;;){if(c){var t=void 0;try{t=c(e)}catch(e){return void r.error(e)}if(!t){r.complete();break}}var i=void 0;try{i=a(e)}catch(e){return void r.error(e)}if(r.next(i),r.closed)break;try{e=o(e)}catch(e){return void r.error(e)}}})}function dispatch(e){var r=e.subscriber,t=e.condition;if(!r.closed){if(e.needIterate)try{e.state=e.iterate(e.state)}catch(e){return void r.error(e)}else e.needIterate=!0;if(t){var i=void 0;try{i=t(e.state)}catch(e){return void r.error(e)}if(!i)return void r.complete();if(r.closed)return}var c;try{c=e.resultSelector(e.state)}catch(e){return void r.error(e)}if(!r.closed&&(r.next(c),!r.closed))return this.schedule(e)}}exports.generate=generate;