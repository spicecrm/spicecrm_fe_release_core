"use strict";var __extends=this&&this.__extends||function(){var i=function(t,r){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)};return function(t,r){function n(){this.constructor=t}i(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var map_1=require("./map"),from_1=require("../observable/from"),innerSubscribe_1=require("../innerSubscribe");function switchMap(r,e){return"function"==typeof e?function(t){return t.pipe(switchMap(function(n,i){return from_1.from(r(n,i)).pipe(map_1.map(function(t,r){return e(n,t,i,r)}))}))}:function(t){return t.lift(new SwitchMapOperator(r))}}exports.switchMap=switchMap;var SwitchMapOperator=function(){function t(t){this.project=t}return t.prototype.call=function(t,r){return r.subscribe(new SwitchMapSubscriber(t,this.project))},t}(),SwitchMapSubscriber=function(i){function t(t,r){var n=i.call(this,t)||this;return n.project=r,n.index=0,n}return __extends(t,i),t.prototype._next=function(t){var r,n=this.index++;try{r=this.project(t,n)}catch(t){return void this.destination.error(t)}this._innerSub(r)},t.prototype._innerSub=function(t){var r=this.innerSubscription;r&&r.unsubscribe();var n=new innerSubscribe_1.SimpleInnerSubscriber(this),i=this.destination;i.add(n),this.innerSubscription=innerSubscribe_1.innerSubscribe(t,n),this.innerSubscription!==n&&i.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||i.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&i.prototype._complete.call(this)},t.prototype.notifyNext=function(t){this.destination.next(t)},t}(innerSubscribe_1.SimpleOuterSubscriber);