"use strict";var __extends=this&&this.__extends||function(){var i=function(t,r){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(t,r)};return function(t,r){function e(){this.constructor=t}i(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}();Object.defineProperty(exports,"__esModule",{value:!0});var OuterSubscriber_1=require("../OuterSubscriber"),InnerSubscriber_1=require("../InnerSubscriber"),subscribeToResult_1=require("../util/subscribeToResult"),map_1=require("./map"),from_1=require("../observable/from");function switchMap(r,n){return"function"==typeof n?function(t){return t.pipe(switchMap(function(e,i){return from_1.from(r(e,i)).pipe(map_1.map(function(t,r){return n(e,t,i,r)}))}))}:function(t){return t.lift(new SwitchMapOperator(r))}}exports.switchMap=switchMap;var SwitchMapOperator=function(){function t(t){this.project=t}return t.prototype.call=function(t,r){return r.subscribe(new SwitchMapSubscriber(t,this.project))},t}(),SwitchMapSubscriber=function(i){function t(t,r){var e=i.call(this,t)||this;return e.project=r,e.index=0,e}return __extends(t,i),t.prototype._next=function(t){var r,e=this.index++;try{r=this.project(t,e)}catch(t){return void this.destination.error(t)}this._innerSub(r,t,e)},t.prototype._innerSub=function(t,r,e){var i=this.innerSubscription;i&&i.unsubscribe();var n=new InnerSubscriber_1.InnerSubscriber(this,r,e),o=this.destination;o.add(n),this.innerSubscription=subscribeToResult_1.subscribeToResult(this,t,void 0,void 0,n),this.innerSubscription!==n&&o.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||i.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=null},t.prototype.notifyComplete=function(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&i.prototype._complete.call(this)},t.prototype.notifyNext=function(t,r,e,i,n){this.destination.next(r)},t}(OuterSubscriber_1.OuterSubscriber);