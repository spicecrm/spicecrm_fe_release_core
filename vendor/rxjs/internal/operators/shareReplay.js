"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ReplaySubject_1=require("../ReplaySubject");function shareReplay(e,r,t){var u;return u=e&&"object"==typeof e?e:{bufferSize:e,windowTime:r,refCount:!1,scheduler:t},function(e){return e.lift(shareReplayOperator(u))}}function shareReplayOperator(e){var t,u,r=e.bufferSize,n=void 0===r?Number.POSITIVE_INFINITY:r,i=e.windowTime,o=void 0===i?Number.POSITIVE_INFINITY:i,c=e.refCount,a=e.scheduler,s=0,b=!1,f=!1;return function(e){s++,t&&!b||(b=!1,t=new ReplaySubject_1.ReplaySubject(n,o,a),u=e.subscribe({next:function(e){t.next(e)},error:function(e){b=!0,t.error(e)},complete:function(){f=!0,u=void 0,t.complete()}}));var r=t.subscribe(this);this.add(function(){s--,r.unsubscribe(),u&&!f&&c&&0===s&&(u.unsubscribe(),t=u=void 0)})}}exports.shareReplay=shareReplay;