/*
SpiceUI 2018.10.001

Copyright (c) 2016-present, aac services.k.s - All rights reserved.
Redistribution and use in source and binary forms, without modification, are permitted provided that the following conditions are met:
- Redistributions of source code must retain this copyright and license notice, this list of conditions and the following disclaimer.
- Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
- If used the SpiceCRM Logo needs to be displayed in the upper left corner of the screen in a minimum dimension of 31x31 pixels and be clearly visible, the icon needs to provide a link to http://www.spicecrm.io
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*/

"use strict";var __extends=this&&this.__extends||function(){var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(e,t)};return function(e,t){function s(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,s=1,l=arguments.length;s<l;s++)for(var o in t=arguments[s])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__decorate=this&&this.__decorate||function(e,t,s,l){var o,i=arguments.length,a=i<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,s,l);else for(var n=e.length-1;0<=n;n--)(o=e[n])&&(a=(i<3?o(a):3<i?o(t,s,a):o(t,s))||a);return 3<i&&a&&Object.defineProperty(t,s,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var common_1=require("@angular/common"),core_1=require("@angular/core"),forms_1=require("@angular/forms"),rxjs_1=require("rxjs"),services_1=require("../services/services"),services_2=require("../services/services"),services_3=require("../services/services"),services_4=require("../services/services"),services_5=require("../services/services"),services_6=require("../services/services"),services_7=require("../services/services"),services_8=require("../services/services"),services_9=require("../services/services"),services_10=require("../services/services"),services_11=require("../services/services"),services_12=require("../services/services"),services_13=require("../services/services"),services_14=require("../services/services"),services_15=require("../services/services"),systemcomponents_1=require("../systemcomponents/systemcomponents"),directives_1=require("../directives/directives"),objectfields_1=require("../objectfields/objectfields"),globalcomponents_1=require("../globalcomponents/globalcomponents"),BasicReferenceForm=function(){function e(e){var t=this;this.backend=e,this.package_names=[],this.version_names=[],this.is_pulling=!1,this.is_loading_availabilities=!0,this.load$=new core_1.EventEmitter,this.available_packages=[],this.available_versions=[],this.available_languages=[],this.backend.getRequest("/reference").subscribe(function(e){t.is_loading_availabilities=!1;try{t.available_languages=e.languages,t.available_packages=e.packages,t.available_versions=e.versions}catch(e){console.error(e)}},function(e){t.is_loading_availabilities=!1,console.log(e)})}return __decorate([core_1.Output("load"),__metadata("design:type",Object)],e.prototype,"load$",void 0),e}();exports.BasicReferenceForm=BasicReferenceForm;var DomainManager=function(){function DomainManager(e,t,s,l,o,i){var a=this;this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.broadcast=o,this.toast=i,this.currentDomain="",this.domains=[],this.currentField="",this.backend.getRequest("dictionary/domains").subscribe(function(e){a.domains=e})}return DomainManager.prototype.reset=function(){this.currentField=""},DomainManager.prototype.selectItem=function(e){this.currentField=e},DomainManager.prototype.isSelected=function(e){return this.currentField===e},DomainManager.prototype.getDomainFields=function(){var t=this,s=[];return this.domains.some(function(e){if(e.id==t.currentDomain)return s=e.technicalFields,!0}),s},DomainManager.prototype.showDetails=function(){return this.currentDomain&&this.currentField},DomainManager.prototype.getCurrentField=function(){var t=this,s={};return this.domains.some(function(e){if(e.id==t.currentDomain)return e.technicalFields.some(function(e){if(e.id===t.currentField)return s=e,!0}),!0}),s},DomainManager=__decorate([core_1.Component({template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><label class="slds-form-element__label">Domain</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentDomain" (change)="reset()"><option *ngFor="let domain of domains" [value]="domain.id">{{domain.name}}</option></select></div></div></div><div class="slds-form-element slds-col--bump-left"><button type="button" class="slds-button slds-button--neutral">{{language.getLabel(\'LBL_ADD\')}}</button> <button type="button" class="slds-button slds-button--brand">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div><div class="slds-grid"><div class="slds-size--2-of-5 slds-p-horizontal--small slds-p-top--x-small slds-border--right"><div class="slds-tree_container" role="application" style="max-width: none;"><ul class="slds-tree" role="tree" aria-labelledby="treeheading"><li *ngFor="let domainField of getDomainFields()" role="treeitem" aria-level="1" (click)="selectItem(domainField.id)" [ngClass]="{\'slds-theme--shade\' : isSelected(domainField.id)}"><div class="slds-tree__item slds-grid slds-grid--align-spread slds-grid--vertical-align-center"><a href="javascript:void(0);" role="presentation" class="slds-truncate">{{domainField.name}}</a><div><button class="slds-button slds-button--icon" title="unlink item"><system-button-icon [icon]="\'remove_link\'"></system-button-icon></button></div></div></li></ul></div></div><div class="slds-size--3-of-5 slds-p-horizontal--small slds-p-top--x-small"><domainmanager-field-details *ngIf="showDetails()" [field]="getCurrentField()"></domainmanager-field-details></div></div>',providers:[services_1.metadata]}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_5.broadcast,services_9.toast])],DomainManager)}();exports.DomainManager=DomainManager;var DomainManagerFieldDetails=function(){function e(e,t,s){this.backend=e,this.metadata=t,this.language=s,this.field={}}return __decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"field",void 0),e=__decorate([core_1.Component({selector:"domainmanager-field-details",template:'<div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Name</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="field.name"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Source</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="field.source"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Type</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="field.field_type"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">DB Type</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="field.db_type"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Length</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="field.field_len"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Precision</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="field.field_precision"></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language])],e)}();exports.DomainManagerFieldDetails=DomainManagerFieldDetails;var DictionaryManager=function(){function DictionaryManager(e,t,s,l,o,i){var a=this;this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.broadcast=o,this.toast=i,this.currentDictionaryTable="",this.dictionaryTables=[],this.dictionaryDomains=[],this.displayFilters=!1,this.filters={},this.displayFields=[{name:"name",type:"string"},{name:"sysdictdomains_id",type:"domain"},{name:"vname",type:"string"},{name:"prefix",type:"string"},{name:"duplicate_merge",type:"string"},{name:"status",type:"string"}],this.backend.getRequest("dictionary/tables").subscribe(function(e){a.dictionaryTables=e}),this.backend.getRequest("dictionary/domains").subscribe(function(e){a.dictionaryDomains=e})}return DictionaryManager.prototype.getFields=function(){},DictionaryManager.prototype.toggleFilter=function(){this.displayFilters=!this.displayFilters},DictionaryManager.prototype.clearFilter=function(){this.filters={}},DictionaryManager.prototype.getEntries=function(){var a=this,n=[];return this.dictionaryTables.some(function(e){if(e.id===a.currentDictionaryTable){for(var t=0,s=e.tablesFields;t<s.length;t++){var l=s[t],o=!1;if(a.displayFilters)for(var i in a.filters)a.filters[i]&&l[i]&&-1==l[i].indexOf(a.filters[i])&&(o=!0);o||n.push(l)}return!0}}),n},DictionaryManager=__decorate([core_1.Component({template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><label class="slds-form-element__label">table</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentDictionaryTable"><option *ngFor="let dictionaryTable of dictionaryTables" [value]="dictionaryTable.id">{{dictionaryTable.table_name}}</option></select></div></div></div><div class="slds-form-element slds-col--bump-left"><button type="button" class="slds-button slds-button--neutral">{{language.getLabel(\'LBL_ADD\')}}</button> <button type="button" class="slds-button slds-button--brand">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div><table *ngIf="currentDictionaryTable" class="slds-table slds-table--bordered slds-table--cell-buffer"><thead><tr class="slds-text-title--caps"><th *ngFor="let field of displayFields" scope="col" (click)="sort(field.name)"><div class="slds-truncate slds-p-horizontal--small">{{field.name}}</div></th><th scope="col" style="width:2rem;"><div class="slds-button-group slds-float--right" role="group"><button class="slds-button slds-button--icon-border" (click)="toggleFilter()"><system-button-icon [icon]="\'filterList\'" [size]="\'small\'"></system-button-icon></button></div></th></tr></thead><tbody><tr *ngIf="displayFilters" class="slds-theme--shade"><td *ngFor="let field of displayFields"><div class="slds-form-element"><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="filters[field.name]"></div></div></td><td><div class="slds-button-group slds-float--right" role="group"><button class="slds-button slds-button--icon-border" (click)="clearFilter()"><system-button-icon [icon]="\'clear\'" [size]="\'small\'"></system-button-icon></button> <button class="slds-button slds-button--icon-border" (click)="toggleFilter()"><system-button-icon [icon]="\'chevronup\'" [size]="\'small\'"></system-button-icon></button></div></td></tr><tr dictionarymanager-item *ngFor="let entry of getEntries()" [entry]="entry" [fields]="displayFields" [domains]="dictionaryDomains"></tr></tbody></table>',providers:[services_1.metadata]}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_5.broadcast,services_9.toast])],DictionaryManager)}();exports.DictionaryManager=DictionaryManager;var DictionaryManagerItem=function(){function e(e){this.view=e,this.fields=[],this.entry={},this.domains={}}return e.prototype.setEditMode=function(){this.view.setEditMode()},e.prototype.isEditMode=function(){return this.view.isEditMode()},e.prototype.setViewMode=function(){this.view.setViewMode()},e.prototype.save=function(){},e.prototype.delete=function(){},__decorate([core_1.Input(),__metadata("design:type",Array)],e.prototype,"fields",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"entry",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"domains",void 0),e=__decorate([core_1.Component({selector:"[dictionarymanager-item]",template:'<td *ngFor="let field of fields"><dictionarymanager-item-string *ngIf="field.type == \'string\'" [entry]="entry" [field]="field"></dictionarymanager-item-string><dictionarymanager-item-domain *ngIf="field.type == \'domain\'" [entry]="entry" [field]="field" [domains]="domains"></dictionarymanager-item-domain></td><td><div *ngIf="!isEditMode()" class="slds-button-group slds-float--right" role="group"><button class="slds-button slds-button--icon-border" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'" [size]="\'small\'"></system-button-icon></button> <button class="slds-button slds-button--icon-border" (click)="delete()"><system-button-icon [icon]="\'delete\'" [size]="\'small\'"></system-button-icon></button></div><div *ngIf="isEditMode()" class="slds-button-group slds-float--right" role="group"><button class="slds-button slds-button--icon-border" (click)="setViewMode()"><system-button-icon [icon]="\'close\'" [size]="\'small\'"></system-button-icon></button> <button class="slds-button slds-button--icon-border" (click)="save()"><system-button-icon [icon]="\'check\'" [size]="\'small\'"></system-button-icon></button></div></td>',providers:[services_7.view]}),__metadata("design:paramtypes",[services_7.view])],e)}();exports.DictionaryManagerItem=DictionaryManagerItem;var DictionaryManagerItemString=function(){function e(e){this.view=e,this.entry={},this.field={}}return e.prototype.isEditMode=function(){return this.view.isEditMode()},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"entry",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"field",void 0),e=__decorate([core_1.Component({selector:"dictionarymanager-item-string",template:'<div *ngIf="!isEditMode();else editfield" class="slds-truncate slds-p-horizontal--small">{{entry[field.name]}}</div><ng-template #editfield><div class="slds-form-element"><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="entry[field.name]"></div></div></ng-template>'}),__metadata("design:paramtypes",[services_7.view])],e)}();exports.DictionaryManagerItemString=DictionaryManagerItemString;var DictionaryManagerItemDomain=function(){function e(e){this.view=e,this.entry={},this.field={},this.domains={}}return Object.defineProperty(e.prototype,"domainname",{get:function(){var t=this,s="";return this.domains.some(function(e){if(e.id==t.entry[t.field.name])return s=e.name,!0}),s},set:function(e){},enumerable:!0,configurable:!0}),e.prototype.isEditMode=function(){return this.view.isEditMode()},e.prototype.getDomainArray=function(){for(var e=[],t=0,s=this.domains;t<s.length;t++){var l=s[t];e.push({id:l.id,name:l.name})}return e},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"entry",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"field",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"domains",void 0),e=__decorate([core_1.Component({selector:"dictionarymanager-item-domain",template:'<div *ngIf="!isEditMode();else editfield" class="slds-truncate slds-p-horizontal--small">{{domainname}}</div><ng-template #editfield><div class="slds-form-element"><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="entry[field.name]"><option *ngFor="let domain of getDomainArray()" [value]="domain.id">{{domain.name}}</option></select></div></div></div></ng-template>'}),__metadata("design:paramtypes",[services_7.view])],e)}();exports.DictionaryManagerItemDomain=DictionaryManagerItemDomain;var FieldsetManager=function(){function FieldsetManager(e,t,s,l,o,i,a,n,d,r){var c=this;this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.broadcast=o,this.toast=i,this.modalservice=a,this.configurationService=n,this.view=d,this.modal=r,this.edit_mode="custom",this.allowBarButtons=!0,this.crNoneActive=!1,this.change_request_required=!1,this.sysModules=[],this.currentModule="*",this.currentFieldSet="",this.currentFieldSetItems=[],this.selectedItem={type:"",fieldset:"",id:"",isViewMode:!1},this.showFieldSetDetails=!1,this.backend.getRequest("spiceui/admin/modules").subscribe(function(e){c.sysModules=e,c.metadata.loadFieldSets(new rxjs_1.Subject,!0),c.metadata.loadFieldDefs(new rxjs_1.Subject,!0),c.metadata.loadComponents(new rxjs_1.Subject,!0)}),this.checkMode()}return Object.defineProperty(FieldsetManager.prototype,"currentFieldSetName",{get:function(){return this.metadata.getFieldset(this.currentFieldSet).name},set:function(e){this.metadata.setFieldset(this.currentFieldSet,{name:e,package:this.currentFieldSetPackage})},enumerable:!0,configurable:!0}),Object.defineProperty(FieldsetManager.prototype,"currentFieldSetPackage",{get:function(){return this.metadata.getFieldset(this.currentFieldSet).package},set:function(e){this.metadata.setFieldset(this.currentFieldSet,{name:this.currentFieldSetName,package:e})},enumerable:!0,configurable:!0}),Object.defineProperty(FieldsetManager.prototype,"showDetailIcon",{get:function(){return this.showFieldSetDetails?"chevronup":"chevrondown"},enumerable:!0,configurable:!0}),FieldsetManager.prototype.toggleDetail=function(){this.showFieldSetDetails=!this.showFieldSetDetails},Object.defineProperty(FieldsetManager.prototype,"fieldSetType",{get:function(){return this.currentFieldSet?this.metadata.getFieldset(this.currentFieldSet).type:""},enumerable:!0,configurable:!0}),FieldsetManager.prototype.getFieldSets=function(e){if(void 0===e&&(e=void 0),e){for(var t=[],s=0,l=this.metadata.getFieldSets(this.currentModule);s<l.length;s++){var o=l[s];o.type==e&&t.push(o)}return t}return this.metadata.getFieldSets(this.currentModule)},FieldsetManager.prototype.checkMode=function(){var t=this;this.edit_mode=this.configurationService.getCapabilityConfig("core").edit_mode,this.change_request_required=!!this.configurationService.getCapabilityConfig("systemdeployment").change_request_required,"none"!=this.edit_mode&&"custom"!=this.edit_mode&&"all"!=this.edit_mode&&(this.edit_mode="custom"),this.change_request_required?this.backend.getRequest("systemdeploymentcrs/active").subscribe(function(e){""==e.id?(t.setNoneMode(),t.crNoneActive=!0,t.toast.sendToast(t.language.getLabel("LBL_ACTIVATE_CR_WARNING"),"warning",null,3)):(t.crNoneActive=!1,"all"==t.edit_mode?t.setAllMode():"custom"==t.edit_mode?t.setCustomMode():t.setNoneMode())}):(this.crNoneActive=!1,"all"==this.edit_mode?this.setAllMode():"custom"==this.edit_mode?this.setCustomMode():this.setNoneMode())},FieldsetManager.prototype.setNoneMode=function(){this.view.setViewMode(),this.allowBarButtons=!1},FieldsetManager.prototype.setCustomMode=function(){"custom"==this.fieldSetType?this.view.setEditMode():this.view.setViewMode()},FieldsetManager.prototype.setAllMode=function(){this.view.setEditMode()},FieldsetManager.prototype.loadCurrentFieldset=function(){this.selectedItem={type:"",fieldset:"",id:""},this.checkMode(),this.currentFieldSetItems=[],this.addFieldSetItems(this.currentFieldSet,0,this.fieldSetType)},FieldsetManager.prototype.addItem=function(t){var s=this;void 0===t&&(t=""),this.modalservice.openModal("FieldsetManagerAddDialog").subscribe(function(e){e.instance.metadata=s.metadata,e.instance.module=s.currentModule,e.instance.fieldsettype=s.fieldSetType,e.instance.edit_mode=s.edit_mode,e.instance.parent=t||s.currentFieldSet,e.instance.closedialog.subscribe(function(e){e&&s.loadCurrentFieldset()})})},FieldsetManager.prototype.unlinkItem=function(e){this.metadata.removeFieldsetItem(e.fieldset,e.item)&&(this.selectedItem={type:"",fieldset:"",id:""},this.loadCurrentFieldset())},FieldsetManager.prototype.editFieldset=function(){var s=this;this.modalservice.openModal("FieldsetManagerEditDialog").subscribe(function(e){e.instance.fieldset=s.currentFieldSet,e.instance.edit_mode=s.edit_mode,e.instance.closedialog.subscribe(function(e){if(!1!==e){if(""!=s.currentFieldSet)s.metadata.setFieldset(s.currentFieldSet,{name:e.name,type:e.type});else{var t=s.modelutilities.generateGuid();s.metadata.addFieldset(t,s.currentModule,e.name,e.type),s.currentFieldSet=t}s.checkMode()}})})},FieldsetManager.prototype.addFieldset=function(){this.currentFieldSet="",this.currentFieldSetItems=[],this.editFieldset()},FieldsetManager.prototype.reset=function(){this.currentFieldSet="",this.currentFieldSetItems=[],this.selectedItem={type:"",fieldset:"",id:""}},FieldsetManager.prototype.addFieldSetItems=function(a,n,d){var r=this;void 0===n&&(n=0),void 0===d&&(d="global");var c=this.metadata.getFieldSetFields(a);c.forEach(function(e,t){var s=!1;if("custom"!=r.edit_mode||r.crNoneActive?("none"==r.edit_mode||r.crNoneActive)&&(s=!0):"global"==d&&(s=!0),e.field){var l={level:n+1,type:"field",fieldset:a,id:e.id,name:e.field,index:t,count:c.length,item:e,parentScope:d,customModeGlobalField:s};r.currentFieldSetItems.push(l)}else if(e.fieldset){var o=!1;if("custom"!=r.edit_mode||r.crNoneActive)("none"==r.edit_mode||r.crNoneActive)&&(o=!0);else{var i=r.metadata.getFieldset(e.fieldset);i&&"global"==i.type&&(o=!0)}l={level:n+1,type:"fieldset",fieldset:a,id:e.id,name:r.metadata.getFieldsetName(e.fieldset),index:t,count:c.length,item:e,parentScope:d,customModeGlobalField:o};r.currentFieldSetItems.push(l),r.addFieldSetItems(e.fieldset,n+1,r.getDisplayType(l))}})},FieldsetManager.prototype.getDisplayName=function(e){return"field"==e.type?e.item.field:"fieldset"==e.type?this.metadata.getFieldsetName(e.item.fieldset):void 0},FieldsetManager.prototype.getDisplayType=function(e){if("fieldset"==e.type){var t=this.metadata.getFieldset(e.item.fieldset);if(t)return t.type}},FieldsetManager.prototype.isSelected=function(e){return e==this.selectedItem.id},FieldsetManager.prototype.selectItem=function(e,t){this.selectedItem={type:e.type,fieldset:e.fieldset,id:e.id,isViewMode:e.customModeGlobalField}},FieldsetManager.prototype.moveDown=function(s){var e=this.metadata.getFieldSetFields(s.fieldset),l=0;if(e.some(function(e,t){if(e.id==s.id)return l=t,!0}),l<e.length-1){var t=e.splice(l,1);e.splice(l+1,0,t[0]);for(var o=0,i=0,a=e;i<a.length;i++){a[i].sequence=o,o++}this.loadCurrentFieldset()}},FieldsetManager.prototype.moveUp=function(s){var e=this.metadata.getFieldSetFields(s.fieldset),l=0;if(e.some(function(e,t){if(e.id==s.id)return l=t,!0}),0<l){var t=e.splice(l,1);e.splice(l-1,0,t[0]);for(var o=0,i=0,a=e;i<a.length;i++){a[i].sequence=o,o++}this.loadCurrentFieldset()}},FieldsetManager.prototype.allowEdit=function(){return""!=this.currentFieldSet},FieldsetManager.prototype.findTable=function(e){return"global"==e?{fieldsetTable:"sysuifieldsets",itemsTable:"sysuifieldsetsitems"}:{fieldsetTable:"sysuicustomfieldsets",itemsTable:"sysuicustomfieldsetsitems"}},FieldsetManager.prototype.copy=function(t,m){var g=this;void 0===t&&(t=this.currentFieldSet),void 0===m&&(m=null),this.modalservice.openModal("FieldsetManagerCopyDialog").subscribe(function(e){e.instance.fieldset=t,e.instance.sysModules=g.sysModules,e.instance.metaFieldSets=g.metadata.getAllFieldsets(),e.instance.edit_mode=g.edit_mode,e.instance.closedialog.subscribe(function(t){g.modal.openModal("SystemLoadingModal").subscribe(function(d){var r=__assign({},t.fieldset),c=t.module,u=t.type,p=t.name;"*"==c&&(c="global");var e={module:c,type:u,name:p};g.backend.getRequest("spiceui/core/fieldsetalreadyexists",e).subscribe(function(e){if(0==e){var i=g.findTable(u);"global"==(r.module=c)&&(r.module="*"),r.name=p;var t=g.modelutilities.generateGuid();r.id=t;for(var a=[],s=0,l=r.items;s<l.length;s++){var o=l[s],n=__assign({},o);n.fieldconfig=__assign({},o.fieldconfig),n.id=g.modelutilities.generateGuid(),n.fieldset_id=t,a.push(n)}delete r.items,delete r.type,g.backend.postRequest("configurator/"+i.fieldsetTable+"/"+r.id,null,r).subscribe(function(e){var l=0;r.items=a,r.type=u;for(var t=function(s){g.backend.postRequest("configurator/"+i.itemsTable+"/"+s.id,null,s).subscribe(function(e){if(++l==a.length)if(m){m.item.fieldset=r.id;var t=g.findTable(m.parentScope);g.backend.postRequest("configurator/"+t.itemsTable+"/"+m.id,null,m.item).subscribe(function(e){d.instance.self.destroy(),g.toast.sendToast("saved!"),g.metadata.addFieldset(r.id,r.module,r.name,u,a)},function(e){d.instance.self.destroy(),g.toast.sendAlert("saving link failed!, "+s.id),console.error(e)})}else d.instance.self.destroy(),g.toast.sendToast("saved!"),g.currentModule=r.module,g.metadata.addFieldset(r.id,r.module,r.name,u,a),g.currentFieldSet=r.id,g.currentFieldSetItems=a,g.selectedItem={},g.currentFieldSetName=r.name,g.loadCurrentFieldset()},function(e){d.instance.self.destroy(),g.toast.sendAlert("saving failed!, "+s.id),console.error(e)})},s=0,o=a;s<o.length;s++){t(o[s])}},function(e){d.instance.self.destroy(),g.toast.sendAlert("saving failed!"),console.error(e)})}else d.instance.self.destroy(),g.toast.sendAlert("Fieldset already exists!")})})})})},FieldsetManager.prototype.saveChanges=function(){var n=this;this.modal.openModal("SystemLoadingModal").subscribe(function(a){n.backend.getRequest("spiceui/core/fieldsets").subscribe(function(e){var t=n.metadata.getRawFieldSets(),s={},l={};for(var o in t)e[o]?(JSON.stringify(t[o])!==JSON.stringify(e[o])&&(l[o]=t[o]),delete e[o]):s[o]=t[o];var i={add:s,update:l,delete:e};n.backend.postRequest("spiceui/core/fieldsets",{},i).subscribe(function(e){n.broadcast.broadcastMessage("metadata.updatefieldsets",i),a.instance.self.destroy(),n.toast.sendToast("changes saved")})})})},Object.defineProperty(FieldsetManager.prototype,"getAllowCopyButton",{get:function(){return!!this.currentFieldSet&&this.allowBarButtons},enumerable:!0,configurable:!0}),FieldsetManager=__decorate([core_1.Component({template:'<div class="slds-p-around--small slds-border--bottom"><div class="slds-grid slds-grid--vertical-align-center slds-form--inline"><div class="slds-form-element"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_MODULE\')}}</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentModule" (change)="reset()" [disabled]="sysModules.length == 0"><option value="*">*</option><option *ngFor="let sysModule of sysModules" [value]="sysModule.module">{{sysModule.module}}</option></select></div></div></div><div class="slds-form-element"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_FIELDSET\')}}</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentFieldSet" (change)="loadCurrentFieldset()" [disabled]="getFieldSets().length == 0"><option></option><optgroup label="custom {{language.getAppLanglabel(\'LBL_FIELDSET\')}}" *ngIf="getFieldSets(\'custom\').length > 0"><option *ngFor="let sysFieldset of getFieldSets(\'custom\')" [value]="sysFieldset.id">{{sysFieldset.name}}</option></optgroup><optgroup label="global {{language.getAppLanglabel(\'LBL_FIELDSET\')}}" *ngIf="getFieldSets(\'global\').length > 0"><option *ngFor="let sysFieldset of getFieldSets(\'global\')" [value]="sysFieldset.id">{{sysFieldset.name}}</option></optgroup></select></div></div></div><div class="slds-form-element slds-col--bump-left"><button [disabled]="!allowBarButtons" class="slds-button slds-button--brand" (click)="copy()"><span>{{language.getAppLanglabel(\'LBL_COPY\')}}</span></button> <button [disabled]="!allowBarButtons" type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="addFieldset()"><system-utility-icon [icon]="\'add\'" [size]="\'x-small\'"></system-utility-icon></button></div></div></div><div *ngIf="currentFieldSet" class="slds-theme--default"><div class="slds-p-around--small slds-border--bottom slds-theme--default"><div class="slds-grid slds-grid--vertical-align-end"><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_SCOPE\')}}</label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left"><system-custom-icon [icon]="fieldSetType" size="x-small" addclasses="slds-input__icon slds-input__icon_left"></system-custom-icon><input type="text" disabled class="slds-input" [ngModel]="fieldSetType"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_NAME\')}}</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentFieldSetName"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_PACKAGE\')}}</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentFieldSetPackage"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_ID\')}}</label><div class="slds-form-element__control"><input type="text" disabled class="slds-input" [ngModel]="currentFieldSet"></div></div></div></div><div class="slds-grid"><div class="slds-size--3-of-5 slds-p-horizontal--small slds-p-top--x-small slds-border--right"><div class="slds-tree_container" role="application" style="max-width: none;"><ul class="slds-tree" role="tree" aria-labelledby="treeheading"><li *ngFor="let currentFieldSetItem of currentFieldSetItems" role="treeitem" [attr.aria-level]="currentFieldSetItem.level" (click)="selectItem(currentFieldSetItem, getDisplayType(currentFieldSetItem))" [ngClass]="{\'slds-theme--shade\' : isSelected(currentFieldSetItem.id)}"><div class="slds-tree__item slds-grid slds-grid--vertical-align-center"><system-custom-icon *ngIf="getDisplayType(currentFieldSetItem) != \'\'" [icon]="getDisplayType(currentFieldSetItem)" size="x-small"></system-custom-icon><div style="white-space:nowrap;"><a href="javascript:void(0);" role="presentation" class="slds-truncate">{{getDisplayName(currentFieldSetItem)}}</a></div><div class="slds-col_bump-left"><button [disabled]="!view.isEditMode() || currentFieldSetItem.type == \'field\' || currentFieldSetItem.customModeGlobalField" class="slds-button slds-button--icon" title="add item" (click)="addItem(currentFieldSetItem.item.fieldset)"><system-button-icon [icon]="\'new\'"></system-button-icon></button> <button [disabled]="!view.isEditMode() || currentFieldSetItem.type == \'field\'" class="slds-button slds-button--icon" title="customize" (click)="copy(currentFieldSetItem.item.fieldset, currentFieldSetItem)"><system-button-icon [icon]="\'copy\'"></system-button-icon></button> <button [disabled]="!view.isEditMode() || currentFieldSetItem.customModeGlobalField" class="slds-button slds-button--icon || customModeGlobalField" title="unlink item" (click)="unlinkItem(currentFieldSetItem)"><system-button-icon [icon]="\'remove_link\'"></system-button-icon></button> <button [disabled]="!view.isEditMode() || currentFieldSetItem.index + 1 == currentFieldSetItem.count || currentFieldSetItem.customModeGlobalField" class="slds-button slds-button--icon" title="move down" (click)="moveDown(currentFieldSetItem)"><system-button-icon [icon]="\'down\'"></system-button-icon></button> <button [disabled]="!view.isEditMode() || currentFieldSetItem.index == 0 || currentFieldSetItem.customModeGlobalField" class="slds-button slds-button--icon" title="move up" (click)="moveUp(currentFieldSetItem)"><system-button-icon [icon]="\'up\'"></system-button-icon></button></div></div></li></ul></div><div class="slds-p-around--small slds-align--absolute-center slds-border--top slds-m-top--small"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="add item" (click)="addItem()"><system-button-icon [icon]="\'new\'"></system-button-icon></button></div></div><div class="slds-size--2-of-5 slds-p-horizontal--small slds-p-vertical--x-small"><fieldsetmanager-fieldset-details *ngIf="selectedItem.type == \'fieldset\'" [fieldset]="selectedItem"></fieldsetmanager-fieldset-details><fieldsetmanager-field-details *ngIf="selectedItem.type == \'field\'" [field]="selectedItem"></fieldsetmanager-field-details></div></div><div class="slds-text-align--right slds-p-around--small slds-border--top"><button [disabled]="!view.isEditMode()" type="button" class="slds-button slds-button--brand" (click)="saveChanges()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div>',providers:[services_7.view]}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_5.broadcast,services_9.toast,services_3.modal,services_12.configurationService,services_7.view,services_3.modal])],FieldsetManager)}();exports.FieldsetManager=FieldsetManager;var FieldsetManagerFieldsetDetails=function(){function e(e,t,s,l){this.backend=e,this.metadata=t,this.language=s,this.view=l,this.fieldset={},this.currentFieldSet={},this.currentFieldSetConfig={}}return e.prototype.ngOnChanges=function(e){var t=this;this.fieldset.isViewMode?this.view.setViewMode():this.view.setEditMode();try{this.metadata.getFieldSetFields(this.fieldset.fieldset).some(function(e){if(e.id==t.fieldset.id)return t.currentFieldSet=t.metadata.getFieldset(e.fieldset),t.currentFieldSetConfig=e.fieldconfig,!0})}catch(e){this.currentFieldSet={}}},Object.defineProperty(e.prototype,"fieldsetname",{get:function(){var t=this;try{var s;return this.metadata.getFieldSetFields(this.fieldset.fieldset).some(function(e){if(e.id==t.fieldset.id)return s=e,!0}),this.metadata.getFieldsetName(s.fieldset)}catch(e){return""}},set:function(e){},enumerable:!0,configurable:!0}),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"fieldset",void 0),e=__decorate([core_1.Component({selector:"fieldsetmanager-fieldset-details",template:'<div class="slds-form-element slds-m-bottom--x-small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_NAME\')}}</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentFieldSet.name"></div></div><div class="slds-form-element slds-m-bottom--x-small"><label class="slds-form-element__label">ID</label><div class="slds-form-element__control"><input type="text" class="slds-input" [ngModel]="fieldset.id" disabled></div></div><div class="slds-form-element slds-m-vertical--x-small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_PACKAGE\')}}</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentFieldSet.package"></div></div><div class="slds-form-element slds-m-vertical--x-small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_FORMCLASS\')}}</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentFieldSetConfig.formclass"></div></div><div class="slds-form-element slds-m-vertical--x-small"><span class="slds-checkbox"><input [disabled]="!view.isEditMode()" name="options" id="cbDirection" value="vertical" type="checkbox" [checked]="currentFieldSetConfig.direction === \'vertical\'" (change)="currentFieldSetConfig.direction = currentFieldSetConfig.direction === \'vertical\' ? null : \'vertical\'"> <label class="slds-checkbox__label" for="cbDirection"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_VERTICAL\')}}</span></label></span></div><div class="slds-form-element slds-m-top--x-small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_WIDTH\')}} (number of parts, leave blank for 1)</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentFieldSetConfig.width"></div></div>',providers:[services_7.view]}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_7.view])],e)}();exports.FieldsetManagerFieldsetDetails=FieldsetManagerFieldsetDetails;var FieldsetManagerFieldDetails=function(){function e(e,t,s,l){this.backend=e,this.metadata=t,this.language=s,this.view=l,this.field={},this.currentField={},this.fieldtypes=[],this.component="",this.configValues={},this.fieldtypes=this.metadata.getFieldTypes(),this.fieldtypes.sort(),this.fieldtypes.unshift("")}return e.prototype.ngOnChanges=function(e){var t=this;this.field.isViewMode?this.view.setViewMode():this.view.setEditMode();try{this.metadata.getFieldSetFields(this.field.fieldset).some(function(e){if(e.id==t.field.id)return t.currentField=e,t.component=t.metadata.getFieldTypeComponent(e.fieldconfig.fieldtype),t.configValues=e.fieldconfig,!0})}catch(e){this.currentField={}}},Object.defineProperty(e.prototype,"configValuesLabel",{get:function(){var e=null;return"label"in this.configValues&&null!=this.configValues.label&&(e={name:this.configValues.label}),e},set:function(e){this.configValues.label=null!=e?e.name:null},enumerable:!0,configurable:!0}),e.prototype.configValuesLabelEmit=function(e){this.configValuesLabel=e},Object.defineProperty(e.prototype,"InputConfig",{get:function(){return{option:"name",type:"label",description:""}},enumerable:!0,configurable:!0}),e.prototype.getFieldConfig=function(){if(this.configValues.fieldtype){var e=this.metadata.getFieldTypeComponent(this.configValues.fieldtype),t=this.metadata.getComponentConfigOptions(e),s=[];for(var l in t)s.push(l);return s}return[]},e.prototype.selectFieldType=function(){this.component=this.metadata.getFieldTypeComponent(this.configValues.fieldtype),this.configValues=Object.assign({},this.configValues)},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"field",void 0),e=__decorate([core_1.Component({selector:"fieldsetmanager-field-details",template:'<div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_NAME\')}}</label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" placeholder="name" [(ngModel)]="currentField.field"></div></div><div class="slds-form-element slds-m-bottom--x-small"><label class="slds-form-element__label">ID</label><div class="slds-form-element__control"><input type="text" class="slds-input" [ngModel]="currentField.id" disabled></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_PACKAGE\')}}</label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" placeholder="package" [(ngModel)]="currentField.package"></div></div><label-selector [selected_item]="configValuesLabel" [disabled]="!view.isEditMode()" [option]="InputConfig" (select)="configValuesLabelEmit($event)"></label-selector><fieldset class="slds-form-element slds-m-vertical--xxx-small"><legend class="slds-form-element__legend slds-form-element__label">{{language.getAppLanglabel(\'LBL_OPTIONS\')}}</legend><div class="slds-form-element__control"><label class="slds-checkbox" for="link"><input [disabled]="!view.isEditMode()" type="checkbox" id="link" [(ngModel)]="configValues.link"> <span class="slds-checkbox--faux"></span> <span class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_LINK\')}}</span></label> <label class="slds-checkbox" for="default"><input [disabled]="!view.isEditMode()" type="checkbox" id="default" [(ngModel)]="configValues.default"> <span class="slds-checkbox--faux"></span> <span class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_DEFAULT\')}}</span></label> <label class="slds-checkbox" for="hidelabel"><input [disabled]="!view.isEditMode()" type="checkbox" id="hidelabel" [(ngModel)]="configValues.hidelabel"> <span class="slds-checkbox--faux"></span> <span class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_HIDE_LABEL\')}}</span></label> <label class="slds-checkbox" for="readonly"><input [disabled]="!view.isEditMode()" type="checkbox" id="readonly" [(ngModel)]="configValues.readonly"> <span class="slds-checkbox--faux"></span> <span class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_READONLY\')}}</span></label> <label class="slds-checkbox" for="sortable"><input [disabled]="!view.isEditMode()" type="checkbox" id="sortable" [(ngModel)]="configValues.sortable"> <span class="slds-checkbox--faux"></span> <span class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_SORTABLE\')}}</span></label></div></fieldset><div *ngIf="configValues.sortable" class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_SORTFIELD\')}}</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="configValues.sortfield"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_WIDTH\')}} (number of parts, leave blank for 1)</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="configValues.width"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_FIELDTYPE\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select [disabled]="!view.isEditMode()" class="slds-select" [(ngModel)]="configValues.fieldtype" (change)="selectFieldType()"><option *ngFor="let fieldtype of fieldtypes">{{fieldtype}}</option></select></div></div></div><workbench-config [component]="component" [configValues]="configValues"></workbench-config>',providers:[services_7.view]}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_7.view])],e)}();exports.FieldsetManagerFieldDetails=FieldsetManagerFieldDetails;var FieldsetManagerAddDialog=function(){function FieldsetManagerAddDialog(e,t,s){this.backend=e,this.language=t,this.modelutilities=s,this.closedialog=new core_1.EventEmitter,this.module="*",this.parent="",this.metadata={},this.edit_mode="",this.addType="fieldsetadd",this.addName="",this.addFieldset="",this.fieldsettype="custom",this.moduleFields=[]}return FieldsetManagerAddDialog.prototype.ngOnInit=function(){var t=this;if(this.module&&"*"!=this.module){var e={modules:JSON.stringify([this.module])};this.backend.getRequest("spiceui/core/fielddefs",e).subscribe(function(e){t.moduleFields=e.fielddefs[t.module]})}},FieldsetManagerAddDialog.prototype.closeDialog=function(){this.self.destroy()},FieldsetManagerAddDialog.prototype.onModalEscX=function(){this.closeDialog()},FieldsetManagerAddDialog.prototype.add=function(){switch(this.addType){case"fieldsetadd":var e=this.modelutilities.generateGuid();this.metadata.addFieldset(e,this.module,this.addName,this.fieldsettype),this.metadata.addFieldsetToFieldset(this.modelutilities.generateGuid(),this.parent,e);break;case"fieldsetselect":this.metadata.addFieldsetToFieldset(this.modelutilities.generateGuid(),this.parent,this.addFieldset);break;case"field":this.modelutilities.generateGuid();this.metadata.addFieldToFieldset(this.modelutilities.generateGuid(),this.parent,this.addName)}this.closedialog.emit(!0),this.self.destroy()},FieldsetManagerAddDialog.prototype.getFieldNames=function(){var e=[];for(var t in this.moduleFields)e.push(t);return e.sort(),e},Object.defineProperty(FieldsetManagerAddDialog.prototype,"fieldsets",{get:function(){return this.metadata.getFieldSets()},enumerable:!0,configurable:!0}),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],FieldsetManagerAddDialog.prototype,"closedialog",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerAddDialog.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerAddDialog.prototype,"parent",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],FieldsetManagerAddDialog.prototype,"metadata",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerAddDialog.prototype,"edit_mode",void 0),FieldsetManagerAddDialog=__decorate([core_1.Component({selector:"fieldsetmanager-add-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium">{{language.getAppLanglabel(\'LBL_ADD_ITEM\')}}</h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-grid slds-col--bump-left"><span class="slds-radio"><input type="radio" name="addType" value="fieldsetadd" id="fieldsetaddradio" [(ngModel)]="addType"> <label class="slds-radio__label" for="fieldsetaddradio"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_ADD_FIELDSET\')}}</span></label></span> <span class="slds-radio"><input type="radio" name="addType" value="fieldsetselect" id="fieldsetselectradio" [(ngModel)]="addType"> <label class="slds-radio__label" for="fieldsetselectradio"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_SELECT_FIELDSET\')}}</span></label></span> <span class="slds-radio"><input type="radio" name="addType" value="field" id="fieldradio" [(ngModel)]="addType"> <label class="slds-radio__label" for="fieldradio"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_FIELD\')}}</span></label></span></div><div *ngIf="addType==\'field\'" class="slds-form-element"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_FIELDNAME\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="addName"><option *ngFor="let fieldname of getFieldNames()">{{fieldname}}</option></select></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_ITEM_NAME\')}}</label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="addName"></div></div></div><div *ngIf="addType==\'fieldsetadd\'" class="slds-form-element"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_SCOPE\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldsettype"><option *ngIf="edit_mode == \'all\'" value="global">{{language.getAppLanglabel(\'LBL_GLOBAL\')}}</option><option value="custom">{{language.getAppLanglabel(\'LBL_CUSTOM\')}}</option></select></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_ITEM_NAME\')}}</label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="addName"></div></div></div><div *ngIf="addType==\'fieldsetselect\'" class="slds-form-element"><label class="slds-form-element__label">type</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="addFieldset"><option *ngFor="let fieldset of fieldsets" [value]="fieldset.id">{{fieldset.name}}</option></select></div></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()">{{language.getAppLanglabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" (click)="add()">{{language.getAppLanglabel(\'LBL_ADD\')}}</button></div></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_4.language,services_8.modelutilities])],FieldsetManagerAddDialog)}();exports.FieldsetManagerAddDialog=FieldsetManagerAddDialog;var FieldsetManagerEditDialog=function(){function FieldsetManagerEditDialog(e,t,s,l,o){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.configurationService=o,this.fieldset="",this.edit_mode="",this.closedialog=new core_1.EventEmitter,this.fieldsetname="",this.fieldsettype="",this.adding=!1,this.globalEdit=!1,this.modalTitle="",this.modalTitle=this.language.getAppLanglabel("LBL_EDIT")}return FieldsetManagerEditDialog.prototype.ngOnInit=function(){this.fieldset?(this.fieldsetname=this.metadata.getFieldsetName(this.fieldset),this.fieldsettype=this.metadata.getFieldset(this.fieldset).type,this.adding=!1):(this.modalTitle=this.language.getAppLanglabel("LBL_ADD"),this.fieldsettype="custom",this.adding=!0)},FieldsetManagerEditDialog.prototype.closeDialog=function(){this.self.destroy()},FieldsetManagerEditDialog.prototype.onModalEscX=function(){this.closeDialog()},FieldsetManagerEditDialog.prototype.add=function(){this.closedialog.emit({name:this.fieldsetname,type:this.fieldsettype}),this.self.destroy()},__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerEditDialog.prototype,"fieldset",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerEditDialog.prototype,"edit_mode",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],FieldsetManagerEditDialog.prototype,"closedialog",void 0),FieldsetManagerEditDialog=__decorate([core_1.Component({selector:"fieldsetmanager-edit-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium">{{modalTitle}}</h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_ITEM_NAME\')}}</label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="fieldsetname"></div></div><div class="slds-form-element"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_TYPE\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldsettype" [disabled]="!adding"><option value="global" *ngIf="edit_mode == \'all\'">{{language.getAppLanglabel(\'LBL_GLOBAL\')}}</option><option value="custom">{{language.getAppLanglabel(\'LBL_CUSTOM\')}}</option></select></div></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()">{{language.getLabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" [disabled]="fieldsetname == \'\'" (click)="add()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_12.configurationService])],FieldsetManagerEditDialog)}();exports.FieldsetManagerEditDialog=FieldsetManagerEditDialog;var ComponentsetManager=function(){function ComponentsetManager(e,t,s,l,o,i,a,n,d){var r=this;this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.broadcast=o,this.toast=i,this.modalservice=a,this.view=n,this.configurationService=d,this.edit_mode="custom",this.allowBarButtons=!0,this.change_request_required=!1,this.sysModules=[],this.currentModule="*",this.currentComponentSet="",this.currentComponentSetItems=[],this.selectedId="",this.selectedComponent={},this.showAddDialog=!1,this.showComponentsetDetails=!1,this.backend.getRequest("spiceui/admin/modules").subscribe(function(e){r.sysModules=e,r.metadata.loadFieldSets(new rxjs_1.Subject),r.metadata.loadComponents(new rxjs_1.Subject)}),this.checkMode()}return ComponentsetManager.prototype.checkMode=function(){var t=this;this.edit_mode=this.configurationService.getCapabilityConfig("core").edit_mode,this.change_request_required=!!this.configurationService.getCapabilityConfig("systemdeployment").change_request_required,"none"!=this.edit_mode&&"custom"!=this.edit_mode&&"all"!=this.edit_mode&&(this.edit_mode="custom"),this.change_request_required?this.backend.getRequest("systemdeploymentcrs/active").subscribe(function(e){""==e.id?(t.setNoneMode(),t.toast.sendToast(t.language.getLabel("LBL_ACTIVATE_CR_WARNING"),"warning",null,3)):"all"==t.edit_mode?t.setAllMode():"custom"==t.edit_mode?t.setCustomMode():t.setNoneMode()}):"all"==this.edit_mode?this.setAllMode():"custom"==this.edit_mode?this.setCustomMode():this.setNoneMode()},ComponentsetManager.prototype.setNoneMode=function(){this.view.setViewMode(),this.allowBarButtons=!1},ComponentsetManager.prototype.setCustomMode=function(){"custom"==this.componentSetType?this.view.setEditMode():this.view.setViewMode()},ComponentsetManager.prototype.setAllMode=function(){this.view.setEditMode()},Object.defineProperty(ComponentsetManager.prototype,"showDetailIcon",{get:function(){return this.showComponentsetDetails?"chevronup":"chevrondown"},enumerable:!0,configurable:!0}),ComponentsetManager.prototype.toggleDetail=function(){this.showComponentsetDetails=!this.showComponentsetDetails},Object.defineProperty(ComponentsetManager.prototype,"componentSetType",{get:function(){return this.currentComponentSet?this.metadata.getComponentSet(this.currentComponentSet).type:""},enumerable:!0,configurable:!0}),Object.defineProperty(ComponentsetManager.prototype,"currentComponentSetPackage",{get:function(){return this.metadata.getComponentSet(this.currentComponentSet).package},set:function(e){this.metadata.getComponentSet(this.currentComponentSet).package=e},enumerable:!0,configurable:!0}),Object.defineProperty(ComponentsetManager.prototype,"currentComponentSetName",{get:function(){return this.metadata.getComponentSet(this.currentComponentSet).name},set:function(e){this.metadata.getComponentSet(this.currentComponentSet).name=e},enumerable:!0,configurable:!0}),ComponentsetManager.prototype.getComponentSetItemName=function(e){return e.componentconfig.name?"("+this.language.getAppLanglabel(e.componentconfig.name)+")":e.componentconfig.object?"("+this.language.getModuleName(e.componentconfig.object)+")":void 0},ComponentsetManager.prototype.getComponentSets=function(e){if(void 0===e&&(e=void 0),e){for(var t=[],s=0,l=this.metadata.getComponentSets(this.currentModule);s<l.length;s++){var o=l[s];o.type==e&&t.push(o)}return t}return this.metadata.getComponentSets(this.currentModule)},ComponentsetManager.prototype.getComponentSetItems=function(){return this.currentComponentSet?this.metadata.getComponentSetObjects(this.currentComponentSet):[]},ComponentsetManager.prototype.selectItem=function(e){this.selectedId=e.id,this.selectedComponent=e},ComponentsetManager.prototype.isSelected=function(e){return e==this.selectedId},ComponentsetManager.prototype.getComponentsetConfig=function(){if(this.selectedComponent.componentconfig)return JSON.stringify(this.selectedComponent.componentconfig)},ComponentsetManager.prototype.reset=function(){this.selectedId="",this.selectedComponent={},this.currentComponentSet=""},ComponentsetManager.prototype.selectComponentSet=function(){this.checkMode(),this.selectedId="",this.selectedComponent={}},ComponentsetManager.prototype.addComponent=function(){var t=this;this.showAddDialog=!0,this.modalservice.openModal("ComponentsetManagerAddDialog").subscribe(function(e){e.instance.module=t.currentModule,e.instance.parent=t.currentComponentSet})},ComponentsetManager.prototype.addComponentset=function(){this.reset(),this.editComponentset()},ComponentsetManager.prototype.editComponentset=function(){var l=this;this.modalservice.openModal("ComponentsetManagerEditDialog").subscribe(function(e){e.instance.componentset=l.currentComponentSet,e.instance.edit_mode=l.edit_mode,e.instance.closedialog.subscribe(function(e){if(!1!==e)if(""===l.currentComponentSet){var t=l.modelutilities.generateGuid();l.metadata.addComponentSet(t,l.currentModule,e.name,e.type),l.currentComponentSet=t,l.checkMode()}else{var s=l.metadata.getComponentSet(l.currentComponentSet);s.name=s.name}})})},ComponentsetManager.prototype.deleteComponent=function(s){var l=this.metadata.getComponentSetObjects(this.currentComponentSet),o=0;l.some(function(e,t){if(e.id==s.id)return o=t,l.splice(o,1),!0})},ComponentsetManager.prototype.moveDown=function(s){var e=this.metadata.getComponentSetObjects(this.currentComponentSet),l=0;if(e.some(function(e,t){if(e.id==s.id)return l=t,!0}),l<e.length-1){var t=e.splice(l,1);e.splice(l+1,0,t[0]);for(var o=0,i=0,a=e;i<a.length;i++){a[i].sequence=o,o++}}},ComponentsetManager.prototype.moveUp=function(s){var e=this.metadata.getComponentSetObjects(this.currentComponentSet),l=0;if(e.some(function(e,t){if(e.id==s.id)return l=t,!0}),0<l){var t=e.splice(l,1);e.splice(l-1,0,t[0]);for(var o=0,i=0,a=e;i<a.length;i++){a[i].sequence=o,o++}}},ComponentsetManager.prototype.saveChanges=function(){var a=this;this.backend.getRequest("spiceui/core/components").subscribe(function(e){var t=a.metadata.getRawComponentSets(),s={},l={};for(var o in t)e.componentsets[o]?(JSON.stringify(t[o])!==JSON.stringify(e.componentsets[o])&&(l[o]=t[o]),delete e.componentsets[o]):s[o]=t[o];var i={add:s,update:l,delete:e.componentsets};a.backend.postRequest("spiceui/core/componentsets",{},i).subscribe(function(e){a.broadcast.broadcastMessage("metadata.updatecomponentsets",i),a.toast.sendToast("changes saved")})})},ComponentsetManager=__decorate([core_1.Component({template:'<div class="slds-p-around--small slds-border--bottom"><div class="slds-grid slds-grid--vertical-align-center slds-form--inline"><div class="slds-form-element"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_MODULE\')}}</label><div class="slds-form-element__control"><div class="slds-select_container" style="min-width:250px;"><select class="slds-select" [(ngModel)]="currentModule" (change)="reset()" [disabled]="sysModules.length == 0"><option value="*">*</option><option *ngFor="let sysModule of sysModules" [value]="sysModule.module">{{sysModule.module}}</option></select></div></div></div><div class="slds-form-element"><label class="slds-form-element__label">Componentset</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentComponentSet" (change)="selectComponentSet()" [disabled]="getComponentSets() == 0"><option></option><optgroup label="custom Componentsets" *ngIf="getComponentSets(\'custom\').length > 0"><option *ngFor="let sysComponentset of getComponentSets(\'custom\')" [value]="sysComponentset.id">{{sysComponentset.name}}</option></optgroup><optgroup label="global Componentsets" *ngIf="getComponentSets(\'global\').length > 0"><option *ngFor="let sysComponentset of getComponentSets(\'global\')" [value]="sysComponentset.id">{{sysComponentset.name}}</option></optgroup></select></div></div></div><div class="slds-button-group slds-col--bump-left"><button [disabled]="!allowBarButtons" type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="addComponentset()"><system-utility-icon [icon]="\'add\'" [size]="\'x-small\'"></system-utility-icon></button></div></div></div><div *ngIf="currentComponentSet" class="slds-theme--default"><div class="slds-p-around--small slds-border--bottom slds-theme--default"><div class="slds-grid slds-grid--vertical-align-end"><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_SCOPE\')}}</label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left"><system-custom-icon [icon]="componentSetType" size="x-small" addclasses="slds-input__icon slds-input__icon_left"></system-custom-icon><input type="text" disabled class="slds-input" [ngModel]="componentSetType"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_NAME\')}}</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentComponentSetName"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_PACKAGE\')}}</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentComponentSetPackage"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_ID\')}}</label><div class="slds-form-element__control"><input type="text" disabled class="slds-input" [ngModel]="currentComponentSet"></div></div></div></div><div class="slds-grid"><div class="slds-size--2-of-5 slds-p-horizontal--small slds-p-top--x-small slds-border--right"><div class="slds-tree_container" role="application" style="max-width: none;"><div *ngFor="let currentComponentSetItem of getComponentSetItems()" class="slds-p-vertical--xx-small slds-grid slds-grid--align-spread slds-grid--vertical-align-center" (click)="selectItem(currentComponentSetItem)" [ngClass]="{\'slds-theme--shade\' : isSelected(currentComponentSetItem.id)}"><a href="javascript:void(0);" role="presentation" class="slds-truncate">{{currentComponentSetItem.component}} {{getComponentSetItemName(currentComponentSetItem)}}</a><div class="slds-col--bump-left"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="unlink item" (click)="deleteComponent(currentComponentSetItem)"><system-button-icon [icon]="\'delete\'"></system-button-icon></button> <button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="move down" (click)="moveDown(currentComponentSetItem)"><system-button-icon [icon]="\'down\'"></system-button-icon></button> <button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="move up" (click)="moveUp(currentComponentSetItem)"><system-button-icon [icon]="\'up\'"></system-button-icon></button></div></div></div><div class="slds-p-around--small slds-align--absolute-center slds-border--top slds-m-top--small"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="add item" (click)="addComponent()"><system-button-icon [icon]="\'new\'"></system-button-icon></button></div></div><div class="slds-size--3-of-5 slds-p-horizontal--small slds-p-vertical--x-small"><componentsetmanager-componentset-details *ngIf="selectedId" [component]="selectedComponent"></componentsetmanager-componentset-details></div></div><div class="slds-text-align--right slds-p-around--small slds-border--top"><button [disabled]="!view.isEditMode()" type="button" class="slds-button slds-button--brand" (click)="saveChanges()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div>',providers:[services_7.view]}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_5.broadcast,services_9.toast,services_3.modal,services_7.view,services_12.configurationService])],ComponentsetManager)}();exports.ComponentsetManager=ComponentsetManager;var ComponentsetManagerComponentsetDetails=function(){function e(e,t){this.view=e,this.language=t,this.component={},this.configcomponent="",this.configValues={},this.selectedComponent={}}return e.prototype.selectComponent=function(e){e.id?this.selectedComponent=e:this.selectedComponent={}},e.prototype.ngOnChanges=function(e){this.component.component&&(this.selectComponent(this.component),this.configcomponent=this.component.component,this.configValues=this.component.componentconfig)},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"component",void 0),e=__decorate([core_1.Component({selector:"componentsetmanager-componentset-details",template:'<div class="slds-form-element"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_PACKAGE\')}}</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="component.package"></div></div><workbench-config [component]="configcomponent" [configValues]="configValues"></workbench-config>'}),__metadata("design:paramtypes",[services_7.view,services_4.language])],e)}();exports.ComponentsetManagerComponentsetDetails=ComponentsetManagerComponentsetDetails;var ComponentsetManagerAddDialog=function(){function ComponentsetManagerAddDialog(e,t,s,l){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.module="",this.parent="",this.component="",this.systemmodule="",this.systemmodules=[],this.systemmodules=this.metadata.getSystemModules()}return Object.defineProperty(ComponentsetManagerAddDialog.prototype,"components",{get:function(){return this.metadata.getSystemComponents(this.systemmodule)},enumerable:!0,configurable:!0}),ComponentsetManagerAddDialog.prototype.cancelDialog=function(){this.self.destroy()},ComponentsetManagerAddDialog.prototype.onModalEscX=function(){this.cancelDialog()},ComponentsetManagerAddDialog.prototype.add=function(){this.metadata.addComponentToComponentset(this.modelutilities.generateGuid(),this.parent,this.component),this.self.destroy()},__decorate([core_1.Input(),__metadata("design:type",String)],ComponentsetManagerAddDialog.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ComponentsetManagerAddDialog.prototype,"parent",void 0),ComponentsetManagerAddDialog=__decorate([core_1.Component({selector:"componensetmanager-add-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="cancelDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium">Add Component</h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-grid"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-form-element__label">{{language.getLabel(\'LBL_MODULE\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="systemmodule"><option *ngFor="let module of systemmodules" [value]="module.id">{{module.module}}</option></select></div></div></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-form-element__label">{{language.getLabel(\'LBL_COMPONENT\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="component"><option *ngFor="let component of components" [value]="component.component">{{component.component}}</option></select></div></div></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="cancelDialog()">{{language.getLabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" (click)="add()">{{language.getLabel(\'LBL_ADD\')}}</button></div></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities])],ComponentsetManagerAddDialog)}();exports.ComponentsetManagerAddDialog=ComponentsetManagerAddDialog;var ComponentsetManagerEditDialog=function(){function ComponentsetManagerEditDialog(e,t){this.metadata=e,this.language=t,this.closedialog=new core_1.EventEmitter,this.componentset="",this.edit_mode="",this.adding=!1,this.componentsetname="",this.componentsettype=""}return ComponentsetManagerEditDialog.prototype.ngOnInit=function(){if(""!==this.componentset){var e=this.metadata.getComponentSet(this.componentset);this.componentsetname=e.name,this.componentsettype=e.type,this.adding=!1}else this.adding=!0,this.componentsettype="custom"},ComponentsetManagerEditDialog.prototype.cancelDialog=function(){this.closedialog.emit(!1),this.self.destroy()},ComponentsetManagerEditDialog.prototype.onModalEscX=function(){this.cancelDialog()},ComponentsetManagerEditDialog.prototype.add=function(){this.closedialog.emit({name:this.componentsetname,type:this.componentsettype}),this.self.destroy()},__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],ComponentsetManagerEditDialog.prototype,"closedialog",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ComponentsetManagerEditDialog.prototype,"componentset",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ComponentsetManagerEditDialog.prototype,"edit_mode",void 0),ComponentsetManagerEditDialog=__decorate([core_1.Component({selector:"componensetmanager-edit-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="cancelDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium">Add Componentset</h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">Componentset Name</label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="componentsetname"></div></div><div class="slds-form-element"><label class="slds-form-element__label">type</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="componentsettype" [disabled]="!adding"><option *ngIf="edit_mode == \'all\'" value="global">Global</option><option value="custom">Custom</option></select></div></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="cancelDialog()">{{language.getLabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" [disabled]="fieldsetname == \'\'" (click)="add()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_4.language])],ComponentsetManagerEditDialog)}();exports.ComponentsetManagerEditDialog=ComponentsetManagerEditDialog;var ComponentConfigManager=function(){function ComponentConfigManager(e,t,s){var o=this;this.backend=e,this.metadata=t,this.language=s,this.sysModules=[],this.sysRoles={},this.currentModule="*",this.currentComponent="",this.selectedId="",this.selectedComponent={},this.showAddDialog=!1,this.showEditDialog=!1,this.componentTree=[],this.backend.getRequest("configurator/entries/sysuiroles").subscribe(function(e){o.sysRoles["*"]="*";for(var t=0,s=e;t<s.length;t++){var l=s[t];o.sysRoles[l.id]=l.name}}),this.backend.getRequest("spiceui/admin/modules").subscribe(function(e){o.sysModules=e,o.metadata.loadFieldSets(new rxjs_1.Subject),o.metadata.loadComponents(new rxjs_1.Subject)})}return ComponentConfigManager.prototype.reset=function(){this.currentComponent="",this.componentTree=[],this.selectedComponent={}},ComponentConfigManager.prototype.getComponents=function(){var e=this.metadata.getComponentConfigurations(this.currentModule),t=[],s=[];for(var l in e)for(var o in e[l])t.push({id:l+"::"+o,display:l+"/"+this.currentModule+"/"+this.sysRoles[o]}),s.push(l);if("*"!==this.currentModule)for(var l in e=this.metadata.getComponentConfigurations("*"))for(var o in e[l])-1===s.indexOf(l)&&t.push({id:l+"::"+o,display:l+"/*/"+this.sysRoles[o]});return t.sort(function(e,t){return e.display>t.display?1:-1}),t},ComponentConfigManager.prototype.getRoles=function(){var e=[];for(var t in this.sysRoles)e.push({id:t,name:this.sysRoles[t]});return e},ComponentConfigManager.prototype.getComponentSetItems=function(){return[]},ComponentConfigManager.prototype.buildTree=function(){if(this.componentTree=[],this.currentComponent){var e=this.currentComponent.split("::"),t=this.metadata.getComponentConfig(e[0],this.currentModule,e[1]),s={id:"root",component:e[0],role:e[1],componentconfig:t,level:1};this.componentTree.push(s),this.selectedComponent=s;var l=this.metadata.getComponentConfigOptions(e[0]);t&&this.parseOptions(l,t,1)}},ComponentConfigManager.prototype.parseOptions=function(e,t,s){for(var l in e)if(Array.isArray(e[l]))for(var o in t[l])this.parseOptions(e[l][0],t[l][o],s);else e[l].type&&"componentset"==e[l].type&&t[l]&&this.addComponentSetToTree(l,t[l],s)},ComponentConfigManager.prototype.addComponentSetToTree=function(e,t,s){s++,this.componentTree.push({component:e,level:s}),s++;for(var l=this.currentComponent.split("::"),o=0,i=this.metadata.getComponentSetObjects(t);o<i.length;o++){var a=i[o];"{}"===JSON.stringify(a.componentconfig)&&(a.componentconfig=this.metadata.getComponentConfig(a.component,this.currentModule,l[1])),this.componentTree.push({id:a.id,component:a.component,role:l[1],componentconfig:a.componentconfig,level:s});var n=this.metadata.getComponentConfigOptions(a.component);a.componentconfig&&this.parseOptions(n,a.componentconfig,s)}},ComponentConfigManager.prototype.selectComponent=function(e){e.id?(console.log("componentt",e),this.selectedComponent=e):this.selectedComponent={}},ComponentConfigManager.prototype.isSelected=function(e){return!!e&&e===this.selectedComponent.id},ComponentConfigManager=__decorate([core_1.Component({template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><label class="slds-form-element__label">Module</label><div class="slds-form-element__control"><div class="slds-select_container" style="min-width:250px;"><select class="slds-select" [(ngModel)]="currentModule" (change)="reset()"><option value="*">*</option><option *ngFor="let sysModule of sysModules" [value]="sysModule.module">{{sysModule.module}}</option></select></div></div></div><div class="slds-form-element"><label class="slds-form-element__label">Component</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentComponent" (change)="buildTree()"><option></option><option *ngFor="let sysComponent of getComponents()" [value]="sysComponent.id">{{sysComponent.display}}</option></select></div></div></div><div class="slds-form-element slds-col--bump-left"><button type="button" class="slds-button slds-button--neutral" (click)="addComponentset()">{{language.getLabel(\'LBL_ADD\')}}</button> <button type="button" class="slds-button slds-button--brand" disabled (click)="saveChanges()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div><div class="slds-grid"><div class="slds-size--2-of-5 slds-p-horizontal--small slds-p-top--x-small slds-border--right"><div class="slds-tree_container" role="application" style="max-width: none;"><ul class="slds-tree" role="tree" aria-labelledby="treeheading"><li *ngFor="let currentComponentItem of componentTree" role="treeitem" [attr.aria-level]="currentComponentItem.level" (click)="selectComponent(currentComponentItem)" [ngClass]="{\'slds-theme--shade\' : isSelected(currentComponentItem.id)}"><div class="slds-tree__item slds-grid slds-grid--align-spread slds-grid--vertical-align-center"><a href="javascript:void(0);" role="presentation" class="slds-truncate">{{currentComponentItem.component}}</a></div></li></ul></div></div><div class="slds-size--3-of-5 slds-p-horizontal--small slds-p-top--x-small"><componentconfigmanager-component-details *ngIf="selectedComponent.id" [component]="selectedComponent"></componentconfigmanager-component-details></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language])],ComponentConfigManager)}();exports.ComponentConfigManager=ComponentConfigManager;var ComponentConfigManagerComponentDetails=function(){function e(e,t,s,l,o,i){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.broadcast=o,this.toast=i,this.component={},this.configOptions=[],this.optionsElements=[],this.selectedComponent={}}return e.prototype.selectComponent=function(e){e.id?this.selectedComponent=e:this.selectedComponent={}},e.prototype.ngOnChanges=function(e){for(var s=this,t=0,l=this.optionsElements;t<l.length;t++){(i=l[t]).destroy()}if(this.optionsElements=[],this.configOptions=[],this.component.component){var o=this.metadata.getComponentConfigOptions(this.component.component);for(var i in o)this.configOptions.push({option:i,type:o[i].type?o[i].type:"string"})}for(var a=function(t){var e="";switch(t.type){case"fieldset":e="ComponentsetManagerOptionFieldset";break;case"componentset":e="ComponentsetManagerOptionComponentset";break;case"actionset":e="ComponentsetManagerOptionActionset";break;case"module":e="ComponentsetManagerOptionModule";break;case"boolean":e="ComponentsetManagerOptionBoolean";break;case"label":e="LabelSelectorComponent";break;default:e="ComponentsetManagerOptionDefault"}n.metadata.addComponent(e,n.optionscontainer).subscribe(function(e){s.optionsElements.push(e),e.instance.option=t,e.instance.component=s.component})},n=this,d=0,r=this.configOptions;d<r.length;d++){a(i=r[d])}},e.prototype.getComponentsetConfig=function(){if(this.component.componentconfig)return JSON.stringify(this.component.componentconfig)},__decorate([core_1.ViewChild("optionscontainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"optionscontainer",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"component",void 0),e=__decorate([core_1.Component({selector:"componentconfigmanager-component-details",template:'<div class="slds-form-element"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_PACKAGE\')}}</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="component.package"></div></div><workbench-config [component]="configcomponent" [configValues]="configValues"></workbench-config>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_5.broadcast,services_9.toast])],e)}();exports.ComponentConfigManagerComponentDetails=ComponentConfigManagerComponentDetails;var ValidationRulesManager=function(){function ValidationRulesManager(e,t,s,l,o,i){this.appdata=e,this.backend=t,this.metadata=s,this.language=l,this.utils=o,this.toast=i,this.rules=[],this._backup_rules=[],this._current_rule_data={},this.logicoperator_options=[],this.current_tab="details",this.logicoperator_options=this.language.getDisplayOptions("logicoperators_dom",!0)}return Object.defineProperty(ValidationRulesManager.prototype,"modules",{get:function(){return this.appdata.modules},enumerable:!0,configurable:!0}),Object.defineProperty(ValidationRulesManager.prototype,"current_module",{get:function(){return this._current_module},set:function(e){this._current_module=e,this.rules=this.metadata.getModuleValidations(e),this.copyRulesToBackup(),this.current_rule=null},enumerable:!0,configurable:!0}),Object.defineProperty(ValidationRulesManager.prototype,"current_rule",{get:function(){return this._current_rule},set:function(e){this._current_rule=e,this._current_rule_data=this.getCurrentRuleData()},enumerable:!0,configurable:!0}),Object.defineProperty(ValidationRulesManager.prototype,"current_rule_data",{get:function(){return this._current_rule_data},enumerable:!0,configurable:!0}),ValidationRulesManager.prototype.getCurrentRuleData=function(){var t=this;return this.rules?this.rules.find(function(e){return e.id==t._current_rule}):""},ValidationRulesManager.prototype.removeCurrentValidationRule=function(){var t=this;this.backend.deleteRequest("spiceui/core/modelvalidations/"+this.current_rule).subscribe(function(e){return t.toast.sendToast("rule removed"),t.removeRule(t.current_rule),!0},function(e){return t.toast.sendToast("removing rule failed!"),console.error(e),!1})},ValidationRulesManager.prototype.save=function(){var s=this,l=this.current_rule_data;this.backend.postRequest("spiceui/core/modelvalidations",{},l).subscribe(function(e){s.current_rule_data._is_new_record=!1;var t=s._backup_rules.findIndex(function(e){return e.id==s._current_rule});s._backup_rules[t]=__assign({},l),s.toast.sendToast("changes saved")},function(e){s.toast.sendAlert("saving changes failed!"),console.error(e)})},ValidationRulesManager.prototype.cancel=function(){this.current_rule_data._is_new_record?this.removeRule(this.current_rule):this.resetCurrentRuleData()},ValidationRulesManager.prototype.addValidationRule=function(){this.rules.push({id:this.utils.generateGuid(),module:this.current_module,active:1,actions:[],conditions:[],_is_new_record:!0}),this.current_rule=this.rules[this.rules.length-1].id},ValidationRulesManager.prototype.removeRule=function(t){void 0===t&&(t=this.current_rule);var e=this.rules.findIndex(function(e){return e.id==t});return this.rules.splice(e,1),this.current_rule==t&&(this.current_rule=null),!0},ValidationRulesManager.prototype.resetCurrentRuleData=function(){var t=this,e=this._backup_rules.find(function(e){return e.id==t._current_rule});this._current_rule_data=__assign({},e),console.log("resetted to",e,this._backup_rules)},ValidationRulesManager.prototype.copyRulesToBackup=function(){this._backup_rules=[];for(var e=0,t=this.rules;e<t.length;e++){var s=t[e];this._backup_rules.push(__assign({},s))}},ValidationRulesManager=__decorate([core_1.Component({template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><label class="slds-form-element__label">Module</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="current_module"><option></option><option *ngFor="let m of modules" [value]="m.module">{{m.module}}</option></select></div></div></div><div *ngIf="current_module" class="slds-form-element"><label class="slds-form-element__label">Rule</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="current_rule"><option></option><option *ngFor="let r of rules" [value]="r.id">{{r.name}}</option></select></div></div></div><div *ngIf="current_module" class="slds-form-element slds-col--bump-left"><div class="slds-button-group" role="group"><button type="button" class="slds-button slds-button--neutral" (click)="addValidationRule()">{{language.getLabel(\'LBL_ADD\')}}</button> <button type="button" class="slds-button slds-button--neutral" [disabled]="!current_rule" (click)="removeCurrentValidationRule()">{{language.getLabel(\'LBL_DELETE\')}}</button> <button type="button" class="slds-button slds-button--neutral" [disabled]="!current_rule" (click)="cancel()">{{language.getLabel(\'LBL_CANCEL\')}}</button> <button type="button" class="slds-button slds-button--brand" [disabled]="!current_rule" (click)="save()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div></div><div *ngIf="current_rule" class="slds-grid"><div class="slds-tabs_default"><ul class="slds-tabs_default__nav" role="tablist"><li class="slds-tabs--default__item slds-text-title--caps" [ngClass]="{\'slds-active\': current_tab == \'details\' || !current_tab}" role="presentation" (click)="current_tab = \'details\'"><a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" aria-selected="false">Details</a></li><li class="slds-tabs--default__item slds-text-title--caps" [ngClass]="{\'slds-active\': current_tab == \'conditions\'}" role="presentation" (click)="current_tab = \'conditions\'"><a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" aria-selected="false">Conditions</a></li><li class="slds-tabs--default__item slds-text-title--caps" [ngClass]="{\'slds-active\': current_tab == \'actions\'}" role="presentation" (click)="current_tab = \'actions\'"><a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" aria-selected="false">Actions</a></li></ul><div *ngIf="current_tab == \'details\'" id="tab-default-1" class="slds-tabs_default__content" role="tabpanel"><div class="slds-size--3-of-5 slds-p-horizontal--small slds-p-top--x-small"><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Name:</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="current_rule_data.name"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">OnEvents:</label><div class="slds-form-element__control"><input type="text" class="slds-input" [ngModel]="current_rule_data.onevents | maybejson" (ngModelChange)="current_rule_data.onevents=$event"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Logic Operator:</label><div class="slds-form-element__control"><select class="slds-select" [(ngModel)]="current_rule_data.logicoperator"><option *ngFor="let opt of logicoperator_options" value="{{opt.value}}">{{opt.display}}</option></select></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Priority:</label><div class="slds-form-element__control"><input type="number" min="0" max="99" class="slds-input" [(ngModel)]="current_rule_data.prioirty"></div></div><div class="slds-form-element"><label class="slds-form-element__label">Active:</label><div class="slds-form-element__control"><system-checkbox [(ngModel)]="current_rule_data.active"></system-checkbox></div></div></div></div><div *ngIf="current_tab == \'conditions\'" id="tab-default-2" class="slds-tabs_default__content" role="tabpanel"><validationrules-conditions [data]="current_rule_data"></validationrules-conditions></div><div *ngIf="current_tab == \'actions\'" id="tab-default-3" class="slds-tabs_default__content" role="tabpanel"><validationrules-actions [data]="current_rule_data"></validationrules-actions></div></div></div>'}),__metadata("design:paramtypes",[services_10.AppDataService,services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_9.toast])],ValidationRulesManager)}();exports.ValidationRulesManager=ValidationRulesManager;var MaybeJsonPipe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.transform=function(e){return e instanceof Array||e instanceof Object?t.prototype.transform.call(this,e):e},e=__decorate([core_1.Pipe({name:"maybejson"})],e)}(common_1.JsonPipe);exports.MaybeJsonPipe=MaybeJsonPipe;var ValidationRulesConditions=function(){function e(e,t,s,l){this.appdata=e,this.metadata=t,this.language=s,this.utils=l,this.comparator_options=[],this.fieldname_options=[]}return e.prototype.ngOnInit=function(){for(var e in this.comparator_options=this.language.getDisplayOptions("comparators_dom",!0),this.metadata.getModuleFields(this.data.module))this.fieldname_options.push(e)},Object.defineProperty(e.prototype,"conditions",{get:function(){return this.data.conditions.filter(function(e){return 1!=e.deleted})},enumerable:!0,configurable:!0}),e.prototype.addCondition=function(){return this.data.conditions.push({id:this.utils.generateGuid(),sysuimodelvalidation_id:this.data.id,_is_new_record:!0})},e.prototype.removeCondition=function(t){var e=this.data.conditions.findIndex(function(e){return e.id==t});return this.data.conditions[e]._is_new_record?this.data.conditions.splice(e,1):this.data.conditions[e].deleted=1,!0},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"data",void 0),e=__decorate([core_1.Component({selector:"validationrules-conditions",template:'<table class="slds-table slds-table--bordered slds-table--cell-buffer"><thead><tr class="slds-text-title--caps"><th scope="col" style="width:2rem;">Fieldname</th><th scope="col" style="width:1rem;">Comparator</th><th scope="col" style="width:4rem;">Valutations</th><th scope="col" style="width:2rem;">OnChange</th><th scope="col" style="width:1rem;"></th></tr></thead><tbody><tr *ngFor="let c of conditions" class="slds-theme--shade"><td><div class="slds-select_container"><select class="slds-select" [(ngModel)]="c.fieldname"><option *ngFor="let opt of fieldname_options" value="{{opt}}">{{opt}}</option></select></div></td><td><div class="slds-select_container"><select class="slds-select" [(ngModel)]="c.comparator"><option *ngFor="let opt of comparator_options" value="{{opt.value}}">{{opt.display}}</option></select></div></td><td><div class="slds-form-element__control"><textarea class="slds-textarea" [ngModel]="c.valuations | maybejson" (ngModelChange)="c.valuations=$event"></textarea></div></td><td><div class="slds-form-element__control"><span class="slds-checkbox"><input type="checkbox" name="options" [id]="c.id +\'onchange\'" [(ngModel)]="c.onchange"> <label class="slds-checkbox__label" [attr.for]="c.id +\'onchange\'"><span class="slds-checkbox_faux"></span></label></span></div></td><td><button class="slds-button slds-button--negative" (click)="removeCondition(c.id)"><system-button-icon [icon]="\'delete\'" [size]="\'small\'"></system-button-icon></button></td></tr></tbody></table><div class="slds-grid slds-grid--align-spread slds-p-around--medium"><button class="slds-button slds-button--neutral" (click)="addCondition()">{{language.getLabel(\'LBL_ADD\')}}</button></div>'}),__metadata("design:paramtypes",[services_10.AppDataService,services_1.metadata,services_4.language,services_8.modelutilities])],e)}();exports.ValidationRulesConditions=ValidationRulesConditions;var ValidationRulesActions=function(){function e(e,t,s,l){this.appdata=e,this.metadata=t,this.language=s,this.utils=l,this.action_options=["set_value","set_model_state","set_stati","set_message","error","warning","notice","hide","show","require"],this.fieldname_options=[]}return e.prototype.ngOnInit=function(){for(var e in this.metadata.getModuleFields(this.data.module))this.fieldname_options.push(e)},Object.defineProperty(e.prototype,"actions",{get:function(){return this.data.actions.filter(function(e){return 1!=e.deleted})},enumerable:!0,configurable:!0}),e.prototype.addAction=function(){return this.data.actions.push({id:this.utils.generateGuid(),sysuimodelvalidation_id:this.data.id,_is_new_record:!0})},e.prototype.removeAction=function(t){var e=this.data.actions.findIndex(function(e){return e.id==t});return this.data.actions[e]._is_new_record?this.data.actions.splice(e,1):this.data.actions[e].deleted=1,!0},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"data",void 0),e=__decorate([core_1.Component({selector:"validationrules-actions",template:'<table class="slds-table slds-table--bordered slds-table--cell-buffer"><thead><tr class="slds-text-title--caps"><th scope="col" style="width:2rem;">Fieldname</th><th scope="col" style="width:1rem;">Action</th><th scope="col" style="width:4rem;">Parameter(s)</th><th scope="col" style="width:1rem;">Priority</th><th scope="col" style="width:1rem;"></th></tr></thead><tbody><tr *ngFor="let c of actions" class="slds-theme--shade"><td><div class="slds-select_container"><select class="slds-select" [(ngModel)]="c.fieldname"><option></option><option *ngFor="let opt of fieldname_options" value="{{opt}}">{{opt}}</option></select></div></td><td><div class="slds-select_container"><select class="slds-select" [(ngModel)]="c.action"><option *ngFor="let opt of action_options" value="{{opt}}">{{opt}}</option></select></div></td><td><div class="slds-form-element__control"><textarea class="slds-textarea" [ngModel]="c.params | maybejson" (ngModelChange)="c.params=$event"></textarea></div></td><td><div class="slds-form-element__control"><input type="number" min="0" max="99" class="slds-input" [(ngModel)]="c.priority"></div></td><td><button class="slds-button slds-button--negative" (click)="removeAction(c.id)"><system-button-icon [icon]="\'delete\'" [size]="\'small\'"></system-button-icon></button></td></tr></tbody></table><div class="slds-grid slds-grid--align-spread slds-p-around--medium"><button class="slds-button slds-button--neutral" (click)="addAction()">{{language.getLabel(\'LBL_ADD\')}}</button></div>'}),__metadata("design:paramtypes",[services_10.AppDataService,services_1.metadata,services_4.language,services_8.modelutilities])],e)}();exports.ValidationRulesActions=ValidationRulesActions;var LanguageLabelManagerComponent=function(){function LanguageLabelManagerComponent(e,t,s,l,o,i,a){this.backend=e,this.metadata=t,this.language=s,this.utils=l,this.toast=o,this.footer=i,this.modalservice=a,this.search_term="",this.labels=[],this.languages=[],this._selected_label=null,this.is_searching=!1,this.page=1,this.translation_scope="global",this.scopes=["global","custom"],this.languages=this.language.getAvialableLanguages()}return Object.defineProperty(LanguageLabelManagerComponent.prototype,"selected_label",{get:function(){return this._selected_label},set:function(e){var s=this;if((this._selected_label=e)&&0==e[this.translation_scope+"_translations"].length){for(var t=0,l=this.scopes;t<l.length;t++){var o=l[t];if(0<e[o+"_translations"].length){this.translation_scope=o;break}}e[this.translation_scope+"_translations"].sort(function(e,t){return e.syslanguage==s.language.languagedata.languages.default||e.syslanguage<t.syslanguage?-1:e.syslanguage>t.syslanguage?1:void 0})}},enumerable:!0,configurable:!0}),LanguageLabelManagerComponent.prototype.showRefModal=function(){this.modalservice.openModal("LanguageLabelReferenceConfigModal")},Object.defineProperty(LanguageLabelManagerComponent.prototype,"translations",{get:function(){return this.selected_label[this.translation_scope+"_translations"]},enumerable:!0,configurable:!0}),LanguageLabelManagerComponent.prototype.search=function(e){var t=this;if(void 0===e&&(e=null),this.page=1,e||(e=this.search_term),!e)return!1;this.selected_label=null,this.is_searching=!0,this.backend.getRequest("syslanguages/labels/search/"+this.search_term).subscribe(function(e){t.labels=e,t.is_searching=!1})},LanguageLabelManagerComponent.prototype.addTranslation=function(e,t){(void 0===t&&(t=null),this.selected_label[e+"_translations"]||(this.selected_label[e+"_translations"]=[]),t)||(t=this.getMissingLanguages(e)[0]);this.selected_label[e+"_translations"].push({id:this.utils.generateGuid(),syslanguagelabel_id:this.selected_label.id,syslanguage:t})},LanguageLabelManagerComponent.prototype.getMissingLanguages=function(e){void 0===e&&(e=null),e||(e=this.translation_scope);for(var s=[],t=function(t){l.translations.find(function(e){return e.syslanguage==t.language})||s.push(t)},l=this,o=0,i=this.languages;o<i.length;o++){t(i[o])}return s},LanguageLabelManagerComponent.prototype.addLabel=function(){var t=this,e={id:this.utils.generateGuid(),name:"",scope:"custom",custom_translations:[],global_translations:[]};e.custom_translations.push({id:this.utils.generateGuid(),syslanguagelabel_id:e.id,syslanguage:this.language.languagedata.languages.default}),this.selected_label=e,this.labels.push(e),this.modalservice.openModal("LanguageLabelModal").subscribe(function(e){e.instance.label=t.selected_label,e.instance.label$.subscribe(function(e){t.selected_label=e}),e.instance.close$.subscribe(function(e){t.closeModal(e)})})},LanguageLabelManagerComponent.prototype.deleteLabel=function(s){var l=this;this.modalservice.confirm(this.language.getLabel("LBL_DELETE_LABEL_TEXT"),this.language.getLabel("LBL_DELETE_LABEL_TITLE")).subscribe(function(e){e&&l.backend.deleteRequest("/syslanguages/labels/"+s.id+"/"+s.source).subscribe(function(e){for(var t=0;t<l.labels.length;t++){l.labels[t].id==s.id&&l.labels.splice(t,1)}l.selected_label=null})})},LanguageLabelManagerComponent.prototype.save=function(){var t=this;this.backend.postRequest("/syslanguages/labels",null,[this.selected_label]).subscribe(function(e){t.language.loadLanguage(),t.toast.sendToast("Label saved!")})},LanguageLabelManagerComponent.prototype.closeModal=function(e){switch(e){case"cancel":for(var t=0;t<this.labels.length;t++){var s=this.labels[t];""!=s.name&&s.id!=this.selected_label.id||this.labels.splice(t,1)}break;case"save":this.translation_scope=this.selected_label.scope}},LanguageLabelManagerComponent.prototype.sortTranslations=function(e,t){return e.syslanguage==this.language.languagedata.languages.default||e.syslanguage<t.syslanguage?-1:e.syslanguage>t.syslanguage?1:0},LanguageLabelManagerComponent.prototype.getLangText=function(e){return this.language.getLangText(e)},LanguageLabelManagerComponent=__decorate([core_1.Component({selector:"language-label-manager",template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><div class="slds-form-element__control"><input type="search" class="slds-input" [(ngModel)]="search_term" placeholder="search here..." (keyup.enter)="search()"></div><button class="slds-button slds-button--neutral" [disabled]="!search_term" (click)="search()">search</button></div><div *ngIf="true" class="slds-form-element slds-col--bump-left"><div class="slds-button-group" role="group"><button type="button" class="slds-button slds-button--neutral" (click)="addLabel()">{{language.getLabel(\'LBL_ADD\')}}</button></div></div></div><system-spinner *ngIf="is_searching"></system-spinner><div *ngIf="labels.length > 0 && !is_searching" class="slds-grid"><div class="slds-size--2-of-5 slds-p-around--small"><div class="slds-grid slds-grid--vertical-align-center"><h2 class="slds-p-vertical--small slds-text-heading--small">{{language.getLabel(\'LBL_LABELS\')}}:</h2><div class="slds-col--bump-left"><pagination-controls [(page)]="page" [limit]="20" [total_records]="labels.length" [variation]="\'short\'"></pagination-controls></div></div><article><div class="slds-card slds-m-bottom--small"><div class="slds-card__body slds-p-around--small"><ul class="slds-has-dividers_bottom-space"><li *ngFor="let lbl of labels | paginate: {page: page, limit: 20}" class="slds-item" [ngClass]="{\'slds-theme_inverse\': lbl == selected_label}" style="cursor: pointer;" (click)="selected_label = lbl"><div class="slds-grid slds-grid--vertical-align-center"><span>{{lbl.name}}</span> <span *ngIf="lbl.scope == \'custom\'" class="slds-text-color_weak">custom</span><div class="slds-col--bump-left"><system-utility-icon *ngIf="lbl == selected_label" [icon]="\'close\'" [size]="\'xx-small\'" (click)="deleteLabel(lbl)"></system-utility-icon></div></div></li></ul></div><div class="slds-card__footer"><pagination-controls [(page)]="page" [limit]="20" [total_records]="labels.length"></pagination-controls></div></div></article></div><div *ngIf="selected_label" class="slds-size--3-of-5 slds-p-around--small"><div class="slds-grid slds-grid--vertical-align-center slds-p-bottom--small"><h2 class="slds-p-vertical--small slds-text-heading--small">{{language.getLabel(\'LBL_TRANSLATIONS\')}}:</h2><div class="slds-grid slds-col--bump-left"><span class="slds-radio"><input type="radio" name="translation_scope" [(ngModel)]="translation_scope" id="translation_scope_global" value="global" [disabled]="selected_label.scope == \'custom\'"> <label class="slds-radio__label" for="translation_scope_global"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">global</span></label></span> <span class="slds-radio"><input type="radio" name="translation_scope" [(ngModel)]="translation_scope" id="translation_scope_custom" value="custom"> <label class="slds-radio__label" for="translation_scope_custom"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">custom</span></label></span></div></div><article *ngFor="let trans of translations"><div class="slds-card slds-m-bottom--small"><div class="slds-card__header"><h2>{{getLangText(trans.syslanguage)}}</h2></div><div class="slds-card__body slds-p-around--small"><div class="slds-form-element"><label>short:</label> <input type="text" class="slds-input" [(ngModel)]="trans.translation_short"></div><div class="slds-form-element"><label><abbr class="slds-required">*</abbr>default:</label> <input type="text" class="slds-input" required [(ngModel)]="trans.translation_default"></div><div class="slds-form-element"><label>long:</label> <textarea class="slds-textarea" [(ngModel)]="trans.translation_long"></textarea></div></div></div></article><div class="slds-grid"><div *ngIf="languages.length > translations.length" class="slds-grid"><div class="slds-form-element__control slds-p-right--x-small"><div class="slds-select_container"><select class="slds-select" #add_translation_language><option *ngFor="let lang of getMissingLanguages()" value="{{lang.language}}">{{lang.text}}</option></select></div></div><button class="slds-button slds-button--neutral" title="{{language.getLabel(\'LBL_ADD_TRANSLATION\')}}..." (click)="addTranslation(translation_scope, add_translation_language.value)">{{language.getLabel(\'LBL_ADD\')}}</button></div><div class="slds-col--bump-left"><button type="button" class="slds-button slds-button--brand" [disabled]="labels.length < 1" (click)="save()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_9.toast,services_13.footer,services_3.modal])],LanguageLabelManagerComponent)}();exports.LanguageLabelManagerComponent=LanguageLabelManagerComponent;var SortPipe=function(){function e(){}return e.prototype.transform=function(e,t){return void 0===t&&(t=function(e,t){return t<e?1:-1}),e.sort(t)},e=__decorate([core_1.Pipe({name:"sort"})],e)}();exports.SortPipe=SortPipe;var LanguageLabelModal=function(){function LanguageLabelModal(e,t,s){this.utils=e,this.language=t,this.backend=s,this.label={},this.label$=new core_1.EventEmitter,this.close$=new core_1.EventEmitter,this.languages=[],this.languages=this.language.getAvialableLanguages(!0)}return Object.defineProperty(LanguageLabelModal.prototype,"translations",{get:function(){return this.label[this.label.scope+"_translations"]||[]},set:function(e){this.label[this.label.scope+"_translations"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(LanguageLabelModal.prototype,"name",{get:function(){return this.label.name},set:function(e){e=e.toUpperCase().trim().replace("-","_"),this.label.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(LanguageLabelModal.prototype,"scope",{get:function(){return this.label.scope},set:function(e){this.label[e+"_translations"]=this.translations,this.translations=[],this.label.scope=e},enumerable:!0,configurable:!0}),LanguageLabelModal.prototype.validate=function(){if(!this.label.name)return!1;if(/[^A-Z_0-9]/.test(this.label.name))return!1;for(var e=0,t=this.translations;e<t.length;e++){if(!t[e].translation_default)return!1}return!0},LanguageLabelModal.prototype.save=function(){var t=this;if(this.label.name=this.label.name.toUpperCase(),!this.validate())return!1;this.backend.postRequest("/syslanguages/labels",null,[this.label]).subscribe(function(e){t.label$.emit(t.label),t.close$.emit("save"),t.self.destroy()})},LanguageLabelModal.prototype.cancelDialog=function(){this.label={},this.label$.emit(null),this.close$.emit("cancel"),this.self.destroy()},LanguageLabelModal.prototype.onModalEscX=function(){this.cancelDialog()},LanguageLabelModal.prototype.addTranslation=function(e){(void 0===e&&(e=null),e)||(e=this.getMissingLanguages()[0]);this.label[this.label.scope+"_translations"].push({id:this.utils.generateGuid(),syslanguagelabel_id:this.label.id,syslanguage:e})},LanguageLabelModal.prototype.getMissingLanguages=function(e){void 0===e&&(e=null),e||(e=this.scope);for(var s=[],t=function(t){l.translations.find(function(e){return e.syslanguage==t.language})||s.push(t)},l=this,o=0,i=this.languages;o<i.length;o++){t(i[o])}return s},LanguageLabelModal.prototype.getLangText=function(e){return this.language.getLangText(e)},__decorate([core_1.Input(),__metadata("design:type",Object)],LanguageLabelModal.prototype,"label",void 0),__decorate([core_1.Output("label"),__metadata("design:type",Object)],LanguageLabelModal.prototype,"label$",void 0),__decorate([core_1.Output("close"),__metadata("design:type",Object)],LanguageLabelModal.prototype,"close$",void 0),LanguageLabelModal=__decorate([core_1.Component({selector:"language-label-modal",template:'<div class="slds-backdrop slds-backdrop--open"></div><div role="dialog" class="slds-modal slds-fade-in-open slds-modal_large"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" (click)="cancelDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'" [inverse]="true"></system-button-icon></button><h2 class="slds-text-heading--medium">{{language.getLabel(\'LBL_EDIT\')}}</h2></div><div class="slds-modal__content slds-theme--default slds-p-around--medium slds-p-bottom--xx-small"><div class="slds-grid"><div class="slds-form-element slds-size--3-of-4"><label><abbr class="slds-required">*</abbr>{{language.getLabel(\'LBL_NAME\')}}:</label> <input type="text" class="slds-input" [(ngModel)]="name" placeholder="only A-Z, 0-9 and _ are allowed!"></div><div class="slds-form-element slds-size--1-of-4 slds-p-around--small"><div class="slds-form-element__control"><span class="slds-radio"><input type="radio" id="radio-3" [(ngModel)]="scope" value="global"> <label class="slds-radio__label" for="radio-3"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">global</span></label></span> <span class="slds-radio"><input type="radio" id="radio-4" [(ngModel)]="scope" value="custom"> <label class="slds-radio__label" for="radio-4"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">custom</span></label></span></div></div></div><div><h2>{{language.getLabel(\'LBL_TRANSLATIONS\')}}:</h2><article *ngFor="let trans of translations"><div class="slds-card slds-m-bottom--small"><div class="slds-card__header"><h2>{{getLangText(trans.syslanguage)}}</h2></div><div class="slds-card__body slds-p-around--small"><div class="slds-form-element"><label>short:</label> <input type="text" class="slds-input" [(ngModel)]="trans.translation_short"></div><div class="slds-form-element"><label><abbr class="slds-required">*</abbr>default:</label> <input type="text" class="slds-input" required [(ngModel)]="trans.translation_default"></div><div class="slds-form-element"><label>long:</label> <textarea class="slds-textarea" [(ngModel)]="trans.translation_long"></textarea></div></div></div></article><div *ngIf="languages.length > translations.length" class="slds-grid"><div class="slds-form-element__control slds-p-right--x-small"><div class="slds-select_container"><select class="slds-select" #add_translation_language><option *ngFor="let lang of getMissingLanguages()" value="{{lang.language}}">{{lang.text}}</option></select></div></div><button class="slds-button slds-button--neutral" title="{{language.getLabel(\'LBL_ADD_TRANSLATION\')}}..." (click)="addTranslation(add_translation_language.value)">{{language.getLabel(\'LBL_ADD\')}}</button></div></div></div><div class="slds-modal__footer"><div class="slds-col"><button class="slds-button slds-button--neutral" (click)="cancelDialog()">{{language.getLabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" [disabled]="!validate()" (click)="save()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div></div></div>'}),__metadata("design:paramtypes",[services_8.modelutilities,services_4.language,services_6.backend])],LanguageLabelModal)}();exports.LanguageLabelModal=LanguageLabelModal;var MailboxesManager=function(){function MailboxesManager(e,t,s,l,o,i,a,n,d){var r=this;this.backend=e,this.footer=t,this.language=s,this.metadata=l,this.model=o,this.modelutils=i,this.modelutilities=a,this.toast=n,this.view=d,this.relatecontainerElement=void 0,this.model.module="Mailboxes",this.view.isEditable=!0,this.view.setEditMode(),this.backend.all("Mailboxes").subscribe(function(e){r.mailboxes=e})}return MailboxesManager.prototype.getActionSets=function(){return this.metadata.getActionSets(this.model.module)},MailboxesManager.prototype.getStylesheets=function(){return this.metadata.getHtmlStylesheetNames()},Object.defineProperty(MailboxesManager.prototype,"selected_mailbox",{get:function(){return this.model.id},set:function(e){if(e&&0<e.length)for(var t=0,s=this.mailboxes;t<s.length;t++){var l=s[t];l.id==e&&(this._selected_mailbox=e,this.model.data=l,this.model.id=e,this.addUserSubpanel())}else void 0===e&&(this._selected_mailbox=null,this.model.data={},this.model.id="",this.deleteUserSubpanel())},enumerable:!0,configurable:!0}),MailboxesManager.prototype.addMailbox=function(){var t=this;this.metadata.addComponent("MailboxManagerAddDialog",this.footer.footercontainer).subscribe(function(e){e.instance.closedialog.subscribe(function(e){e&&(t.mailboxes.push(e),t.selected_mailbox=e.id)})})},MailboxesManager.prototype.reset=function(){this.view.setViewMode(),this.model.reset(),this.model.module="Mailboxes"},MailboxesManager.prototype.deleteMailbox=function(){for(var e=this,t=0,s=-1,l=0,o=this.mailboxes;l<o.length;l++){o[l].id===this.selected_mailbox&&(s=t),t++}-1<s&&this.mailboxes.splice(s,1),this.model.delete().subscribe(function(){e.selected_mailbox=void 0,console.log(e.selected_mailbox)})},MailboxesManager.prototype.saveChanges=function(){this.model.save(!0)},MailboxesManager.prototype.addUserSubpanel=function(){var t=this;this.relatecontainerElement&&this.relatecontainerElement.destroy(),this.metadata.addComponent("ObjectRelateContainer",this.relatecontainer).subscribe(function(e){t.relatecontainerElement=e})},MailboxesManager.prototype.deleteUserSubpanel=function(){this.relatecontainerElement.destroy()},MailboxesManager.prototype.setAsDefault=function(){var t=this;this.backend.getRequest("mailboxes/setdefaultmailbox",{mailbox_id:this.model.data.id}).subscribe(function(e){t.toast.sendToast(e),t.model.setField("is_default",!0)},function(e){console.log(e)})},__decorate([core_1.ViewChild("relatecontainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],MailboxesManager.prototype,"relatecontainer",void 0),MailboxesManager=__decorate([core_1.Component({providers:[services_2.model,services_7.view],selector:"mailboxes-manager",template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><label class="slds-form-element__label">{{language.getLabel(\'LBL_MAILBOX\')}}</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="selected_mailbox"><option disabled></option><option *ngFor="let mailbox of this.mailboxes" [value]="mailbox.id">{{mailbox.name}}</option></select></div></div></div><div class="slds-form-element slds-col--bump-left"><div class="slds-button-group" role="group"><button type="button" class="slds-button slds-button--neutral" (click)="addMailbox()">{{language.getLabel(\'LBL_ADD\')}}</button></div></div></div><ng-container *ngIf="selected_mailbox"><system-section titlelabel="LBL_MAIN_DATA"><div class="slds-p-horizontal--medium slds-p-vertical--small"><div class="slds-form--compound slds-p-vertical--x-small"><field-label [fieldname]="\'name\'"></field-label><field-container [fieldname]="\'name\'"></field-container></div><div class="slds-form--compound slds-p-vertical--x-small"><field-label [fieldname]="\'description\'"></field-label><field-container [fieldname]="\'description\'"></field-container></div><div class="slds-form--compound slds-p-vertical--x-small"><field-label [fieldname]="\'transport\'"></field-label><field-container [fieldname]="\'transport\'"></field-container></div><div class="slds-grid slds-p-vertical--x-small"><div class="slds-form-element slds-size--1-of-3"><field-label [fieldname]="\'active\'"></field-label><field-container [fieldname]="\'active\'"></field-container></div><div class="slds-form-element slds-size--1-of-3"><field-label [fieldname]="\'inbound_comm\'"></field-label><field-container [fieldname]="\'inbound_comm\'"></field-container></div><div class="slds-form-element slds-size--1-of-3"><field-label [fieldname]="\'outbound_comm\'"></field-label><field-container [fieldname]="\'outbound_comm\'"></field-container></div></div><div class="slds-grid"><div class="slds-button-group slds-col--bump-left" role="group"><button type="button" class="slds-button slds-button--neutral" [disabled]="model.data.is_default" (click)="setAsDefault()">{{language.getLabel(\'LBL_SET_DEFAULT\')}}</button> <button type="button" class="slds-button slds-button--neutral" [disabled]="model.data.is_default" (click)="deleteMailbox()">{{language.getLabel(\'LBL_DELETE\')}}</button> <button type="button" class="slds-button slds-button--brand" (click)="saveChanges()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div></div></system-section><system-section *ngIf="model.data.transport" titlelabel="LBL_TRANSPORT"><div class="slds-p-vertical--x-small"><mailboxes-imap-smtp-traffic-manager *ngIf="model.data.transport == \'imap\'"></mailboxes-imap-smtp-traffic-manager><mailboxes-mailgun-traffic-manager *ngIf="model.data.transport == \'mailgun\'"></mailboxes-mailgun-traffic-manager><mailboxes-sendgrid-traffic-manager *ngIf="model.data.transport == \'sendgrid\'"></mailboxes-sendgrid-traffic-manager></div></system-section><system-section titlelabel="LBL_EMAIL" [expanded]="false"><div class="slds-grid slds-p-horizontal--medium slds-p-vertical--small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><field-label [fieldname]="\'mailbox_header\'"></field-label><field-container [fieldname]="\'mailbox_header\'"></field-container></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><field-label [fieldname]="\'mailbox_footer\'"></field-label><field-container [fieldname]="\'mailbox_footer\'"></field-container></div></div><div class="slds-p-horizontal--medium slds-p-vertical--x-small"><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Stylesheet</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="model.data.stylesheet"><option></option><option *ngFor="let stylesheet of getStylesheets()" [value]="stylesheet.id">{{stylesheet.name}}</option></select></div></div></div></div></system-section><system-section titlelabel="LBL_PROCESSING" [expanded]="true"><div class="slds-p-horizontal--medium slds-p-vertical--small"><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Actionset</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="model.data.actionset"><option></option><option *ngFor="let actionset of getActionSets()" [value]="actionset.id">{{actionset.name}}</option></select></div></div></div><mailboxes-processors></mailboxes-processors></div></system-section><div class="slds-p-around--small"><div #relatecontainer></div></div></ng-container>'}),__metadata("design:paramtypes",[services_6.backend,services_13.footer,services_4.language,services_1.metadata,services_2.model,services_8.modelutilities,services_8.modelutilities,services_9.toast,services_7.view])],MailboxesManager)}();exports.MailboxesManager=MailboxesManager;var MailboxesmanagerTestModal=function(){function MailboxesmanagerTestModal(e,t,s){this.backend=e,this.language=t,this.model=s,this.self={},this.validConnection=!1,this.isvalid=new core_1.EventEmitter,this.testemailaddress="",this.testing=!1,this.tested=!1}return MailboxesmanagerTestModal.prototype.testConnection=function(){var t=this;this.testing=!0,this.testemailaddress=this.testemailaddress.trim(),this.backend.getRequest("mailboxes/test",{mailbox_id:this.model.data.id,test_email:this.testemailaddress}).subscribe(function(e){!0===e.result?t.validConnection=!0:t.validConnection=!1,t.tested=!0,t.testing=!1},function(e){t.tested=!1,t.testing=!1,t.validConnection=!1})},MailboxesmanagerTestModal.prototype.close=function(){this.isvalid.emit(this.validConnection),this.self.destroy()},MailboxesmanagerTestModal.prototype.onModalEscX=function(){this.close()},MailboxesmanagerTestModal=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()">{{language.getLabel(\'LBL_TESTEMAIL_DELIVERY\')}}</system-modal-header><system-modal-content><div class="slds-form-element slds-size--1-of-1"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_DESTINATION_ADDRESS\')}}</label> <input type="text" [disabled]="testing" [(ngModel)]="testemailaddress" class="slds-input"></div></system-modal-content><system-modal-footer><div class="slds-grid slds-grid--vertical-align-center"><div *ngIf="testing" class="slds-grid slds-grid--vertical-align-center"><system-spinner size="10"></system-spinner><span class="slds-p-horizontal--xx-small">{{language.getLabel(\'LBL_TESTING\')}}</span></div><div *ngIf="!testing && validConnection" class="slds-grid slds-grid--vertical-align-center"><system-utility-icon icon="check" size="x-small"></system-utility-icon><span class="slds-p-horizontal--xx-small">{{language.getLabel(\'LBL_OK\')}}</span></div><button [disabled]="!validConnection" class="slds-button slds-col--bump-left slds-button--neutral" (click)="close()">{{language.getAppLanglabel(\'LBL_CLOSE\')}}</button> <button [disabled]="testemailaddress.trim().length === 0" class="slds-button slds-button--brand" (click)="testConnection()">{{language.getAppLanglabel(\'LBL_TEST\')}}</button></div></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_6.backend,services_4.language,services_2.model])],MailboxesmanagerTestModal)}();exports.MailboxesmanagerTestModal=MailboxesmanagerTestModal;var MailboxesmanagerTestIMAPModal=function(){function MailboxesmanagerTestIMAPModal(e,t,s){this.backend=e,this.language=t,this.model=s,this.self={},this.validConnection=!1,this.isvalid=new core_1.EventEmitter,this.testemailaddress="",this.imapStatus=!1,this.smtpStatus=!1,this.testing=!1,this.tested=!1}return Object.defineProperty(MailboxesmanagerTestIMAPModal.prototype,"isInbound",{get:function(){return!!this.model.getFieldValue("inbound_comm")},enumerable:!0,configurable:!0}),Object.defineProperty(MailboxesmanagerTestIMAPModal.prototype,"isOutbound",{get:function(){return"no"!=this.model.getFieldValue("outbound_comm")},enumerable:!0,configurable:!0}),MailboxesmanagerTestIMAPModal.prototype.testConnection=function(){var t=this;this.testing=!0,this.backend.getRequest("mailboxes/test",{mailbox_id:this.model.data.id,test_email:this.testemailaddress}).subscribe(function(e){t.validConnection=!0,t.isInbound&&(!0!==e.imap.result&&(t.validConnection=!1),e.imap.errors&&0<e.imap.errors.length?t.imapStatus=!1:t.imapStatus=!0),t.isOutbound&&(e.smtp.errors&&0<e.smtp.errors.length?(t.smtpStatus=!1,t.validConnection=!1):t.smtpStatus=!0),t.tested=!0,t.testing=!1},function(e){t.testing=!1})},MailboxesmanagerTestIMAPModal.prototype.cancel=function(){this.self.destroy()},MailboxesmanagerTestIMAPModal.prototype.close=function(){this.isvalid.emit(this.validConnection),this.self.destroy()},Object.defineProperty(MailboxesmanagerTestIMAPModal.prototype,"imapIcon",{get:function(){return this.imapStatus?"check":"close"},enumerable:!0,configurable:!0}),Object.defineProperty(MailboxesmanagerTestIMAPModal.prototype,"smtpIcon",{get:function(){return this.smtpStatus?"check":"close"},enumerable:!0,configurable:!0}),MailboxesmanagerTestIMAPModal=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"></system-modal-header><system-modal-content><div class="slds-form-element slds-size--1-of-1"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_TEST_EMAIL\')}}</label> <input type="text" [(ngModel)]="testemailaddress" class="slds-input"></div><div class="slds-p-vertical--x-small"><div *ngIf="isInbound" class="slds-grid slds-grid--align-spread slds-grid_vertical-align-center slds-p-vertical--xxx-small"><div>{{language.getLabel(\'LBL_IMAP\')}}</div><system-utility-icon size="xx-small" [icon]="imapIcon"></system-utility-icon></div><div *ngIf="isOutbound" class="slds-grid slds-grid--align-spread slds-grid_vertical-align-center slds-p-vertical--xxx-small"><div>{{language.getLabel(\'LBL_SMTP\')}}</div><system-utility-icon size="xx-small" [icon]="smtpIcon"></system-utility-icon></div></div></system-modal-content><system-modal-footer><div class="slds-grid slds-grid--vertical-align-center"><div *ngIf="testing" class="slds-grid slds-grid--vertical-align-center"><system-spinner size="10"></system-spinner><span class="slds-p-horizontal--xx-small">{{language.getLabel(\'LBL_TESTING\')}}</span></div><div *ngIf="!testing && validConnection" class="slds-grid slds-grid--vertical-align-center"><system-utility-icon icon="check" size="x-small"></system-utility-icon><span class="slds-p-horizontal--xx-small">{{language.getLabel(\'LBL_OK\')}}</span></div><button class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()">{{language.getAppLanglabel(\'LBL_TEST\')}}</button> <button class="slds-button slds-button--neutral" (click)="cancel()">{{language.getAppLanglabel(\'LBL_CANCEL\')}}</button> <button [disabled]="!validConnection" class="slds-button slds-button--brand" (click)="close()">{{language.getAppLanglabel(\'LBL_OK\')}}</button></div></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_6.backend,services_4.language,services_2.model])],MailboxesmanagerTestIMAPModal)}();exports.MailboxesmanagerTestIMAPModal=MailboxesmanagerTestIMAPModal;var MailboxesMailgunTrafficManager=function(){function e(e,t,s,l,o,i,a,n){this.metadata=e,this.language=t,this.backend=s,this.model=l,this.modal=o,this.toast=i,this.view=a,this.ViewContainerRef=n,this.model.module="Mailboxes",this.view.isEditable=!0,this.view.setEditMode()}return e.prototype.ngOnInit=function(){0===this.model.data.settings.length&&(this.model.data.settings={api_key:"",domain:"",imap_pop3_display_name:"",imap_pop3_username:"",reply_to:""})},e.prototype.testConnection=function(){this.modal.openModal("MailboxesmanagerTestModal",!0,this.ViewContainerRef.injector).subscribe(function(e){console.log("test happened")})},e=__decorate([core_1.Component({selector:"mailboxes-mailgun-traffic-manager",template:'<div class="slds-p-horizontal--medium slds-p-vertical--small"><h1>{{language.getLabel(\'LBL_MAILGUN\')}}</h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_DISPLAY_NAME\')}}</label> <input type="text" [(ngModel)]="model.data.settings.imap_pop3_display_name" class="slds-input ng-pristine ng-valid"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_DOMAIN\')}}</label> <input type="text" [(ngModel)]="model.data.settings.domain" class="slds-input ng-pristine ng-valid"></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_USER_NAME\')}}</label> <input type="text" [(ngModel)]="model.data.settings.imap_pop3_username" class="slds-input ng-pristine ng-valid"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_API_KEY\')}}</label> <input type="text" [(ngModel)]="model.data.settings.api_key" class="slds-input ng-pristine ng-valid"></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_REPLY_TO\')}}</label> <input type="text" [(ngModel)]="model.data.settings.reply_to" class="slds-input ng-pristine ng-valid"></div></div><div class="slds-grid slds-p-vertical--xx-small"><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()" [disabled]="valid_connection">{{language.getLabel(\'LBL_TEST_CONNECTION\')}}</button></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_4.language,services_6.backend,services_2.model,services_3.modal,services_9.toast,services_7.view,core_1.ViewContainerRef])],e)}();exports.MailboxesMailgunTrafficManager=MailboxesMailgunTrafficManager;var MailboxesSendgridTrafficManager=function(){function e(e,t,s,l,o,i,a,n){this.metadata=e,this.language=t,this.backend=s,this.model=l,this.modal=o,this.toast=i,this.view=a,this.ViewContainerRef=n,this.model.module="Mailboxes",this.view.isEditable=!0,this.view.setEditMode()}return e.prototype.ngOnInit=function(){0===this.model.data.settings.length&&(this.model.data.settings={api_key:"",imap_pop3_display_name:"",imap_pop3_username:"",reply_to:""})},e.prototype.testConnection=function(){this.modal.openModal("MailboxesmanagerTestModal",!0,this.ViewContainerRef.injector).subscribe(function(e){console.log("test happened")})},e=__decorate([core_1.Component({selector:"mailboxes-sendgrid-traffic-manager",template:'<div class="slds-p-horizontal--medium slds-p-vertical--small"><h1>{{language.getLabel(\'LBL_SENDGRID\')}}</h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_DISPLAY_NAME\')}}</label> <input type="text" [(ngModel)]="model.data.settings.imap_pop3_display_name" class="slds-input ng-pristine ng-valid"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_REPLY_TO\')}}</label> <input type="text" [(ngModel)]="model.data.settings.reply_to" class="slds-input ng-pristine ng-valid"></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_USER_NAME\')}}</label> <input type="text" [(ngModel)]="model.data.settings.imap_pop3_username" class="slds-input ng-pristine ng-valid"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_API_KEY\')}}</label> <input type="text" [(ngModel)]="model.data.settings.api_key" class="slds-input ng-pristine ng-valid"></div></div><div class="slds-grid slds-p-vertical--xx-small"><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()" [disabled]="valid_connection">{{language.getLabel(\'LBL_SEND_TEST_EMAIL\')}}</button></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_4.language,services_6.backend,services_2.model,services_3.modal,services_9.toast,services_7.view,core_1.ViewContainerRef])],e)}();exports.MailboxesSendgridTrafficManager=MailboxesSendgridTrafficManager;var MailboxManagerAddDialog=function(){function MailboxManagerAddDialog(e,t,s,l,o){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.model=o,this.closedialog=new core_1.EventEmitter,this.mailbox_name="",this.self=null,this.saving=!1}return MailboxManagerAddDialog.prototype.closeDialog=function(){this.closedialog.emit(!1),this.self.destroy()},MailboxManagerAddDialog.prototype.add=function(){var e=this;this.model.module="Mailboxes",this.model.id=this.modelutilities.generateGuid(),this.model.data.name=this.mailbox_name,this.saving=!0,this.model.save().subscribe(function(){e.closedialog.emit(e.model.data),e.self.destroy()})},MailboxManagerAddDialog.prototype.getComponents=function(){return this.metadata.getSystemComponents()},__decorate([core_1.Input(),__metadata("design:type",Array)],MailboxManagerAddDialog.prototype,"mailboxes",void 0),MailboxManagerAddDialog=__decorate([core_1.Component({selector:"mailboxmanager-add-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium">{{language.getLabel(\'LBL_ADD\')}} {{language.getLabel(\'LBL_MAILBOX\')}}</h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element"><label class="slds-form-element__label">{{language.getLabel(\'LBL_MAILBOX\')}}</label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="mailbox_name" [disabled]="saving"></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()" [disabled]="saving">{{language.getLabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" (click)="add()" [disabled]="saving">{{language.getLabel(\'LBL_ADD\')}}</button></div></div></div><div class="slds-backdrop slds-backdrop--open"></div>',providers:[services_2.model]}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_2.model])],MailboxManagerAddDialog)}();exports.MailboxManagerAddDialog=MailboxManagerAddDialog;var MailboxesIMAPSMTPSelectFoldersModal=function(){function MailboxesIMAPSMTPSelectFoldersModal(e,t,s){this.language=e,this.model=t,this.view=s,this.modifiedData=[],this.mailboxes=[]}return MailboxesIMAPSMTPSelectFoldersModal.prototype.ngOnInit=function(){},MailboxesIMAPSMTPSelectFoldersModal.prototype.setModel=function(e){this.model.id=e.id,this.model.module=e.module,this.model.data=e.data,this.modifiedData=__assign({},e.data)},MailboxesIMAPSMTPSelectFoldersModal.prototype.setMailboxes=function(e){this.mailboxes=e},MailboxesIMAPSMTPSelectFoldersModal.prototype.cancel=function(){this.self.destroy()},MailboxesIMAPSMTPSelectFoldersModal.prototype.save=function(){this.model.save(),this.self.destroy()},MailboxesIMAPSMTPSelectFoldersModal=__decorate([core_1.Component({providers:[services_2.model,services_7.view],selector:"mailbox-folders-modal",template:'<system-modal><system-modal-header (close)="cancel()">{{language.getModuleLabel(model.module, \'LBL_MAILBOX_FOLDERS\')}}</system-modal-header><system-modal-content><div class="slds-grid slds-wrap slds-grid--pull-padded"><div class="slds-col"><div class="slds-form-element"><label class="slds-truncate slds-form-element__label">Inbox folder</label><select [disabled]="mailboxes.length == 0" [(ngModel)]="model.data.settings.imap_inbox_dir" type="text" class="slds-select ng-pristine ng-valid"><option *ngFor="let mailbox of mailboxes" value="{{ mailbox }}">{{ mailbox }}</option></select></div><div class="slds-form-element"><label class="slds-truncate slds-form-element__label">Sent folder</label><select [disabled]="mailboxes.length == 0" [(ngModel)]="model.data.settings.imap_sent_dir" type="text" class="slds-select ng-pristine ng-valid"><option *ngFor="let mailbox of mailboxes" value="{{ mailbox }}">{{ mailbox }}</option></select></div><div class="slds-form-element"><label class="slds-truncate slds-form-element__label">Trash folder</label><select [disabled]="mailboxes.length == 0" [(ngModel)]="model.data.settings.imap_trash_dir" type="text" class="slds-select ng-pristine ng-valid"><option *ngFor="let mailbox of mailboxes" value="{{ mailbox }}">{{ mailbox }}</option></select></div></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="cancel()">{{language.getLabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" (click)="save()">{{language.getLabel(\'LBL_SAVE\')}}</button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_4.language,services_2.model,services_7.view])],MailboxesIMAPSMTPSelectFoldersModal)}();exports.MailboxesIMAPSMTPSelectFoldersModal=MailboxesIMAPSMTPSelectFoldersModal;var LabelSelectorComponent=function(){function LabelSelectorComponent(e,t,s){this.language=e,this.backend=t,this.utils=s,this.select$=new core_1.EventEmitter,this._selected_item=null,this._disabled=!1,this.option={},this.is_searching=!1,this.items=[],this.show_results=!1,this.show_modal=!1,this.max_results=100,this.showInfo=!1}return LabelSelectorComponent.prototype.removeSelected=function(){this.selected_item=null},Object.defineProperty(LabelSelectorComponent.prototype,"selected_item",{get:function(){return this._selected_item&&""==this._selected_item.name&&(this._selected_item=null),this._selected_item},set:function(e){e!=this._selected_item&&this.select$.emit(e),e&&(this.show_results=!1),this._selected_item=e},enumerable:!0,configurable:!0}),Object.defineProperty(LabelSelectorComponent.prototype,"disabled",{get:function(){return this._disabled},enumerable:!0,configurable:!0}),LabelSelectorComponent.prototype.removeSelection=function(){this.selected_item=null},LabelSelectorComponent.prototype.search=function(e){var s=this;if(void 0===e&&(e=null),!e)return!1;this._selected_item=null,this.is_searching=!0,this.backend.getRequest("syslanguages/labels/search/"+e).subscribe(function(e){var t=s.setActualLanguage(e);s.items=t.slice(0,s.max_results),s.is_searching=!1})},LabelSelectorComponent.prototype.setActualLanguage=function(e){for(var t=0,s=e;t<s.length;t++){var l=s[t],o="",i=[];l.currentTranslation="","custom"==l.scope&&(i=l.custom_translations),"global"==l.scope&&(i=l.global_translations);for(var a=0,n=i;a<n.length;a++){var d=n[a];"en_us"==d.syslanguage&&(o=d.translation_default),"de_DE"==d.syslanguage&&(o=d.translation_default),d.syslanguage==this.language.currentlanguage&&(l.currentTranslation=d.translation_default)}""==l.currentTranslation&&(l.currentTranslation=o)}return e},LabelSelectorComponent.prototype.addItem=function(){var e={id:this.utils.generateGuid(),name:"",scope:"custom",custom_translations:[],global_translations:[]};e.custom_translations.push({id:this.utils.generateGuid(),syslanguagelabel_id:e.id,syslanguage:this.language.languagedata.languages.default}),this._selected_item=e,this.items.push(e),this.show_modal=!0},LabelSelectorComponent.prototype.onModalClose=function(e){switch(this.show_modal=!1,e){case"cancel":for(var t=0;t<this.items.length;t++){var s=this.items[t];""!=s.name&&s.id!=this.selected_item.id||this.items.splice(t,1)}this.selected_item=null;break;case"save":this.select$.emit(this.selected_item)}},__decorate([core_1.Output("select"),__metadata("design:type",Object)],LabelSelectorComponent.prototype,"select$",void 0),__decorate([core_1.Input("selected_item"),__metadata("design:type",Object)],LabelSelectorComponent.prototype,"_selected_item",void 0),__decorate([core_1.Input("disabled"),__metadata("design:type",Object)],LabelSelectorComponent.prototype,"_disabled",void 0),__decorate([core_1.Input("option"),__metadata("design:type",Object)],LabelSelectorComponent.prototype,"option",void 0),LabelSelectorComponent=__decorate([core_1.Component({selector:"label-selector",template:'<div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">{{option.option}}</label><div class="slds-form-element__control"><div class="slds-select_container"><div *ngIf="selected_item" class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"><div class="slds-pill_container"><span class="slds-pill slds-size--1-of-1"><span class="slds-pill__label">{{selected_item.name}}</span><span *ngIf="selected_item.scope == \'custom\'" class="slds-text-color_weak">custom</span> <button [disabled]="disabled" class="slds-button slds-button--icon slds-pill__remove" style="margin-right: 5px;" (click)="removeSelection()"><system-button-icon [icon]="\'close\'"></system-button-icon></button></span></div></div><div *ngIf="!selected_item" class="slds-combobox_container"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" aria-haspopup="listbox" role="combobox"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"><input [disabled]="disabled" type="text" class="slds-input slds-combobox__input" aria-controls="listbox-unique-id-68dg4" aria-autocomplete="list" autocomplete="off" role="textbox" placeholder="{{language.getLabel(\'LBL_SEARCHE_HERE\')}}" #search_term (focus)="show_results = true" (focusout)="show_results = false" (keyup)="search(search_term.value)" (keyup.escape)="show_results = false"> <span class="slds-icon_container slds-icon-utility-search slds-input__icon slds-input__icon_right" style="margin-right: 5px;"><system-utility-icon [icon]="\'search\'" [size]="\'xx-small\'"></system-utility-icon></span></div></div><div *ngIf="show_results" role="listbox"><system-spinner *ngIf="is_searching"></system-spinner><ul *ngIf="!is_searching" class="slds-listbox slds-listbox_vertical slds-dropdown slds-dropdown_fluid" role="presentation"><li *ngFor="let item of items" class="slds-listbox__item" role="presentation"><div class="slds-listbox__option slds-listbox__option_entity" style="clear: both;" role="option" (mousedown)="selected_item = item"><system-custom-icon [icon]="item.scope" size="x-small" addclasses="slds-listbox__option-text slds-input__icon slds-input__icon_left slds-float_left"></system-custom-icon><span class="slds-p-left--medium slds-listbox__option-text slds-listbox__option-text_entity slds-float_left" style="margin-right: 5px;">{{item.currentTranslation}}</span> <span class="slds-p-left--medium slds-listbox__option-text slds-listbox__option-text_entity slds-float_left" style="margin-right: 5px; font-size: 10px;">[{{item.name}}]</span><div class="slds-float_left" style="position: relative; margin-top: 3px;"><div class="slds-form-element"><div class="slds-form-element__icon slds-align-middle"><button class="slds-button slds-button_icon slds-button slds-button_icon" aria-describedby="help" title="Description" (mouseenter)="item.showInfo = true" (mouseleave)="item.showInfo = false"><system-button-icon [size]="\'small\'" [icon]="\'info\'"></system-button-icon></button></div></div><div *ngIf="item.showInfo" class="slds-popover slds-popover_tooltip slds-nubbin_bottom-right slds-rise-from-ground" role="tooltip" id="help" style="position: absolute; bottom: 25px; right: -17px; width: 320px; height: auto;"><div class="slds-popover__body slds-scrollable_y"><system-custom-icon [icon]="item.scope" size="x-small" color="#fff" addclasses="slds-input__icon slds-input__icon_left slds-float_right"></system-custom-icon><div *ngIf="item.custom_translations.length == 0"><ul role="presentation"><li *ngFor="let trans of item.global_translations" role="presentation"><b>{{trans.syslanguage}}</b><br><div *ngIf="trans.translation_default"><u>Default</u>: {{trans.translation_default}}<br></div><div *ngIf="trans.translation_long"><u>Long</u>: {{trans.translation_long}}<br></div><div *ngIf="trans.translation_short"><u>Short</u>: {{trans.translation_short}}<br></div><br></li></ul></div><div *ngIf="item.custom_translations.length > 0"><ul *ngIf="item.custom_translations.length > 0" role="presentation"><li *ngFor="let trans of item.custom_translations" role="presentation"><b>{{trans.syslanguage}}</b><br><div *ngIf="trans.translation_default"><u>Default</u>: {{trans.translation_default}}<br></div><div *ngIf="trans.translation_long"><u>Long</u>: {{trans.translation_long}}<br></div><div *ngIf="trans.translation_short"><u>Short</u>: {{trans.translation_short}}<br></div><br></li></ul></div></div></div></div></div></li><li *ngIf="items.length == max_results" class="slds-listbox__item" role="presentation"><div class="slds-listbox__option slds-listbox__option_entity" style="clear: both;" role="option"><span class="slds-p-left--medium slds-listbox__option-text slds-listbox__option-text_entity">{{language.getLabel(\'LBL_TO_MANY_RESULTS\')}}...</span></div></li><li class="slds-listbox__item slds-border_top" role="presentation" style="clear: both;" (mousedown)="addItem()"><button class="slds-button slds-button--icon slds-align_absolute-center"><system-utility-icon [icon]="\'add\'" [size]="\'x-small\'"></system-utility-icon></button></li></ul></div></div></div></div></div><div *ngIf="show_modal"><language-label-modal [(label)]="selected_item" (close)="onModalClose($event)"></language-label-modal></div>'}),__metadata("design:paramtypes",[services_4.language,services_6.backend,services_8.modelutilities])],LabelSelectorComponent)}();exports.LabelSelectorComponent=LabelSelectorComponent;var ServiceCategoryManagerComponent=function(){function ServiceCategoryManagerComponent(e,t,s,l,o,i,a){var n=this;this.appdata=e,this.backend=t,this.metadata=s,this.language=l,this.config=o,this.utils=i,this.toast=a,this.category_tree=[],this.levels=[],this.max_levels=4,this.loading=!0,this.selected_categorys=[],this.edit_category=null,this.service_queues=[],this.config.getData("service_category_tree")?this.initializeTree(this.config.getData("service_category_tree")):this.backend.getRequest("spiceui/core/servicecategories/tree").subscribe(function(e){n.config.setData("service_category_tree",e),n.initializeTree(e)}),this.backend.all("ServiceQueues",{}).subscribe(function(e){n.service_queues=e})}return ServiceCategoryManagerComponent.prototype.initializeTree=function(e){this.category_tree=e;for(var t=0;t<this.max_levels;t++)this.levels[t]=[];this.levels[0]=this.category_tree,this.loading=!1},ServiceCategoryManagerComponent.prototype.resetLevels=function(e){void 0===e&&(e=0);for(var t=e;t<this.max_levels;t++)this.levels[t]=[];this.selected_categorys.splice(e,this.max_levels-e)},ServiceCategoryManagerComponent.prototype.select=function(e){(this.selected_categorys[e.level]=e).categories?(this.levels[e.level+1]=e.categories,this.resetLevels(e.level+2)):this.resetLevels(e.level+1)},ServiceCategoryManagerComponent.prototype.addCategory=function(e){void 0===e&&(e=null);var t={id:this.utils.generateGuid(),name:"new Category...",keyname:null,parent_id:null,selectable:0,favorite:0,servicequeue_id:null,level:0};e?(e.categories||(e.categories=[]),t.parent_id=e.id,t.level=e.level+1,t.level>this.max_levels&&(this.max_levels=t.level),e.categories.push(t),this.levels[e.level+1]=e.categories):(this.category_tree.push(t),this.levels[0]=this.category_tree),this.select(t),this.edit(t)},ServiceCategoryManagerComponent.prototype.removeCategory=function(e){if(e.categories&&!confirm("Are you sure you want to delete this Category? There are "+e.categories.length+" Subcategories which will be get deleted too!"))return!1;e==this.edit_category&&(this.edit_category=null);for(var t=0,s=0,l=this.category_tree;s<l.length;s++){var o=l[s];if(o==e)return this.category_tree.splice(t,1),!0;i(o,e),t++}function i(e,t){if(e.categories)for(var s=0;s<e.categories.length;s++){if(e.categories[s]==t)return e.categories.splice(s,1),!0;i(e.categories[s],t)}return!1}},ServiceCategoryManagerComponent.prototype.edit=function(e){this.selected_categorys[e.level]=e,this.edit_category=e},ServiceCategoryManagerComponent.prototype.save=function(){var t=this;this.backend.postRequest("spiceui/core/servicecategories/tree",null,this.category_tree).subscribe(function(e){t.toast.sendToast("changes saved")},function(e){t.toast.sendAlert("saving failed!"),console.error(e)})},ServiceCategoryManagerComponent.prototype.isCategorySelected=function(e){for(var t=0,s=this.selected_categorys;t<s.length;t++){if(s[t].id==e.id)return!0}return!1},ServiceCategoryManagerComponent=__decorate([core_1.Component({template:'<div class="slds-grid slds-grid--align-spread slds-p-around--medium"><h2 class="slds-text-heading--medium">Service Categories</h2><button class="slds-button slds-button--brand" (click)="save()">Save</button></div><article class="slds-card slds-m-around--small"><div class="slds-card__header"><header class="slds-has-flexi-truncate"><h2>Service Category Tree</h2></header></div><div class="slds-card__body slds-card__body_inner slds-grid"><div *ngIf="loading" class="slds-p-around--small slds-align--absolute-center"><system-spinner></system-spinner></div><div *ngFor="let lvl of levels; let i = index" class="slds-col slds-size--1-of-2" [ngStyle]="{width: 100/levels.length+\'%\'}" [ngClass]="{\'slds-border--right\': i < max_levels -1}"><div *ngFor="let cat of lvl" [ngClass]="{\'slds-theme--shade\': isCategorySelected(cat) || cat == edit_category, \'slds-theme_alert-texture\': cat == edit_category}"><div class="slds-grid slds-grid--vertical-align-center slds-p-around--xx-small" (mouseenter)="select(cat)"><span class="slds-truncate" style="cursor: pointer;" (click)="edit(cat)">{{cat.name}}</span><system-utility-icon class="slds-m-left--small" *ngIf="cat.favorite == 1" [icon]="\'favorite\'" [size]="\'xx-small\'"></system-utility-icon><div class="slds-col--bump-left"><system-utility-icon *ngIf="cat.level < max_levels-1" [icon]="\'add\'" [size]="\'xx-small\'" style="cursor:pointer;" (click)="addCategory(cat)"></system-utility-icon><system-utility-icon *ngIf="cat.categories" [icon]="\'chevronright\'" [size]="\'xx-small\'"></system-utility-icon></div></div></div><div *ngIf="i == 0" class="slds-p-around--xx-small"><system-utility-icon [icon]="\'add\'" [size]="\'xx-small\'" style="cursor:pointer;" (click)="addCategory()"></system-utility-icon></div></div></div></article><article *ngIf="edit_category" class="slds-card slds-m-around--small slds-size--1-of-4 slds-theme--shade slds-theme_alert-texture"><div class="slds-card__header slds-grid"><header class="slds-has-flexi-truncate"><h2>Edit Category</h2></header><system-utility-icon [icon]="\'close\'" [size]="\'xx-small\'" style="cursor: pointer;" (click)="removeCategory(edit_category)"></system-utility-icon></div><div class="slds-card__body slds-card__body_inner"><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Name:</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="edit_category.name"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Key:</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="edit_category.keyname"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Service Queue (hierarchical):</label><div class="slds-form-element__control"><select class="slds-select" [(ngModel)]="edit_category.servicequeue_id"><option></option><option *ngFor="let opt of service_queues" value="{{opt.id}}">{{opt.name}}</option></select></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><div class="slds-form-element slds-p-top--small"><div class="slds-form-element__control slds-grid"><span class="slds-checkbox"><input type="checkbox" name="options" id="checkbox-42" [(ngModel)]="edit_category.favorite"> <label class="slds-checkbox__label" for="checkbox-42"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">Favorite</span></label></span> <span class="slds-checkbox"><input type="checkbox" name="options" id="checkbox-49" [(ngModel)]="edit_category.selectable"> <label class="slds-checkbox__label" for="checkbox-49"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">Selectable</span></label></span></div></div></div></div></article>'}),__metadata("design:paramtypes",[services_10.AppDataService,services_6.backend,services_1.metadata,services_4.language,services_12.configurationService,services_8.modelutilities,services_9.toast])],ServiceCategoryManagerComponent)}();exports.ServiceCategoryManagerComponent=ServiceCategoryManagerComponent;var MailboxesImapSmtpTrafficManager=function(){function e(e,t,s,l,o,i,a,n,d){this.backend=e,this.footer=t,this.language=s,this.metadata=l,this.model=o,this.modal=i,this.toast=a,this.view=n,this.ViewContainerRef=d,this.mailboxes=[],this.validConnection=!1,this.modelsubscription=void 0}return e.prototype.ngOnInit=function(){0===this.model.data.settings.length&&(this.model.data.settings={imap_inbox_dir:"",imap_pop3_display_name:"",imap_pop3_encryption:"",imap_pop3_host:"",imap_pop3_password:"",imap_pop3_port:"",imap_pop3_protocol_type:"",imap_pop3_username:"",imap_sent_dir:"",imap_trash_dir:"",smtp_allow_self_signed:"",smtp_auth:"",smtp_encryption:"",smtp_host:"",smtp_port:"",smtp_verify_peer:"",smtp_verify_peer_name:"",reply_to:""})},e.prototype.handleModelChange=function(e){this.validConnection=!1,this.mailboxes=[]},Object.defineProperty(e.prototype,"isInbound",{get:function(){return!!this.model.getFieldValue("inbound_comm")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOutbound",{get:function(){return"no"!=this.model.getFieldValue("outbound_comm")},enumerable:!0,configurable:!0}),e.prototype.getMailboxes=function(){var t=this,s=new rxjs_1.Subject;return this.backend.getRequest("mailboxes/imap/getmailboxfolders",{mailbox_id:this.model.data.id}).subscribe(function(e){!0===e.result&&(t.mailboxes=e.mailboxes),s.next(e),s.complete()}),s.asObservable()},e.prototype.displayFoldersModal=function(){var t=this;this.getMailboxes().subscribe(function(e){t.modal.openModal("MailboxesIMAPSMTPSelectFoldersModal",!0,t.ViewContainerRef.injector).subscribe(function(e){e.instance.setModel(t.model),e.instance.setMailboxes(t.mailboxes)},function(e){t.toast.sendToast(e)})})},e.prototype.testConnection=function(){var t=this;this.modal.openModal("MailboxesmanagerTestIMAPModal",!0,this.ViewContainerRef.injector).subscribe(function(e){e.instance.isvalid.subsribe(function(e){t.validConnection=e})})},e=__decorate([core_1.Component({selector:"mailboxes-imap-smtp-traffic-manager",template:'<div class="slds-p-horizontal--medium slds-p-vertical--small"><h1>{{language.getLabel(\'LBL_USER\')}}</h1><div class="slds-grid"><div class="slds-form-element slds-size--1-of-1"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_DISPLAY_NAME\')}}</label> <input type="text" [(ngModel)]="model.data.settings.imap_pop3_display_name" class="slds-input ng-pristine ng-valid"></div></div><div class="slds-grid"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_USER_NAME\')}}</label> <input type="text" [(ngModel)]="model.data.settings.imap_pop3_username" class="slds-input ng-pristine ng-valid"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_PASSWORD\')}}</label> <input type="password" [(ngModel)]="model.data.settings.imap_pop3_password" class="slds-input ng-pristine ng-valid"></div></div></div><div *ngIf="isInbound" class="slds-p-horizontal--medium slds-p-vertical--small"><h1>{{language.getLabel(\'LBL_IMAP\')}}</h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_PROTOCOL_TYPE\')}}</label><select type="text" [(ngModel)]="model.data.settings.imap_pop3_protocol_type" class="slds-select ng-pristine ng-valid"><option value="imap">{{language.getLabel(\'LBL_IMAP\')}}</option><option value="pop3">{{language.getLabel(\'LBL_POP3\')}}</option></select></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_HOST\')}}</label> <input type="text" [(ngModel)]="model.data.settings.imap_pop3_host" class="slds-input ng-pristine ng-valid"></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_PORT\')}}</label> <input type="text" [(ngModel)]="model.data.settings.imap_pop3_port" class="slds-input ng-pristine ng-valid"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_ENCRYPTION\')}}</label><select type="text" [(ngModel)]="model.data.settings.imap_pop3_encryption" class="slds-select ng-pristine ng-valid"><option value="none">{{language.getLabel(\'LBL_NOENCRYPTION\')}}</option><option value="ssl">{{language.getLabel(\'LBL_SSL\')}}</option><option value="tls">{{language.getLabel(\'LBL_TLS\')}}</option></select></div></div></div><div *ngIf="isOutbound" class="slds-p-horizontal--medium slds-p-vertical--small"><h1>{{language.getLabel(\'LBL_SMTP\')}}</h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_HOST\')}}</label> <input type="text" [(ngModel)]="model.data.settings.smtp_host" class="slds-input ng-pristine ng-valid"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><div class="slds-form-element"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_AUTHENTICATION\')}}</label></div><div class="slds-form-element"><div class="slds-checkbox"><input type="checkbox" name="options" id="smtp_auth" [(ngModel)]="model.data.settings.smtp_auth"> <label class="slds-checkbox__label" for="smtp_auth"><span class="slds-checkbox_faux"></span></label></div></div></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_PORT\')}}</label> <input type="text" [(ngModel)]="model.data.settings.smtp_port" class="slds-input ng-pristine ng-valid"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_ENCRYPTION\')}}</label><select type="text" [(ngModel)]="model.data.settings.smtp_encryption" class="slds-select ng-pristine ng-valid"><option value="none">{{language.getLabel(\'LBL_NOENCRYPTION\')}}</option><option value="ssl">{{language.getLabel(\'LBL_SSL\')}}</option><option value="tls">{{language.getLabel(\'LBL_TLS\')}}</option></select></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label">{{language.getLabel(\'LBL_REPLY_TO\')}}</label> <input type="text" [(ngModel)]="model.data.settings.reply_to" class="slds-input ng-pristine ng-valid"></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-4"><div class="slds-form-element"><div class="slds-checkbox"><input type="checkbox" name="options" id="smtp_verify_peer" [(ngModel)]="model.data.settings.smtp_verify_peer"> <label class="slds-checkbox__label" for="smtp_verify_peer"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">{{language.getLabel(\'LBL_SMTP_VERIFY_PEER\')}}</span></label></div></div></div><div class="slds-form-element slds-size--1-of-4"><div class="slds-form-element"><div class="slds-checkbox"><input type="checkbox" name="options" id="smtp_verify_peer_name" [(ngModel)]="model.data.smtp_verify_peer_name"> <label class="slds-checkbox__label" for="smtp_verify_peer_name"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">{{language.getLabel(\'LBL_SMTP_VERIFY_PEER_NAME\')}}</span></label></div></div></div><div class="slds-form-element slds-size--1-of-4"><div class="slds-form-element"><div class="slds-checkbox"><input type="checkbox" name="options" id="allow_external_delete" [(ngModel)]="model.data.allow_external_delete"> <label class="slds-checkbox__label" for="allow_external_delete"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">{{language.getLabel(\'LBL_IMAP_SMTP_ALLOW_EXTERNAL_DELETE\')}}</span></label></div></div></div><div class="slds-form-element slds-size--1-of-4"><div class="slds-form-element"><div class="slds-checkbox"><input type="checkbox" name="options" id="smtp_allow_self_signed" [(ngModel)]="model.data.smtp_allow_self_signed"> <label class="slds-checkbox__label" for="smtp_allow_self_signed"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">{{language.getLabel(\'LBL_SMTP_ALLOW_SELF_SIGNED\')}}</span></label></div></div></div></div></div><div class="slds-grid slds-p-horizontal--medium slds-p-vertical--small"><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()" [disabled]="valid_connection">{{language.getLabel(\'LBL_TEST_CONNECTION\')}}</button> <button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="displayFoldersModal()">{{language.getLabel(\'LBL_IMAP_SELECT_FOLDERS\')}}</button></div>'}),__metadata("design:paramtypes",[services_6.backend,services_13.footer,services_4.language,services_1.metadata,services_2.model,services_3.modal,services_9.toast,services_7.view,core_1.ViewContainerRef])],e)}();exports.MailboxesImapSmtpTrafficManager=MailboxesImapSmtpTrafficManager;var LanguageLabelReferenceConfigForm=function(i){function LanguageLabelReferenceConfigForm(e,t,s,l){var o=i.call(this,s)||this;return o.utils=e,o.language=t,o.backend=s,o.toast=l,o}return __extends(LanguageLabelReferenceConfigForm,i),LanguageLabelReferenceConfigForm.prototype.submit=function(){var t=this;this.is_pulling=!0,this.backend.getRequest("/reference/load/languages/"+this.language_names,{version:this.version_names.toString()}).subscribe(function(e){t.pull_result=JSON.stringify(e),t.is_pulling=!1},function(e){console.error(e),t.pull_result=_.isObject(e)?e.error.message:e,t.is_pulling=!1,t.toast.sendToast("Error. Labels not retrieved.","error",e.error&&e.error.error&&e.error.error.message?"Message from REST api: "+e.error.error.message:null,!1)})},LanguageLabelReferenceConfigForm=__decorate([core_1.Component({selector:"language-label-reference-config-form",template:'<div class="slds-p-around--medium"><p><b>CAUTION!</b> Following processes will be triggered:</p><ol class="slds-list--ordered slds-p-bottom--large"><li class="slds-list__item"><strong>delete</strong> current records stored<br>in syslanguagelabels and syslanguagetranslations tables<br>Custom labels will remain intact.</li><li class="slds-list__item">load default language labels and translations into tables</li></ol><div class="slds-form-element"><label><abbr class="slds-required">*</abbr>{{language.getLabel(\'LBL_LANGUAGES\')}}:</label><div class="slds-form-element__control"><system-checkbox-group [(ngModel)]="language_names"><system-checkbox-group-checkbox *ngFor="let lang of available_languages" value="{{lang.language_code}}">{{lang.language_name}}</system-checkbox-group-checkbox></system-checkbox-group></div></div><div class="slds-form-element"><label>{{language.getLabel(\'LBL_VERSIONS\')}}:</label><div class="slds-form-element__control"><system-checkbox-group [(ngModel)]="version_names"><system-checkbox-group-checkbox *ngFor="let vers of available_versions" value="{{vers.version}}">{{vers.version}}</system-checkbox-group-checkbox></system-checkbox-group></div></div><div *ngIf="pull_result" class="slds-form-element"><label>{{language.getLabel(\'LBL_RESULT\')}}:</label><pre>{{pull_result}}</pre></div><div class="slds-form-element slds-p-top--small"><system-spinner *ngIf="is_pulling"></system-spinner><button *ngIf="!is_pulling" class="slds-button slds-button--brand" [disabled]="!language_names" (click)="submit()">{{language.getLabel(\'LBL_SUBMIT\')}}</button></div></div>'}),__metadata("design:paramtypes",[services_8.modelutilities,services_4.language,services_6.backend,services_9.toast])],LanguageLabelReferenceConfigForm)}(BasicReferenceForm);exports.LanguageLabelReferenceConfigForm=LanguageLabelReferenceConfigForm;var LanguageLabelReferenceConfigModal=function(){function LanguageLabelReferenceConfigModal(e){this.lang=e}return LanguageLabelReferenceConfigModal.prototype.closeDialog=function(){this.self.destroy()},LanguageLabelReferenceConfigModal.prototype.onModalEscX=function(){this.closeDialog()},LanguageLabelReferenceConfigModal=__decorate([core_1.Component({selector:"language-label-reference-config-modal",template:'<div role="dialog" class="slds-modal slds-fade-in-open slds-modal_large"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'" [inverse]="true"></system-button-icon></button><h2 class="slds-text-heading--medium">{{this.lang.getLabel(\'LBL_LANG_REFERENCE_CONFIG\')}}</h2></div><div class="slds-modal__content slds-theme--default slds-p-around--medium slds-p-bottom--xx-small"><language-label-reference-config-form (load)="closeDialog()"></language-label-reference-config-form></div></div></div>'}),__metadata("design:paramtypes",[services_4.language])],LanguageLabelReferenceConfigModal)}();exports.LanguageLabelReferenceConfigModal=LanguageLabelReferenceConfigModal;var ReferenceConfigManager=function(){function e(e,t,s,l,o){this.backend=e,this.metadata=t,this.language=s,this.utils=l,this.toast=o}return e=__decorate([core_1.Component({selector:"reference-config-manager",template:'<div class="slds-grid"><div class="slds-size--1-of-2 slds-p-around--small"><h2 class="slds-section-title">Configs</h2><reference-config-form></reference-config-form></div><div class="slds-size--1-of-2 slds-p-around--small"><h2 class="slds-section-title">Languages</h2><language-label-reference-config-form></language-label-reference-config-form></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_9.toast])],e)}();exports.ReferenceConfigManager=ReferenceConfigManager;var ReferenceConfigForm=function(o){function ReferenceConfigForm(e,t,s){var l=o.call(this,t)||this;return l.language=e,l.backend=t,l.toast=s,l}return __extends(ReferenceConfigForm,o),ReferenceConfigForm.prototype.test=function(){console.log(this.package_names,this.version_names)},Object.defineProperty(ReferenceConfigForm.prototype,"all_package_names",{get:function(){return this.available_packages.map(function(e){return e.package})},enumerable:!0,configurable:!0}),ReferenceConfigForm.prototype.submit=function(){var t=this;this.is_pulling=!0,this.backend.getRequest("configurator/load",{packages:this.package_names.toString(),versions:this.version_names.toString()}).subscribe(function(e){t.pull_result=JSON.stringify(e),t.is_pulling=!1,t.toast.sendToast("Configuration data successful retrieved.","success")},function(e){console.error(e),t.pull_result=_.isObject(e)?e.error.message:e,t.is_pulling=!1,t.toast.sendToast("Error. Configuration data not retrieved.","error",e.error&&e.error.error&&e.error.error.message?"Message from REST api: "+e.error.error.message:null,!1)})},ReferenceConfigForm=__decorate([core_1.Component({selector:"reference-config-form",template:'<div class="slds-p-around--small"><p><b>CAUTION!</b> Following processes will be triggered:</p><ol class="slds-list--ordered slds-p-bottom--large"><li class="slds-list__item"><strong>delete</strong> current UI settings stored in sysui tables</li><li class="slds-list__item">load default UI settings into sysui tables</li></ol><div class="slds-form-element"><label>{{language.getLabel(\'LBL_PACKAGES\')}}:</label><div class="slds-form-element__control"><system-checkbox-group [(ngModel)]="package_names"><system-checkbox-group-checkbox [value]="all_package_names">{{language.getLabel(\'LBL_SELECT_ALL\')}}</system-checkbox-group-checkbox><system-checkbox-group-checkbox *ngFor="let pack of available_packages" value="{{pack.package}}">{{pack.package}}</system-checkbox-group-checkbox></system-checkbox-group></div></div><div class="slds-form-element"><label>{{language.getLabel(\'LBL_VERSION\')}}:</label><div class="slds-form-element__control"><select class="slds-input slds-select" [(ngModel)]="version_names"><option *ngFor="let vers of available_versions" value="{{vers.version}}">{{vers.version}}</option></select></div></div><div *ngIf="pull_result" class="slds-form-element"><label>{{language.getLabel(\'LBL_RESULT\')}}:</label><pre>{{pull_result}}</pre></div><div class="slds-form-element slds-p-top--medium"><system-spinner *ngIf="is_pulling"></system-spinner><button *ngIf="!is_pulling" class="slds-button slds-button--brand" (click)="submit()">{{language.getLabel(\'LBL_SUBMIT\')}}</button> <button (click)="test()">test me!</button></div></div>'}),__metadata("design:paramtypes",[services_4.language,services_6.backend,services_9.toast])],ReferenceConfigForm)}(BasicReferenceForm);exports.ReferenceConfigForm=ReferenceConfigForm;var MailboxesProcessors=function(){function e(e,t,s,l,o){this.metadata=e,this.language=t,this.backend=s,this.model=l,this.view=o,this.processors=[],this.model.module="Mailboxes",this.view.isEditable=!0,this.view.setEditMode(),this.getProcessors()}return e.prototype.addProcessor=function(){this.model.data.mailbox_processors||(this.model.data.mailbox_processors=[]),this.model.data.mailbox_processors.push({id:this.model.generateGuid(),class:"",method:"",priority:"",stop_on_success:"",deleted:!1})},e.prototype.removeProcessor=function(t){this.model.data.mailbox_processors.forEach(function(e){e.id===t&&(e.deleted=!0)})},Object.defineProperty(e.prototype,"processorsvisible",{get:function(){return 0<this.model.data.mailbox_processors.length},enumerable:!0,configurable:!0}),e.prototype.getProcessorMethods=function(e){for(var t=0,s=this.processors;t<s.length;t++){var l=s[t];if(l.processor_class==e)return l.methods}return[]},e.prototype.getProcessors=function(){var t=this,s=new rxjs_1.Subject;return this.backend.getRequest("mailboxes/getmailboxprocessors").subscribe(function(e){!0===e.result&&(t.processors=e.processors),s.next(e),s.complete()}),s.asObservable()},e=__decorate([core_1.Component({selector:"mailboxes-processors",template:'<table *ngIf="processorsvisible" class="slds-table slds-table_bordered slds-table_cell-buffer"><thead><tr class="slds-text-title"><th scope="col"><div class="slds-truncate" title="Class">Class</div></th><th scope="col"><div class="slds-truncate" title="Method">Method</div></th><th scope="col"><div class="slds-truncate" title="Priority">Priority</div></th><th scope="col"><div class="slds-truncate" title="Stop on success">Stop on success</div></th></tr></thead><tbody><ng-container *ngFor="let mailbox_processor of model.data.mailbox_processors"><tr *ngIf="!mailbox_processor.deleted"><input type="hidden" [(ngModel)]="mailbox_processor.id"><td scope="row" data-label="Class"><select [disabled]="processors.length == 0" [(ngModel)]="mailbox_processor.processor_class" type="text" class="slds-select ng-pristine ng-valid"><option *ngFor="let processor of processors" value="{{ processor.processor_class }}">{{ processor.name }}</option></select></td><td scope="row" data-label="Method"><select [disabled]="!mailbox_processor.processor_class" [(ngModel)]="mailbox_processor.processor_method" type="text" class="slds-select ng-pristine ng-valid"><ng-container *ngIf="mailbox_processor.processor_class"><option *ngFor="let method of getProcessorMethods(mailbox_processor.processor_class)" value="{{ method }}">{{ method }}</option></ng-container></select></td><td scope="row" data-label="Priority"><input class="slds-input ng-pristine ng-valid ng-touched" [(ngModel)]="mailbox_processor.priority" title="Priority"></td><td scope="row" data-label="Stop on success"><input class="slds-input ng-pristine ng-valid ng-touched" [(ngModel)]="mailbox_processor.stop_on_success" title="Stop on success"></td><td scope="row"><button class="slds-button slds-button_destructive" (click)="removeProcessor(mailbox_processor.id)">X</button></td></tr></ng-container></tbody></table><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="addProcessor()">Add Processor</button>'}),__metadata("design:paramtypes",[services_1.metadata,services_4.language,services_6.backend,services_2.model,services_7.view])],e)}();exports.MailboxesProcessors=MailboxesProcessors;var SelectTreeComponent=function(){function SelectTreeComponent(e,t,s,l,o,i,a,n){this.appdata=e,this.backend=t,this.metadata=s,this.language=l,this.config=o,this.utils=i,this.toast=a,this.modalservice=n,this.currentSelectTree="",this.category_tree=[],this.levels=[],this.max_levels=4,this.loading=!0,this.selected_categorys=[],this.edit_category=null,this.service_queues=[],this.trees=[],this.loadTrees(!0)}return SelectTreeComponent.prototype.addTree=function(){var t=this;this.modalservice.openModal("SelectTreeAddDialog").subscribe(function(e){e.instance.tree$.subscribe(function(e){t.updateTree(e)})})},SelectTreeComponent.prototype.updateTree=function(e){this.loadTrees(),this.currentSelectTree=e.id,this.loadSelectTree(this.currentSelectTree)},SelectTreeComponent.prototype.loadTrees=function(t){var s=this;void 0===t&&(t=!1),this.config.getData("select_trees")||this.backend.getRequest("spiceui/core/selecttree/trees").subscribe(function(e){s.trees=e,t&&(0<s.trees.length?(s.currentSelectTree=s.trees[0].id,s.loadSelectTree(s.currentSelectTree)):s.loading=!1)})},SelectTreeComponent.prototype.loadSelectTree=function(e){var t=this;this.edit_category=null,this.backend.getRequest("spiceui/core/selecttree/tree/"+e).subscribe(function(e){t.config.setData("select_tree",e),t.initializeTree(e)})},SelectTreeComponent.prototype.initializeTree=function(e){this.category_tree=e;for(var t=0;t<this.max_levels;t++)this.levels[t]=[];this.levels[0]=this.category_tree,this.loading=!1},SelectTreeComponent.prototype.resetLevels=function(e){void 0===e&&(e=0);for(var t=e;t<this.max_levels;t++)this.levels[t]=[];this.selected_categorys.splice(e,this.max_levels-e)},SelectTreeComponent.prototype.select=function(e){(this.selected_categorys[e.level]=e).childs?(this.levels[e.level+1]=e.childs,this.resetLevels(e.level+2)):this.resetLevels(e.level+1)},SelectTreeComponent.prototype.addCategory=function(e){void 0===e&&(e=null);var t={id:this.utils.generateGuid(),name:"new Field...",keyname:null,parent_id:null,tree:this.currentSelectTree,selectable:0,favorite:0,level:0};e?(e.childs||(e.childs=[]),t.parent_id=e.id,t.level=e.level+1,t.level>this.max_levels&&(this.max_levels=t.level),e.childs.push(t),this.levels[e.level+1]=e.childs):(this.category_tree.push(t),this.levels[0]=this.category_tree),this.select(t),this.edit(t)},SelectTreeComponent.prototype.removeCategory=function(e){if(e.childs&&!confirm("Are you sure you want to delete this Category? There are "+e.childs.length+" Subcategories which will be get deleted too!"))return!1;e==this.edit_category&&(this.edit_category=null);for(var t=0,s=0,l=this.category_tree;s<l.length;s++){var o=l[s];if(o==e)return this.category_tree.splice(t,1),!0;i(o,e),t++}function i(e,t){if(e.childs)for(var s=0;s<e.childs.length;s++){if(e.childs[s]==t)return e.childs.splice(s,1),!0;i(e.childs[s],t)}return!1}},SelectTreeComponent.prototype.edit=function(e){this.selected_categorys[e.level]=e,this.edit_category=e},SelectTreeComponent.prototype.save=function(){var t=this;this.backend.postRequest("spiceui/core/selecttree/tree",null,this.category_tree).subscribe(function(e){t.toast.sendToast("changes saved")},function(e){t.toast.sendAlert("saving failed!"),console.error(e)})},SelectTreeComponent.prototype.isCategorySelected=function(e){for(var t=0,s=this.selected_categorys;t<s.length;t++){if(s[t].id==e.id)return!0}return!1},SelectTreeComponent=__decorate([core_1.Component({template:'<div class="slds-p-around--small slds-border--bottom"><div class="slds-grid slds-grid--vertical-align-center slds-form--inline"><div class="slds-form-element"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_TREE\')}}</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentSelectTree" (change)="loadSelectTree(currentSelectTree)" [disabled]="trees.length == 0"><option *ngFor="let tree of trees" [value]="tree.id">{{tree.name}}</option></select></div></div></div><div class="slds-form-element slds-col--bump-left"><button type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="addTree()"><system-utility-icon [icon]="\'add\'" [size]="\'x-small\'"></system-utility-icon></button></div></div></div><div class="slds-grid slds-grid--align-spread slds-p-around--medium"><h2 class="slds-text-heading--medium">Select Tree</h2><button class="slds-button slds-button--brand" (click)="save()">Save</button></div><article class="slds-card slds-m-around--small"><div class="slds-card__header"><header class="slds-has-flexi-truncate"><h2>Service Category Tree</h2></header></div><div class="slds-card__body slds-card__body_inner slds-grid"><div *ngIf="loading" class="slds-p-around--small slds-align--absolute-center"><system-spinner></system-spinner></div><div *ngFor="let lvl of levels; let i = index" class="slds-col slds-size--1-of-2" [ngStyle]="{width: 100/levels.length+\'%\'}" [ngClass]="{\'slds-border--right\': i < max_levels -1}"><div *ngFor="let cat of lvl" [ngClass]="{\'slds-theme--shade\': isCategorySelected(cat) || cat == edit_category, \'slds-theme_alert-texture\': cat == edit_category}"><div class="slds-grid slds-grid--vertical-align-center slds-p-around--xx-small" (mouseenter)="select(cat)"><span class="slds-truncate" style="cursor: pointer;" (click)="edit(cat)">{{cat.name}}</span><system-utility-icon class="slds-m-left--small" *ngIf="cat.favorite == 1" [icon]="\'favorite\'" [size]="\'xx-small\'"></system-utility-icon><div class="slds-col--bump-left"><system-utility-icon *ngIf="cat.level < max_levels-1" [icon]="\'add\'" [size]="\'xx-small\'" style="cursor:pointer;" (click)="addCategory(cat)"></system-utility-icon><system-utility-icon *ngIf="cat.childs" [icon]="\'chevronright\'" [size]="\'xx-small\'"></system-utility-icon></div></div></div><div *ngIf="i == 0" class="slds-p-around--xx-small"><system-utility-icon [icon]="\'add\'" [size]="\'xx-small\'" style="cursor:pointer;" (click)="addCategory()"></system-utility-icon></div></div></div></article><article *ngIf="edit_category" class="slds-card slds-m-around--small slds-size--1-of-4 slds-theme--shade slds-theme_alert-texture"><div class="slds-card__header slds-grid"><header class="slds-has-flexi-truncate"><h2>Edit Category</h2></header><system-utility-icon [icon]="\'close\'" [size]="\'xx-small\'" style="cursor: pointer;" (click)="removeCategory(edit_category)"></system-utility-icon></div><div class="slds-card__body slds-card__body_inner"><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Name:</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="edit_category.name"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Key:</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="edit_category.keyname"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><div class="slds-form-element slds-p-top--small"><div class="slds-form-element__control slds-grid"><span class="slds-checkbox"><input type="checkbox" name="options" id="checkbox-42" [(ngModel)]="edit_category.favorite"> <label class="slds-checkbox__label" for="checkbox-42"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">Favorite</span></label></span> <span class="slds-checkbox"><input type="checkbox" name="options" id="checkbox-49" [(ngModel)]="edit_category.selectable"> <label class="slds-checkbox__label" for="checkbox-49"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">Selectable</span></label></span></div></div></div></div></article>'}),__metadata("design:paramtypes",[services_10.AppDataService,services_6.backend,services_1.metadata,services_4.language,services_12.configurationService,services_8.modelutilities,services_9.toast,services_3.modal])],SelectTreeComponent)}();exports.SelectTreeComponent=SelectTreeComponent;var SelectTreeAddDialog=function(){function SelectTreeAddDialog(e,t,s,l,o){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.utils=o,this.tree=null,this.tree$=new core_1.EventEmitter,this.addType="fieldset",this.addName="",this.fieldsettype="custom"}return SelectTreeAddDialog.prototype.closeDialog=function(){this.self.destroy()},SelectTreeAddDialog.prototype.add=function(){var t=this;this.tree={id:this.utils.generateGuid(),name:this.addName},this.backend.postRequest("spiceui/core/selecttree/newtree",null,this.tree).subscribe(function(e){t.tree$.emit(t.tree),t.self.destroy()},function(e){console.error(e)})},__decorate([core_1.Input(),__metadata("design:type",Object)],SelectTreeAddDialog.prototype,"tree",void 0),__decorate([core_1.Output("tree"),__metadata("design:type",Object)],SelectTreeAddDialog.prototype,"tree$",void 0),SelectTreeAddDialog=__decorate([core_1.Component({selector:"selecttree-add-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium">{{language.getAppLanglabel(\'LBL_ADD_TREE\')}}</h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_TREE_NAME\')}}</label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="addName"></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()">{{language.getAppLanglabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" (click)="add()">{{language.getAppLanglabel(\'LBL_ADD\')}}</button></div></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_8.modelutilities])],SelectTreeAddDialog)}();exports.SelectTreeAddDialog=SelectTreeAddDialog;var ConfigCleaner=function(){function ConfigCleaner(e,t,s,l){this.backend=e,this.metadata=t,this.language=s,this.utils=l,this.results=[],this.is_loading=!1}return ConfigCleaner.prototype.diagnose=function(e){var t=this;this.is_loading=!0,this.backend.getRequest("/cleanup/configs/check/"+e).subscribe(function(e){console.log(e),t.results=e,t.is_loading=!1})},ConfigCleaner=__decorate([core_1.Component({selector:"language-label-manager",template:'<div class="slds-p-around--medium"><div class="slds-m-around--medium"><button class="slds-button slds-button--brand" (click)="diagnose(\'incomplete\')">{{language.getLabel(\'LBL_INCOMPLETE_RECORDS\')}}</button></div><div *ngIf="is_loading"><system-spinner></system-spinner></div><div *ngIf="results && results.total_checks > 0"><div class="slds-box slds-m-bottom--medium"><p>{{results.total_checks}} Checks are made and found {{results.total_records}} Records:</p></div><system-card *ngFor="let check of results.checks" class="slds-m-bottom--medium"><system-card-header-title>{{check.table}}</system-card-header-title><system-card-body><div *ngIf="!check.records" class="slds-inline_icon_text slds-grid"><system-utility-icon icon="check" size="x-small"></system-utility-icon><div class="slds-col slds-align-middle slds-text-color_success"><p>all fine!</p></div></div><div *ngIf="check.records && check.records.length > 0"><p>{{check.description}}</p><table class="slds-table slds-table--bordered"><thead><tr><th></th><th>ID</th><th>Name</th></tr></thead><tbody><tr *ngFor="let record of check.records"><td><system-checkbox [disabled]="true"></system-checkbox></td><td>{{record.id}}</td><td>{{record.name}}</td></tr></tbody></table></div></system-card-body></system-card></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities])],ConfigCleaner)}();exports.ConfigCleaner=ConfigCleaner;var GoogleCalendarManager=function(){function GoogleCalendarManager(e,t,s,l){this.backend=e,this.language=t,this.model=s,this.toast=l,this.beans=[],this.calendars=[],this.beanMappings=[],this.getBeans(),this.getCalendars(),this.getBeanMappings()}return GoogleCalendarManager.prototype.saveBeanMappings=function(){var t=this,e={bean_mappings:this.beanMappings};this.backend.postRequest("google/calendar/savebeanmappings",{},e).subscribe(function(e){t.toast.sendToast("Bean Mappings saved")})},GoogleCalendarManager.prototype.startSync=function(){var t=this;this.backend.getRequest("google/calendar/notifications/startSync").subscribe(function(e){1==e.result?t.toast.sendToast("Google Calendar synchronization started.","success"):t.toast.sendToast(e.error,"error")})},GoogleCalendarManager.prototype.addMapping=function(){this.beanMappings||(this.beanMappings=[]),this.beanMappings.push({id:this.model.generateGuid(),deleted:!1,bean:{module:"",class:""},calendar:{id:"",name:""}})},GoogleCalendarManager.prototype.removeMapping=function(t){console.log(t),this.beanMappings.forEach(function(e){e.id===t&&(e.deleted=!0)})},GoogleCalendarManager.prototype.getBeans=function(){var t=this,s=new rxjs_1.Subject;return this.backend.getRequest("google/calendar/getbeans").subscribe(function(e){!0===e.result&&(t.beans=e.beans),s.next(e),s.complete()},function(e){}),s.asObservable()},GoogleCalendarManager.prototype.getCalendars=function(){var t=this,s=new rxjs_1.Subject;return this.backend.getRequest("google/calendar/getcalendars").subscribe(function(e){!0===e.result&&(t.calendars=e.calendars),s.next(e),s.complete()},function(e){}),s.asObservable()},GoogleCalendarManager.prototype.getBeanMappings=function(){var e=this,s=new rxjs_1.Subject;return this.backend.getRequest("google/calendar/getbeanmappings").subscribe(function(t){!0===t.result&&(e.beanMappings=Object.keys(t.bean_mappings).map(function(e){return t.bean_mappings[e]})),s.next(t),s.complete()},function(e){}),s.asObservable()},GoogleCalendarManager=__decorate([core_1.Component({providers:[services_2.model,services_7.view],selector:"google-calendar-manager",template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element slds-col--bump-left"><div class="slds-button-group" role="group"><button type="button" class="slds-button slds-button--neutral" (click)="startSync()">{{language.getLabel(\'LBL_START_SYNC\')}}</button> <button type="button" class="slds-button slds-button--neutral" (click)="addMapping()">{{language.getLabel(\'LBL_ADD\')}}</button> <button type="button" class="slds-button slds-button--brand" (click)="saveBeanMappings()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div></div><table class="slds-table slds-table_bordered slds-table_cell-buffer"><thead><tr class="slds-text-title"><th scope="col"><div class="slds-truncate" title="Bean">Bean</div></th><th scope="col"><div class="slds-truncate" title="Calendar">Calendar</div></th></tr></thead><tbody><ng-container *ngFor="let beanMapping of beanMappings"><tr *ngIf="!beanMapping.deleted"><td scope="row" data-label="Class"><select [disabled]="beans.length == 0" [(ngModel)]="beanMapping.bean" type="text" class="slds-select ng-pristine ng-valid"><option *ngFor="let bean of beans" value="{{ bean.class }}">{{ bean.class }}</option></select></td><td scope="row" data-label="Method"><select [disabled]="calendars.length == 0" [(ngModel)]="beanMapping.calendar" type="text" class="slds-select ng-pristine ng-valid"><option *ngFor="let calendar of calendars" value="{{ calendar.id }}">{{ calendar.name }}</option></select></td><td scope="row"><button class="slds-button slds-button_destructive" (click)="removeMapping(beanMapping.id)">X</button></td></tr></ng-container></tbody></table>'}),__metadata("design:paramtypes",[services_6.backend,services_4.language,services_2.model,services_9.toast])],GoogleCalendarManager)}();exports.GoogleCalendarManager=GoogleCalendarManager;var ModuleConfigManager=function(){function ModuleConfigManager(e,t,s,l,o,i,a,n){var d=this;this.backend=e,this.metadata=t,this.language=s,this.toast=l,this.modalservice=o,this.configurationService=i,this.view=a,this.modal=n,this.component="",this.configValues={},this.crActive=!1,this.change_request_required=!1,this.edit_mode="",this.allowCopyButton=!0,this.allowGlobalModal=!1,this.sysModules=[],this.sysRoles={},this.currentModule="",this.currentComponent="",this.selectedId="",this.selectedComponent={},this.newComponent={},this.componentTree=[],this.currentTableActive="",this.componentModuleList=[],this.treelist=[],this.initialized=!1,this.backend.getRequest("configurator/entries/sysuiroles").subscribe(function(e){d.sysRoles["*"]="*";for(var t=0,s=e;t<s.length;t++){var l=s[t];d.sysRoles[l.id]=l.name}}),this.backend.getRequest("spiceui/admin/modules").subscribe(function(e){d.sysModules=e,d.metadata.loadFieldSets(new rxjs_1.Subject);var t=new rxjs_1.Subject;d.metadata.loadComponents(t,!0),t.subscribe(function(e){d.initialized=!0,d.currentModule="*",d.selectedModule()})}),this.checkMode()}return Object.defineProperty(ModuleConfigManager.prototype,"getAllowCopyButton",{get:function(){return(0!==Object.keys(this.selectedComponent).length||this.selectedComponent.constructor!==Object)&&this.allowCopyButton},enumerable:!0,configurable:!0}),ModuleConfigManager.prototype.checkMode=function(){var t=this;this.edit_mode=this.configurationService.getCapabilityConfig("core").edit_mode,this.change_request_required=!!this.configurationService.getCapabilityConfig("systemdeployment").change_request_required,"none"!=this.edit_mode&&"custom"!=this.edit_mode&&"all"!=this.edit_mode&&(this.edit_mode="custom"),this.change_request_required?this.backend.getRequest("systemdeploymentcrs/active").subscribe(function(e){""==e.id?(t.setNoneMode(),t.toast.sendToast(t.language.getLabel("LBL_ACTIVATE_CR_WARNING"),"warning",null,3)):"all"==t.edit_mode?t.setAllMode():"custom"==t.edit_mode?t.setCustomMode():t.setNoneMode()}):"all"==this.edit_mode?this.setAllMode():"custom"==this.edit_mode?this.setCustomMode():this.setNoneMode()},ModuleConfigManager.prototype.setNoneMode=function(){this.view.setViewMode(),this.allowCopyButton=!1},ModuleConfigManager.prototype.setCustomMode=function(){"custom"==this.currentTableActive||"default_custom"==this.currentTableActive?this.view.setEditMode():this.view.setViewMode()},ModuleConfigManager.prototype.setAllMode=function(){this.allowGlobalModal=!0,this.view.setEditMode()},ModuleConfigManager.prototype.selectedModule=function(){this.currentComponent="",this.componentTree=[],this.selectedComponent={},"*"==this.currentModule?"default_custom"==this.currentTableActive?this.loadDefaultCustom():this.loadDefault():"custom"==this.currentTableActive?this.loadCustom():this.loadGlobal()},ModuleConfigManager.prototype.loadGlobal=function(){var s=this;this.modal.openModal("SystemLoadingModal").subscribe(function(t){s.selectedComponent={},s.currentTableActive="global",s.checkMode(),"*"!=s.currentModule?s.backend.getRequest("configurator/entries/sysuicomponentmoduleconf").subscribe(function(e){s.buildTreeList(e),t.instance.self.destroy()}):(s.loadDefault(),t.instance.self.destroy())})},ModuleConfigManager.prototype.loadCustom=function(){var s=this;this.modal.openModal("SystemLoadingModal").subscribe(function(t){s.selectedComponent={},s.currentTableActive="custom",s.checkMode(),"*"!=s.currentModule?s.backend.getRequest("configurator/entries/sysuicustomcomponentmoduleconf").subscribe(function(e){s.buildTreeList(e),t.instance.self.destroy()}):(s.loadDefaultCustom(),t.instance.self.destroy())})},ModuleConfigManager.prototype.loadDefault=function(){var s=this;this.modal.openModal("SystemLoadingModal").subscribe(function(t){s.currentTableActive="default",s.backend.getRequest("configurator/entries/sysuicomponentdefaultconf").subscribe(function(e){s.buildTreeList(e),t.instance.self.destroy()})})},ModuleConfigManager.prototype.loadDefaultCustom=function(){var s=this;this.modal.openModal("SystemLoadingModal").subscribe(function(t){s.currentTableActive="default_custom",s.backend.getRequest("configurator/entries/sysuicustomcomponentdefaultconf").subscribe(function(e){s.buildTreeList(e),t.instance.self.destroy()})})},ModuleConfigManager.prototype.buildTreeList=function(e){for(var t=[],s=0,l=e;s<l.length;s++){var o=l[s];if(o.module==this.currentModule||"*"==this.currentModule){this.componentModuleList.push(o);var i=this.checkRoleName(o.role_id),a={};a={id:o.id,parent_id:o.component,clickable:!0,name:i},this.newComponent&&this.newComponent.id==o.id&&(a.selected=!0,this.selectedOutputItem(a.id)),t.push(a);for(var n=0,d=0,r=t;d<r.length;d++){var c=r[d];o.component==c.id&&(n=1)}0==n&&t.push({id:o.component,parent_id:null,clickable:!1,name:o.component})}}return this.newComponent={},t.sort(function(e,t){return e.name>t.name?1:-1}),this.treelist=t},ModuleConfigManager.prototype.checkRoleName=function(e){return this.sysRoles[e]?this.sysRoles[e]:e},ModuleConfigManager.prototype.selectedOutputItem=function(e){for(var t=0,s=this.componentModuleList;t<s.length;t++){var l=s[t];if(l.id==e){"string"==typeof l.componentconfig&&(l.componentconfig=JSON.parse(l.componentconfig));this.checkRoleName(l.role_id);this.selectedComponent=l,this.component=l.component,this.configValues=l.componentconfig}}},ModuleConfigManager.prototype.saveChanges=function(){var s=this;this.modal.openModal("SystemLoadingModal").subscribe(function(t){if(s.selectedComponent.componentconfig){switch(s.selectedComponent.componentconfig=JSON.stringify(s.selectedComponent.componentconfig),delete s.selectedComponent.role_name,s.currentTableActive){case"default":s.backend.postRequest("configurator/sysuicomponentdefaultconf/"+s.selectedComponent.id,{},s.selectedComponent).subscribe(function(e){"success"==e.status&&(t.instance.self.destroy(),s.toast.sendToast("changes saved"))});break;case"default_custom":s.backend.postRequest("configurator/sysuicustomcomponentdefaultconf/"+s.selectedComponent.id,{},s.selectedComponent).subscribe(function(e){"success"==e.status&&(t.instance.self.destroy(),s.toast.sendToast("changes saved"))});break;case"global":s.backend.postRequest("configurator/sysuicomponentmoduleconf/"+s.selectedComponent.id,{},s.selectedComponent).subscribe(function(e){"success"==e.status&&(t.instance.self.destroy(),s.toast.sendToast("changes saved"))});break;case"custom":s.backend.postRequest("configurator/sysuicustomcomponentmoduleconf/"+s.selectedComponent.id,{},s.selectedComponent).subscribe(function(e){"success"==e.status&&(t.instance.self.destroy(),s.toast.sendToast("changes saved"))});break;default:t.instance.self.destroy()}s.selectedComponent.componentconfig=JSON.parse(s.selectedComponent.componentconfig)}})},ModuleConfigManager.prototype.addConf=function(){var t=this;this.modalservice.openModal("ModuleConfigAddDialog").subscribe(function(e){e.instance.mode="add","default_custom"==t.currentTableActive||"custom"==t.currentTableActive?e.instance.currentType="custom":"all"==t.edit_mode?e.instance.currentType="global":e.instance.currentType="custom",e.instance.currentModule=t.currentModule,e.instance.allowGlobal=t.allowGlobalModal,e.instance.response$.subscribe(function(e){t.response(e)})})},ModuleConfigManager.prototype.copyConf=function(){var t=this;this.modalservice.openModal("ModuleConfigAddDialog").subscribe(function(e){e.instance.mode="copy",e.instance.currentComponent=t.selectedComponent,e.instance.currentRole=t.selectedComponent.role_id,e.instance.currentModule=t.currentModule,e.instance.allowGlobal=t.allowGlobalModal,e.instance.response$.subscribe(function(e){t.response(e)})})},ModuleConfigManager.prototype.response=function(e){e.module?this.currentModule=e.module:this.currentModule="*","sysuicomponentdefaultconf"==e.table||"sysuicomponentmoduleconf"==e.table?this.currentTableActive="global":this.currentTableActive="custom","sysuicustomcomponentdefaultconf"==e.table&&(this.currentTableActive="default_custom"),"sysuicustomcomponentmoduleconf"==e.table&&(this.currentTableActive="custom"),"sysuicomponentdefaultconf"==e.table&&(this.currentTableActive="default"),"sysuicomponentmoduleconf"==e.table&&(this.currentTableActive="global"),this.newComponent=e,this.selectedModule()},Object.defineProperty(ModuleConfigManager.prototype,"treecontainerstyle",{get:function(){return{height:"calc(100vh - "+this.treecontainer.element.nativeElement.offsetTop+"px - "+this.addconfigcontainer.element.nativeElement.getBoundingClientRect().height+"px)"}},enumerable:!0,configurable:!0}),__decorate([core_1.ViewChild("treecontainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],ModuleConfigManager.prototype,"treecontainer",void 0),__decorate([core_1.ViewChild("addconfigcontainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],ModuleConfigManager.prototype,"addconfigcontainer",void 0),ModuleConfigManager=__decorate([core_1.Component({template:'<div class="slds-p-around--medium slds-theme--shade"><div class="slds-page-header__row"><div class="slds-page-header__col-title"><div class="slds-media"><system-icon icon="custom19" sprite="custom"></system-icon><div class="slds-media__body"><div class="slds-page-header__name"><div class="slds-page-header__name-title"><h1><span class="slds-page-header__title slds-truncate">{{language.getLabel(\'LBL_CONFIGURATION_MANAGER\')}}</span></h1></div></div><div class="slds-page-header__name-meta slds-grid"></div></div></div></div></div></div><div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><label class="slds-form-element__label">{{language.getLabel(\'LBL_MODULE\')}}</label><div class="slds-form-element__control"><div class="slds-select_container" style="min-width:250px;"><select class="slds-select" [(ngModel)]="currentModule" [disabled]="!initialized" (change)="selectedModule()"><option value="*">*</option><option *ngFor="let sysModule of sysModules" [value]="sysModule.module">{{sysModule.module}}</option></select></div></div></div></div><div *ngIf="!initialized" class="slds-align_absolute-center slds-p-around--large"><system-spinner></system-spinner></div><div class="slds-grid" [ngClass]="{\'slds-hidden\':!initialized}"><div class="slds-size--2-of-5 slds-border--right"><div class="slds-tree_container" role="application" style="max-width: none;"><div class="slds-tabs_default" style="background-color: transparent"><ul class="slds-tabs_default__nav" role="tablist"><li class="slds-tabs_default__item slds-is-active" [ngClass]="{\'slds-is-active\': currentTableActive == \'global\' || currentTableActive == \'default\'}" title="Item One" role="presentation"><div class="slds-grid slds-grid--vertical-align-center"><system-custom-icon icon="global" size="x-small"></system-custom-icon><a class="slds-tabs_default__link" href="javascript:void(0);" role="tab" tabindex="0" (click)="loadGlobal()" id="tab-default-1__item">{{language.getLabel(\'LBL_GLOBAL\')}}</a></div></li><li class="slds-tabs_default__item" [ngClass]="{\'slds-is-active\': currentTableActive == \'custom\' || currentTableActive == \'default_custom\'}" title="Item Two" role="presentation"><div class="slds-grid slds-grid--vertical-align-center"><system-custom-icon icon="custom" size="x-small"></system-custom-icon><a class="slds-tabs_default__link" href="javascript:void(0);" role="tab" tabindex="-1" aria-selected="false" aria-controls="tab-default-2" (click)="loadCustom()" id="tab-default-2__item">{{language.getLabel(\'LBL_CUSTOM\')}}</a></div></li></ul><div #treecontainer class="slds-tabs_default__content slds-p-vertical_none" role="tabpanel"><div class="slds-scrollable_y slds-border_bottom" [ngStyle]="treecontainerstyle"><system-tree [treelist]="treelist" [selectedItem]="selectedComponent.id" (selectedItem$)="selectedOutputItem($event)"></system-tree></div><div #addconfigcontainer class="slds-p-around--small slds-align--absolute-center"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="add item" (click)="addConf()"><system-utility-icon [icon]="\'new\'" [size]="\'xx-small\'" [addclasses]="\'slds-section__title-action-icon slds-button__icon slds-button__icon_left\'"></system-utility-icon></button></div></div></div></div></div><div class="slds-size--3-of-5 slds-p-horizontal--small slds-p-top--x-small"><div class="slds-grid slds-grid--vertical-align-center"><div *ngIf="selectedComponent.component" class="slds-text-heading_small">{{selectedComponent.component}} / {{selectedComponent.role_name}}</div><div class="slds-col--bump-left"><button [disabled]="!getAllowCopyButton" type="button" class="slds-m-bottom_small slds-col--bump-left slds-button slds-button--neutral" (click)="copyConf()">{{language.getLabel(\'LBL_COPY\')}}</button> <button [disabled]="!view.isEditMode()" type="button" class="slds-m-bottom_small slds-col--bump-left slds-button slds-button--brand" (click)="saveChanges()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div><workbench-config [component]="component" [configValues]="configValues"></workbench-config></div></div>',providers:[services_7.view]}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_9.toast,services_3.modal,services_12.configurationService,services_7.view,services_3.modal])],ModuleConfigManager)}();exports.ModuleConfigManager=ModuleConfigManager;var WorkbenchConfig=function(){function WorkbenchConfig(e,t,s){this.backend=e,this.metadata=t,this.language=s,this.component="",this.configValues={},this.configOptions=[],this.optionsElements=[]}return WorkbenchConfig.prototype.ngOnChanges=function(e){for(var o=this,t=0,s=this.optionsElements;t<s.length;t++){(i=s[t]).destroy()}this.optionsElements=[],this.configOptions=[];var l=this.metadata.getComponentConfigOptions(this.component);for(var i in l)this.configOptions.push({option:i,type:l[i].type?l[i].type:"string",description:l[i].description?l[i].description:""});for(var a=function(s){var l="",e=s.type.charAt(0).toUpperCase()+s.type.slice(1);l="WorkbenchConfigOption"+e,n.metadata.checkComponent(l)||(l="label"==s.type?"LabelSelectorComponent":"WorkbenchConfigOptionDefault"),n.metadata.addComponent(l,n.optionscontainer).subscribe(function(e){if(o.optionsElements.push(e),e.instance.option=s,e.instance.configValues=o.configValues,"LabelSelectorComponent"==l){var t;(t=o.configValues[s.option])&&o.language.languagedata.applang[t]&&(e.instance._selected_item={name:t}),e.instance.select$.subscribe(function(e){o.configValues[s.option]=e?e.name:null})}})},n=this,d=0,r=this.configOptions;d<r.length;d++){a(r[d])}},__decorate([core_1.ViewChild("optionscontainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],WorkbenchConfig.prototype,"optionscontainer",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],WorkbenchConfig.prototype,"component",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],WorkbenchConfig.prototype,"configValues",void 0),WorkbenchConfig=__decorate([core_1.Component({template:"<div #optionscontainer></div>",selector:"workbench-config"}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language])],WorkbenchConfig)}();exports.WorkbenchConfig=WorkbenchConfig;var ModuleConfigAddDialog=function(){function ModuleConfigAddDialog(e,t,s,l,o,i){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.utils=o,this.toast=i,this.mode="",this.currentRole="",this.currentType="",this.currentModule="",this.allowGlobal=!1,this.response$=new core_1.EventEmitter,this.sysModules=[],this.components=[],this.addType="fieldset",this.addName="",this.fieldsettype="custom",this.types=[{value:"custom",text:"LBL_CUSTOM"},{value:"global",text:"LBL_GLOBAL"}],this.compSelectList=[],this.compDisabled=!1,this.moduleSelectList=[],this.roleSelectList=[]}return ModuleConfigAddDialog.prototype.ngOnInit=function(){var o=this;this.allowGlobal||(this.types.pop(),this.currentType="custom"),this.backend.getRequest("configurator/entries/sysmodules").subscribe(function(e){o.moduleSelectList.push({id:"*",name:"*"}),"add"==o.mode&&"*"==o.currentModule&&(o.moduleSelectedItem={id:"*",name:"*"});for(var t=0,s=e;t<s.length;t++){var l=s[t];o.moduleSelectList.push({id:l.id,name:l.module,group:"global"}),"add"==o.mode&&l.module==o.currentModule&&(o.moduleSelectedItem={id:l.id,name:l.module,group:"global"})}o.sortArray(o.moduleSelectList),o.moduleSelectList=Object.assign([],o.moduleSelectList)}),this.backend.getRequest("configurator/entries/syscustommodules").subscribe(function(e){for(var t=0,s=e;t<s.length;t++){var l=s[t];o.moduleSelectList.push({id:l.id,name:l.module,group:"custom"}),"add"==o.mode&&l.module==o.currentModule&&(o.moduleSelectedItem={id:l.id,name:l.module,group:"custom"})}o.sortArray(o.moduleSelectList),o.moduleSelectList=Object.assign([],o.moduleSelectList)}),this.backend.getRequest("configurator/entries/sysuiroles").subscribe(function(e){o.roleSelectList.push({id:"*",name:"*"});for(var t=0,s=e;t<s.length;t++){var l=s[t];o.roleSelectList.push({id:l.id,name:l.name,group:"global"}),"copy"==o.mode&&l.id==o.currentRole&&(o.roleSelectedItem={id:l.id,name:l.name,group:"global"}),"*"==o.currentRole&&(o.roleSelectedItem={id:"*",name:"*"})}o.sortArray(o.roleSelectList),o.roleSelectList=Object.assign([],o.roleSelectList)}),this.backend.getRequest("configurator/entries/sysuicustomroles").subscribe(function(e){for(var t=0,s=e;t<s.length;t++){var l=s[t];o.roleSelectList.push({id:l.id,name:l.name,group:"custom"}),"copy"==o.mode&&l.id==o.currentRole&&(o.roleSelectedItem={id:l.id,name:l.name,group:"custom"}),"*"==o.currentRole&&(o.roleSelectedItem={id:"*",name:"*"})}o.sortArray(o.roleSelectList),o.roleSelectList=Object.assign([],o.roleSelectList)}),this.backend.getRequest("configurator/entries/sysuiobjectrepository").subscribe(function(e){for(var t=0,s=e;t<s.length;t++){var l=s[t];o.compSelectList.push({id:l.id,name:l.object,group:"global"}),"copy"==o.mode&&(o.compDisabled=!0,o.compSelectedItem={id:o.currentComponent.id,name:o.currentComponent.component})}o.sortArray(o.compSelectList),o.compSelectList=Object.assign([],o.compSelectList)}),this.backend.getRequest("configurator/entries/sysuicustomobjectrepository").subscribe(function(e){for(var t=0,s=e;t<s.length;t++){var l=s[t];o.compSelectList.push({id:l.id,name:l.object,group:"custom"}),"copy"==o.mode&&(o.compDisabled=!0,o.compSelectedItem={id:o.currentComponent.id,name:o.currentComponent.component})}o.sortArray(o.compSelectList),o.compSelectList=Object.assign([],o.compSelectList)})},ModuleConfigAddDialog.prototype.validate=function(){if("*"==this.currentModule){if(this.compSelectedItem&&this.roleSelectedItem&&this.currentType)return!1}else if(this.compSelectedItem&&this.moduleSelectedItem&&this.roleSelectedItem&&this.currentType)return!1;return!0},ModuleConfigAddDialog.prototype.sortArray=function(e){return e.sort(function(e,t){var s=e.name.toLowerCase(),l=t.name.toLowerCase();return s<l?-1:l<s?1:0}),e},ModuleConfigAddDialog.prototype.closeDialog=function(){this.self.destroy()},ModuleConfigAddDialog.prototype.save=function(){var e=this.currentType,t="",s={},l=this.modelutilities.generateGuid();if(this.currentComponent){var o=JSON.stringify(this.currentComponent.componentconfig);s={component:this.currentComponent.component,componentconfig:o}}else s={component:this.compSelectedItem.name,componentconfig:"{}"};s.id=l,s.role_id=this.roleSelectedItem.id,"*"!=s.module&&(s.module=this.moduleSelectedItem.name),"custom"==e&&"*"==s.module&&(t="sysuicustomcomponentdefaultconf"),"custom"==e&&"*"!=s.module&&(t="sysuicustomcomponentmoduleconf"),"global"==e&&"*"==s.module&&(t="sysuicomponentdefaultconf"),"global"==e&&"*"!=s.module&&(t="sysuicomponentmoduleconf"),this.saveComponent(s,t)},ModuleConfigAddDialog.prototype.saveComponent=function(t,s){var l=this;t.type=this.currentType;var e="";"*"==t.module?(e="componentdefaultalreadyexists",delete t.module):e="componentmodulealreadyexists",this.backend.getRequest("spiceui/core/"+e,t).subscribe(function(e){delete t.type,0==e?l.backend.postRequest("configurator/"+s+"/"+t.id,null,t).subscribe(function(e){l.toast.sendToast("saved"),t.table=s,l.response$.emit(t),l.self.destroy()},function(e){l.toast.sendAlert("saving failed!"),console.error(e)}):l.toast.sendAlert("Configuration already exists!")},function(e){l.toast.sendAlert("Saving configuration failed!"),console.error(e)})},ModuleConfigAddDialog.prototype.selectedOutputItemComp=function(e){this.compSelectedItem=e},ModuleConfigAddDialog.prototype.selectedOutputItemModule=function(e){this.moduleSelectedItem=e},ModuleConfigAddDialog.prototype.selectedOutputItemRole=function(e){this.roleSelectedItem=e},__decorate([core_1.Input(),__metadata("design:type",String)],ModuleConfigAddDialog.prototype,"mode",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ModuleConfigAddDialog.prototype,"currentComponent",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ModuleConfigAddDialog.prototype,"currentRole",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ModuleConfigAddDialog.prototype,"currentType",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ModuleConfigAddDialog.prototype,"currentModule",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],ModuleConfigAddDialog.prototype,"allowGlobal",void 0),__decorate([core_1.Output("response"),__metadata("design:type",core_1.EventEmitter)],ModuleConfigAddDialog.prototype,"response$",void 0),ModuleConfigAddDialog=__decorate([core_1.Component({selector:"moduleconfig-add-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open slds-modal_medium"><div class="slds-modal__container"><div class="slds-modal__header"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" *ngIf="this.mode == \'copy\'" class="slds-text-heading--medium">{{language.getAppLanglabel(\'LBL_COPY_COMPONENT\')}}</h2><h2 id="header44" *ngIf="this.mode == \'add\'" class="slds-text-heading--medium">{{language.getAppLanglabel(\'LBL_ADD_COMPONENT\')}}</h2></div><div class="slds-modal__content slds-p-around--medium" style="height: 355px;"><div class="slds-form-element"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_SCOPE\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentType"><option *ngFor="let type of types" [value]="type.value">{{language.getAppLanglabel(type.text)}}</option></select></div></div></div><system-select [selectList]="moduleSelectList" [selectedItem]="moduleSelectedItem" [label]="\'LBL_MODULES\'" (selectedOutputItem)="selectedOutputItemModule($event)"></system-select><system-select [selectList]="compSelectList" [disabled]="compDisabled" [selectedItem]="compSelectedItem" [label]="\'LBL_COMPONENT\'" (selectedOutputItem)="selectedOutputItemComp($event)"></system-select><system-select [selectList]="roleSelectList" [selectedItem]="roleSelectedItem" [label]="\'LBL_ROLES\'" (selectedOutputItem)="selectedOutputItemRole($event)"></system-select><div *ngIf="this.mode == \'copy\'" class="slds-text-align_center slds-p-vertical_small slds-text-heading_small">{{language.getLabel(\'LBL_NOTE_COPY_CONFIG_INFO\')}}</div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()">{{language.getAppLanglabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" (click)="save()" [disabled]="validate()"><span *ngIf="this.mode == \'add\'">{{language.getAppLanglabel(\'LBL_ADD\')}}</span> <span *ngIf="this.mode == \'copy\'">{{language.getAppLanglabel(\'LBL_COPY\')}}</span></button></div></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_8.modelutilities,services_9.toast])],ModuleConfigAddDialog)}();exports.ModuleConfigAddDialog=ModuleConfigAddDialog;var FieldsetManagerCopyDialog=function(){function FieldsetManagerCopyDialog(e){this.language=e,this.metaFieldSets=[],this.fieldset="",this.sysModules=[],this.edit_mode="",this.closedialog=new core_1.EventEmitter,this.currentName="",this.currentType="",this.currentModule=""}return FieldsetManagerCopyDialog.prototype.ngOnInit=function(){this.fieldset&&(this.currentName=this.metaFieldSets[this.fieldset].name,this.currentModule=this.metaFieldSets[this.fieldset].module,"global"==this.edit_mode?this.currentType=this.metaFieldSets[this.fieldset].type:this.currentType="custom")},FieldsetManagerCopyDialog.prototype.closeDialog=function(){this.self.destroy()},FieldsetManagerCopyDialog.prototype.onModalEscX=function(){this.closeDialog()},FieldsetManagerCopyDialog.prototype.copy=function(){this.closedialog.emit({fieldset:this.metaFieldSets[this.fieldset],type:this.currentType,module:this.currentModule,name:this.currentName}),this.self.destroy()},FieldsetManagerCopyDialog.prototype.validate=function(){return!(this.fieldset&&this.currentModule&&this.currentType)},__decorate([core_1.Input(),__metadata("design:type",Array)],FieldsetManagerCopyDialog.prototype,"metaFieldSets",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerCopyDialog.prototype,"fieldset",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],FieldsetManagerCopyDialog.prototype,"sysModules",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerCopyDialog.prototype,"edit_mode",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],FieldsetManagerCopyDialog.prototype,"closedialog",void 0),FieldsetManagerCopyDialog=__decorate([core_1.Component({selector:"fieldsetmanager-copy-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium">{{language.getAppLanglabel(\'LBL_COPY\')}}</h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_MODULE\')}}</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentModule" [disabled]="sysModules.length == 0"><option value="*">*</option><option *ngFor="let sysModule of sysModules" [value]="sysModule.module">{{sysModule.module}}</option></select></div></div></div><div class="slds-form-element"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_SCOPE\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentType"><option value="custom">{{language.getAppLanglabel(\'LBL_CUSTOM\')}}</option><option *ngIf="edit_mode == \'all\'" value="global">{{language.getAppLanglabel(\'LBL_GLOBAL\')}}</option></select></div></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_FIELDSET\')}}</label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="currentName"></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()">{{language.getLabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" [disabled]="validate()" (click)="copy()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div></div>'}),__metadata("design:paramtypes",[services_4.language])],FieldsetManagerCopyDialog)}();exports.FieldsetManagerCopyDialog=FieldsetManagerCopyDialog;var ComponentsetManagerModulePipeGlobal=function(){function e(){}return e.prototype.transform=function(e,t){for(var s=[],l=0,o=e;l<o.length;l++){var i=o[l];i.module==t&&"global"==i.type&&s.push(i)}return s},e=__decorate([core_1.Pipe({name:"componentsetmanagermodulepipeglobal"})],e)}();exports.ComponentsetManagerModulePipeGlobal=ComponentsetManagerModulePipeGlobal;var ComponentsetManagerModulePipeCustom=function(){function e(){}return e.prototype.transform=function(e,t){for(var s=[],l=0,o=e;l<o.length;l++){var i=o[l];i.module==t&&"custom"==i.type&&s.push(i)}return s},e=__decorate([core_1.Pipe({name:"componentsetmanagermodulepipecustom"})],e)}();exports.ComponentsetManagerModulePipeCustom=ComponentsetManagerModulePipeCustom;var WorkbenchConfigOptionFieldset=function(){function WorkbenchConfigOptionFieldset(e,t,s,l,o,i,a,n){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.broadcast=o,this.toast=i,this.cdRef=a,this.view=n,this.configValues=[],this.option={},this.objtype="",this.fieldsets=[],this.modules=[],this.module="",this.showInfo=!1}return WorkbenchConfigOptionFieldset.prototype.ngAfterViewInit=function(){this.fieldsets=this.metadata.getFieldSets(),this.modules=this.metadata.getModules(),this.modules.sort(),this.configValues[this.option.option]&&(this.module=this.metadata.getFieldset(this.configValues[this.option.option]).module),this.cdRef.detectChanges()},WorkbenchConfigOptionFieldset.prototype.getFieldSets=function(e){return void 0===e&&(e=void 0),this.metadata.getFieldSets()},WorkbenchConfigOptionFieldset=__decorate([core_1.Component({selector:"workbench-config-option-fieldset",template:'<div class="slds-form-element slds-m-vertical--xxx-small" style="clear: both"><label class="slds-form-element__label slds-float_left" style="margin-right: 3px;">{{option.option}}</label><div *ngIf="option.description.length > 0" class="slds-float_left" style="position: relative; margin-right: 5px; margin-top: 3px;"><div class="slds-form-element"><div class="slds-form-element__icon slds-align-middle"><button class="slds-button slds-button_icon slds-button slds-button_icon" aria-describedby="help" title="Description" (mouseenter)="showInfo = true" (mouseleave)="showInfo = false"><system-button-icon [size]="\'small\'" [icon]="\'info\'"></system-button-icon></button></div></div><div *ngIf="showInfo" class="slds-popover slds-popover_tooltip slds-nubbin_bottom-right slds-rise-from-ground" role="tooltip" id="help" style="position: absolute; bottom: 25px; right: -17px; width: 320px; height: auto;"><div class="slds-popover__body slds-scrollable_y">{{option.description}}</div></div></div><div class="slds-grid" style="clear: both;"><div class="slds-form-element__control slds-p-right--xxx-small slds-size--1-of-3"><div class="slds-select_container"><select [disabled]="!view.isEditMode()" class="slds-select" [(ngModel)]="module"><option value="*">*</option><option *ngFor="let module of modules" [value]="module">{{module}}</option></select></div></div><div class="slds-form-element__control slds-p-left--xxx-small slds-size--2-of-3"><div class="slds-select_container"><select [disabled]="!module || !view.isEditMode()" class="slds-select" [(ngModel)]="configValues[option.option]"><option></option><optgroup label="custom {{language.getAppLanglabel(\'LBL_FIELDSET\')}}" *ngIf="fieldsets|componentsetmanagermodulepipecustom:module.length > 0"><option *ngFor="let sysFieldset of fieldsets|componentsetmanagermodulepipecustom:module" [value]="sysFieldset.id">{{sysFieldset.name}}</option></optgroup><optgroup label="global {{language.getAppLanglabel(\'LBL_FIELDSET\')}}" *ngIf="fieldsets|componentsetmanagermodulepipeglobal:module.length > 0"><option *ngFor="let sysFieldset of fieldsets|componentsetmanagermodulepipeglobal:module" [value]="sysFieldset.id">{{sysFieldset.name}}</option></optgroup></select></div></div></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_5.broadcast,services_9.toast,core_1.ChangeDetectorRef,services_7.view])],WorkbenchConfigOptionFieldset)}();exports.WorkbenchConfigOptionFieldset=WorkbenchConfigOptionFieldset;var WorkbenchConfigOptionActionset=function(){function WorkbenchConfigOptionActionset(e,t,s,l,o,i,a,n){this.backend=e,this.broadcast=t,this.language=s,this.metadata=l,this.modelutilities=o,this.toast=i,this.cdRef=a,this.view=n,this.configValues=[],this.option={},this.modules=[],this.module="",this.actionsets=[],this.showInfo=!1}return WorkbenchConfigOptionActionset.prototype.ngAfterViewInit=function(){this.actionsets=this.metadata.getActionSets(),this.modules=this.metadata.getModules(),this.modules.sort(),this.configValues[this.option.option]&&(this.module=this.metadata.getActionSet(this.configValues[this.option.option]).module),this.cdRef.detectChanges()},WorkbenchConfigOptionActionset=__decorate([core_1.Component({selector:"workbench-config-option-actionset",template:'<div class="slds-form-element slds-m-vertical--xxx-small" style="clear: both"><label class="slds-form-element__label slds-float_left" style="margin-right: 3px;">{{option.option}}</label><div *ngIf="option.description.length > 0" class="slds-float_left" style="position: relative; margin-right: 5px; margin-top: 3px;"><div class="slds-form-element"><div class="slds-form-element__icon slds-align-middle"><button class="slds-button slds-button_icon slds-button slds-button_icon" aria-describedby="help" title="Description" (mouseenter)="showInfo = true" (mouseleave)="showInfo = false"><system-button-icon [size]="\'small\'" [icon]="\'info\'"></system-button-icon></button></div></div><div *ngIf="showInfo" class="slds-popover slds-popover_tooltip slds-nubbin_bottom-right slds-rise-from-ground" role="tooltip" id="help" style="position: absolute; bottom: 25px; right: -17px; width: 320px; height: auto;"><div class="slds-popover__body slds-scrollable_y">{{option.description}}</div></div></div><div class="slds-grid" style="clear: both;"><div class="slds-form-element__control slds-p-right--xxx-small slds-size--1-of-3"><div class="slds-select_container"><select [disabled]="!view.isEditMode()" class="slds-select" [(ngModel)]="module"><option value="*">*</option><option *ngFor="let module of modules" [value]="module">{{module}}</option></select></div></div><div class="slds-form-element__control slds-p-left--xxx-small slds-size--2-of-3"><div class="slds-select_container"><select [disabled]="!module || !view.isEditMode()" class="slds-select" [(ngModel)]="configValues[option.option]"><option></option><optgroup label="custom" *ngIf="actionsets|componentsetmanagermodulepipecustom:module.length > 0"><option *ngFor="let actionset of actionsets|componentsetmanagermodulepipecustom:module" [value]="actionset.id">{{actionset.name}}</option></optgroup><optgroup label="global" *ngIf="actionsets|componentsetmanagermodulepipeglobal:module.length > 0"><option *ngFor="let actionset of actionsets|componentsetmanagermodulepipeglobal:module" [value]="actionset.id">{{actionset.name}}</option></optgroup></select></div></div></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_5.broadcast,services_4.language,services_1.metadata,services_8.modelutilities,services_9.toast,core_1.ChangeDetectorRef,services_7.view])],WorkbenchConfigOptionActionset)}();exports.WorkbenchConfigOptionActionset=WorkbenchConfigOptionActionset;var WorkbenchConfigOptionBoolean=function(){function WorkbenchConfigOptionBoolean(e){this.view=e,this.configValues=[],this.option={},this.objtype="",this.showInfo=!1}return WorkbenchConfigOptionBoolean=__decorate([core_1.Component({selector:"workbench-config-option-boolean",template:'<div class="slds-form-element slds-m-vertical--xxx-small" style="clear: both"><div class="slds-form-element__control"><span class="slds-checkbox"><input [disabled]="!view.isEditMode()" class="slds-float_left" type="checkbox" name="options" [id]="option.option" [(ngModel)]="configValues[option.option]"> <label class="slds-checkbox__label" [attr.for]="option.option"><span class="slds-checkbox_faux" style="margin-right: 5px;"></span> <span class="slds-form-element__label" style="margin-right: 3px;">{{option.option}}</span></label><div *ngIf="option.description.length > 0" class="slds-float_left" style="position: relative; margin-right: 5px; margin-top: 3px;"><div class="slds-form-element"><div class="slds-form-element__icon slds-align-middle"><button class="slds-button slds-button_icon slds-button slds-button_icon" aria-describedby="help" title="Description" (mouseenter)="showInfo = true" (mouseleave)="showInfo = false"><system-button-icon [size]="\'small\'" [icon]="\'info\'"></system-button-icon></button></div></div><div *ngIf="showInfo" class="slds-popover slds-popover_tooltip slds-nubbin_bottom-right slds-rise-from-ground" role="tooltip" id="help" style="position: absolute; bottom: 25px; right: -17px; width: 320px; height: auto;"><div class="slds-popover__body slds-scrollable_y">{{option.description}}</div></div></div></span></div></div>'}),__metadata("design:paramtypes",[services_7.view])],WorkbenchConfigOptionBoolean)}();exports.WorkbenchConfigOptionBoolean=WorkbenchConfigOptionBoolean;var WorkbenchConfigOptionComponentset=function(){function WorkbenchConfigOptionComponentset(e,t,s,l,o,i,a,n){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.broadcast=o,this.toast=i,this.cdRef=a,this.view=n,this.configValues=[],this.option={},this.objtype="",this.componentsets=[],this.modules=[],this.module="",this.showInfo=!1}return WorkbenchConfigOptionComponentset.prototype.ngAfterViewInit=function(){this.componentsets=this.metadata.getComponentSets(),this.modules=this.metadata.getModules(),this.modules.sort(),this.configValues[this.option.option]&&(this.module=this.metadata.getComponentSet(this.configValues[this.option.option]).module),this.cdRef.detectChanges()},WorkbenchConfigOptionComponentset.prototype.getComponentSets=function(){return this.metadata.getComponentSets()},WorkbenchConfigOptionComponentset=__decorate([core_1.Component({selector:"workbench-config-option-componentset",template:'<div class="slds-form-element slds-m-vertical--xxx-small" style="clear: both"><label class="slds-form-element__label slds-float_left" style="margin-right: 3px;">{{option.option}}</label><div *ngIf="option.description.length > 0" class="slds-float_left" style="position: relative; margin-right: 5px; margin-top: 3px;"><div class="slds-form-element"><div class="slds-form-element__icon slds-align-middle"><button class="slds-button slds-button_icon slds-button slds-button_icon" aria-describedby="help" title="Description" (mouseenter)="showInfo = true" (mouseleave)="showInfo = false"><system-button-icon [size]="\'small\'" [icon]="\'info\'"></system-button-icon></button></div></div><div *ngIf="showInfo" class="slds-popover slds-popover_tooltip slds-nubbin_bottom-right slds-rise-from-ground" role="tooltip" id="help" style="position: absolute; bottom: 25px; right: -17px; width: 320px; height: auto;"><div class="slds-popover__body slds-scrollable_y">{{option.description}}</div></div></div><div class="slds-grid" style="clear: both;"><div class="slds-form-element__control slds-p-right--xxx-small slds-size--1-of-3"><div class="slds-select_container"><select [disabled]="!view.isEditMode()" class="slds-select" [(ngModel)]="module"><option value="*">*</option><option *ngFor="let module of modules" [value]="module">{{module}}</option></select></div></div><div class="slds-form-element__control slds-p-left--xxx-small slds-size--2-of-3"><div class="slds-select_container"><select [disabled]="!module || !view.isEditMode()" class="slds-select" [(ngModel)]="configValues[option.option]"><option></option><optgroup label="custom" *ngIf="componentsets|componentsetmanagermodulepipecustom:module.length > 0"><option *ngFor="let componentset of componentsets|componentsetmanagermodulepipecustom:module" [value]="componentset.id">{{componentset.name}}</option></optgroup><optgroup label="global" *ngIf="componentsets|componentsetmanagermodulepipeglobal:module.length > 0"><option *ngFor="let componentset of componentsets|componentsetmanagermodulepipeglobal:module" [value]="componentset.id">{{componentset.name}}</option></optgroup></select></div></div></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_5.broadcast,services_9.toast,core_1.ChangeDetectorRef,services_7.view])],WorkbenchConfigOptionComponentset)}();exports.WorkbenchConfigOptionComponentset=WorkbenchConfigOptionComponentset;var WorkbenchConfigOptionModule=function(){function WorkbenchConfigOptionModule(e,t,s,l,o,i,a,n){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.broadcast=o,this.toast=i,this.cdRef=a,this.view=n,this.configValues=[],this.option={},this.objtype="",this.modules=[],this.showInfo=!1}return WorkbenchConfigOptionModule.prototype.ngAfterViewInit=function(){this.modules=this.metadata.getModules().sort(),this.cdRef.detectChanges()},WorkbenchConfigOptionModule=__decorate([core_1.Component({selector:"workbench-config-option-componentset",template:'<div class="slds-form-element slds-m-vertical--xxx-small" style="clear: both"><label class="slds-form-element__label slds-float_left" style="margin-right: 3px;">{{option.option}}</label><div *ngIf="option.description.length > 0" class="slds-float_left" style="position: relative; margin-top: 3px;"><div class="slds-form-element"><div class="slds-form-element__icon slds-align-middle"><button class="slds-button slds-button_icon slds-button slds-button_icon" aria-describedby="help" title="Description" (mouseenter)="showInfo = true" (mouseleave)="showInfo = false"><system-button-icon [size]="\'small\'" [icon]="\'info\'"></system-button-icon></button></div></div><div *ngIf="showInfo" class="slds-popover slds-popover_tooltip slds-nubbin_bottom-right slds-rise-from-ground" role="tooltip" id="help" style="position: absolute; bottom: 25px; right: -17px; width: 320px; height: auto;"><div class="slds-popover__body slds-scrollable_y">{{option.description}}</div></div></div><div class="slds-form-element__control" style="clear: both;"><div class="slds-select_container"><select [disabled]="!view.isEditMode()" class="slds-select" [(ngModel)]="configValues[option.option]"><option *ngFor="let module of modules" [value]="module">{{module}}</option></select></div></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_8.modelutilities,services_5.broadcast,services_9.toast,core_1.ChangeDetectorRef,services_7.view])],WorkbenchConfigOptionModule)}();exports.WorkbenchConfigOptionModule=WorkbenchConfigOptionModule;var WorkbenchConfigOptionDefault=function(){function WorkbenchConfigOptionDefault(e){this.view=e,this.configValues=[],this.option={},this.showInfo=!1}return WorkbenchConfigOptionDefault=__decorate([core_1.Component({selector:"workbench-config-option-default",template:'<div class="slds-form-element slds-m-vertical--xxx-small" style="clear: both"><label class="slds-form-element__label slds-float_left" style="margin-right: 3px;">{{option.option}}</label><div *ngIf="option.description.length > 0" class="slds-float_left" style="position: relative; margin-top: 3px;"><div class="slds-form-element"><div class="slds-form-element__icon slds-align-middle"><button class="slds-button slds-button_icon slds-button slds-button_icon" aria-describedby="help" title="Description" (mouseenter)="showInfo = true" (mouseleave)="showInfo = false"><system-button-icon [size]="\'small\'" [icon]="\'info\'"></system-button-icon></button></div></div><div *ngIf="showInfo" class="slds-popover slds-popover_tooltip slds-nubbin_bottom-right slds-rise-from-ground" role="tooltip" id="help" style="position: absolute; bottom: 25px; right: -17px; width: 320px; height: auto;"><div class="slds-popover__body slds-scrollable_y">{{option.description}}</div></div></div><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="configValues[option.option]"></div></div>'}),__metadata("design:paramtypes",[services_7.view])],WorkbenchConfigOptionDefault)}();exports.WorkbenchConfigOptionDefault=WorkbenchConfigOptionDefault;var ObjectRepositoryManagerFilter=function(){function e(){}return e.prototype.transform=function(e,t){if(!t)return e;for(var s=[],l=0,o=e;l<o.length;l++){var i=o[l];0<=i.object.toLowerCase().indexOf(t.toLowerCase())&&s.push(i)}return s},e=__decorate([core_1.Pipe({name:"objectrepositorymanagerfilter"})],e)}();exports.ObjectRepositoryManagerFilter=ObjectRepositoryManagerFilter;var ObjectRepositoryManager=function(){function ObjectRepositoryManager(e,t,s,l,o,i,a,n,d){var r=this;this.backend=e,this.metadata=t,this.language=s,this.modalservice=l,this.modelutilities=o,this.modal=i,this.toast=a,this.configurationService=n,this.view=d,this.moduleReposSelect=[],this.moduleRepos=[],this.moduleReposSelectedItem={},this.objrepoList=[],this.configList={},this.currentConfigArray=[],this.objectFilter="",this.fieldTypeList=["string","boolean","fieldset","actionset","componentset","module"],this.newRepo={},this.emptyRepo={component:"",componentconfig:"",description:"",id:"",module:"",object:"",package:""},this.currentModule={},this.newModule={},this.emptyModule={id:"",module:"",path:"",description:"",package:"",version:"",scope:"custom"},this.currentObjRepo={},this.treelist=[],this.edit_mode="custom",this.change_request_required=!1,this.crNoneActive=!1,this.backend.getRequest("configurator/entries/sysuimodulerepository").subscribe(function(e){for(var t=0,s=e;t<s.length;t++){var l=s[t];r.moduleRepos.push(l);var o;o={id:l.id,name:l.module,group:"global"},r.moduleReposSelect.push(o)}r.moduleReposSelect=Object.assign([],r.moduleReposSelect)}),this.backend.getRequest("configurator/entries/sysuicustommodulerepository").subscribe(function(e){for(var t=0,s=e;t<s.length;t++){var l=s[t];r.moduleRepos.push(l);var o;o={id:l.id,name:l.module,group:"custom"},r.moduleReposSelect.push(o)}r.moduleReposSelect=Object.assign([],r.moduleReposSelect)}),this.checkMode()}return ObjectRepositoryManager.prototype.checkMode=function(){var t=this;this.edit_mode=this.configurationService.getCapabilityConfig("core").edit_mode,this.change_request_required=!!this.configurationService.getCapabilityConfig("systemdeployment").change_request_required,"none"!=this.edit_mode&&"custom"!=this.edit_mode&&"all"!=this.edit_mode&&(this.edit_mode="custom"),this.change_request_required?this.backend.getRequest("systemdeploymentcrs/active").subscribe(function(e){""==e.id?(t.setNoneMode(),t.crNoneActive=!0,t.toast.sendToast(t.language.getLabel("LBL_ACTIVATE_CR_WARNING"),"warning",null,3)):(t.crNoneActive=!1,"all"==t.edit_mode?t.setAllMode():"custom"==t.edit_mode?t.setCustomMode():t.setNoneMode())}):(this.crNoneActive=!1,"all"==this.edit_mode?this.setAllMode():"custom"==this.edit_mode?this.setCustomMode():this.setNoneMode())},ObjectRepositoryManager.prototype.setNoneMode=function(){this.view.setViewMode()},ObjectRepositoryManager.prototype.setCustomMode=function(){"custom"==this.currentModule.scope?this.view.setEditMode():this.view.setViewMode()},ObjectRepositoryManager.prototype.setAllMode=function(){this.view.setEditMode()},ObjectRepositoryManager.prototype.selectedOutputItemModule=function(o){var i=this;"global"==o.group?this.backend.getRequest("configurator/entries/sysuiobjectrepository").subscribe(function(e){i.objrepoList=[];for(var t=0,s=e;t<s.length;t++){var l=s[t];o.id==l.module&&i.objrepoList.push(l)}}):"custom"==o.group?this.backend.getRequest("configurator/entries/sysuicustomobjectrepository").subscribe(function(e){i.objrepoList=[];for(var t=0,s=e;t<s.length;t++){var l=s[t];o.id==l.module&&i.objrepoList.push(l)}}):console.error("Damaged item!"),this.objrepoList.sort(function(e,t){return e.object<t.object?1:-1});for(var e=0,t=this.moduleRepos;e<t.length;e++){var s=t[e];s.id==o.id&&(this.currentModule=s,this.currentModule.scope=o.group)}this.checkMode()},ObjectRepositoryManager.prototype.clickObjRepo=function(e){this.currentObjRepo=e,this.currentConfigArray=[];try{this.configList=JSON.parse(this.currentObjRepo.componentconfig);var t=0;for(var s in this.configList)if(this.configList.hasOwnProperty(s)){var l=void 0;l=this.configList[s].description?this.configList[s].description:"";var o={id:t,name:s,type:this.configList[s].type,description:l};this.currentConfigArray.push(o),t++}}catch(e){console.warn("JSON is invalid or empty!")}},ObjectRepositoryManager.prototype.checkCurrentObjRepo=function(e){return this.currentObjRepo.id==e},ObjectRepositoryManager.prototype.addConfig=function(){this.currentConfigArray.push({id:this.currentConfigArray.length+1,name:"",type:""})},ObjectRepositoryManager.prototype.deleteConfig=function(e){this.currentConfigArray.splice(e,1)},ObjectRepositoryManager.prototype.saveChanges=function(){var c=this;this.modal.openModal("SystemLoadingModal").subscribe(function(s){for(var e={},t=!0,l=0,o=c.currentConfigArray.slice();l<o.length;l++){var i=o[l];if(""!=i.type&&""!=i.name){var a={};a.type=i.type;var n="description";i.description?a[n]=i.description:a[n]="",e[i.name]=a}else t=!1}if(t){var d=JSON.stringify(e);c.currentObjRepo.componentconfig=d;var r="";r="global"==c.currentModule.scope?"sysuiobjectrepository":"sysuicustomobjectrepository",c.backend.postRequest("configurator/"+r+"/"+c.currentObjRepo.id,null,c.currentObjRepo).subscribe(function(e){for(var t in c.objrepoList)c.objrepoList[t].id==c.currentObjRepo.id&&(c.objrepoList[t]=c.currentObjRepo);s.instance.self.destroy(),c.toast.sendToast("changes saved")})}else s.instance.self.destroy(),c.toast.sendToast("Empty configuration!")})},ObjectRepositoryManager.prototype.addObjRepo=function(){var s=this;this.modalservice.openModal("ObjectRepositoryManagerAddRepo").subscribe(function(e){s.newRepo=__assign({},s.emptyRepo),e.instance.objRepo=s.newRepo,e.instance.closedialog.subscribe(function(e){e&&s.modal.openModal("SystemLoadingModal").subscribe(function(t){s.newRepo.id=s.modelutilities.generateGuid(),s.newRepo.module=s.currentModule.id;var e="";e="global"==s.currentModule.scope?"sysuiobjectrepository":"sysuicustomobjectrepository",s.backend.postRequest("configurator/"+e+"/"+s.newRepo.id,null,s.newRepo).subscribe(function(e){s.objrepoList.push(s.newRepo),s.currentObjRepo=s.newRepo,t.instance.self.destroy(),s.toast.sendToast("changes saved")})})})})},ObjectRepositoryManager.prototype.addModalRepo=function(d){var r=this;void 0===d&&(d="add"),this.modalservice.openModal("ObjectRepositoryManagerAddModule").subscribe(function(e){e.instance.moduleRepo=(r.newModule=__assign({},"edit"==d?r.currentModule:r.emptyModule),r.newModule),e.instance.mode=d,e.instance.edit_mode=r.edit_mode,e.instance.closedialog.subscribe(function(e){e&&r.modal.openModal("SystemLoadingModal").subscribe(function(a){""==r.newModule.id&&(r.newModule.id=r.modelutilities.generateGuid());var e="",n="";n="global"==r.newModule.scope?(e="sysuimodulerepository","global"):(e="sysuicustommodulerepository","custom"),delete r.newModule.scope,r.backend.postRequest("configurator/"+e+"/"+r.newModule.id,null,r.newModule).subscribe(function(e){var t={id:r.newModule.id,name:r.newModule.module,group:n};if(r.newModule.scope=n,"add"==d)r.moduleReposSelect.push(t),r.moduleRepos.push(r.newModule),r.selectedOutputItemModule(t);else{for(var s in r.moduleReposSelect)r.moduleReposSelect[s].id==t.id&&(r.moduleReposSelect[s]=t);for(var l=0,o=r.moduleRepos;l<o.length;l++){var i=o[l];i.id==r.newModule.id&&(i=r.newModule)}}r.currentModule=r.newModule,r.moduleReposSelect=Object.assign([],r.moduleReposSelect),r.moduleReposSelectedItem=t,a.instance.self.destroy(),r.toast.sendToast("changes saved")})})})})},ObjectRepositoryManager.prototype.editModalRepo=function(){this.addModalRepo("edit")},ObjectRepositoryManager.prototype.updateField=function(e){console.log("event",e),this.currentObjRepo.description=e},ObjectRepositoryManager=__decorate([core_1.Component({template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><label class="slds-form-element__label">Module</label><div style="width:400px" class="slds-form-element__control"><system-select style="width:100%" [selectList]="moduleReposSelect" [(selectedItem)]="moduleReposSelectedItem" (selectedOutputItem)="selectedOutputItemModule($event)"></system-select></div></div><div class="slds-form-element slds-col--bump-left"><button [disabled]="!view.isEditMode()" *ngIf="(currentModule | json) != \'{}\'" type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="editModalRepo()"><system-utility-icon [icon]="\'edit\'" [size]="\'x-small\'"></system-utility-icon></button> <button [disabled]="edit_mode == \'none\'" type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="addModalRepo()"><system-utility-icon [icon]="\'add\'" [size]="\'x-small\'"></system-utility-icon></button></div></div><div class="slds-grid"><div class="slds-size--2-of-5 slds-p-horizontal--small slds-border--right"><div *ngIf="(currentModule | json) != \'{}\'" class="slds-p-around--small slds-grid slds-grid_align-spread slds-grid_vertical-align-center slds-gutters"><div class="slds-grow slds-form-element__control slds-input-has-icon slds-input-has-icon_right slds-p-right--xx-small"><system-utility-icon icon="filterList" addclasses="slds-input__icon slds-input__icon--left"></system-utility-icon><input class="slds-input" type="text" [(ngModel)]="objectFilter"></div><button [disabled]="!view.isEditMode()" class="slds-button slds-button_neutral" (click)="addObjRepo()">{{language.getLabel(\'LBL_ADD\')}}</button></div><ul class="slds-has-dividers_around-space"><li class="slds-item" *ngFor="let objrepoItem of objrepoList|objectrepositorymanagerfilter:objectFilter" (click)="clickObjRepo(objrepoItem)" [ngClass]="{\'slds-theme--shade\': checkCurrentObjRepo(objrepoItem.id)}">{{objrepoItem.object}}</li></ul></div><div *ngIf="(currentObjRepo | json) != \'{}\'" class="slds-size--3-of-5 slds-p-horizontal--small"><div class="slds-form-element slds-m-vertical_medium"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_OBJECT\')}}</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [ngModel]="currentObjRepo.object"></div></div><div class="slds-form-element slds-m-vertical_medium"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_COMPONENT\')}}</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [ngModel]="currentObjRepo.component"></div></div><div *ngIf="view.isEditMode()" class="slds-form-element slds-m-vertical_medium"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_DESCRIPTION\')}}</label><div class="slds-form-element__control"><system-richtext-editor [(ngModel)]="currentObjRepo.description"></system-richtext-editor></div></div><div *ngIf="!view.isEditMode()" class="slds-form-element slds-m-vertical_medium"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_DESCRIPTION\')}}</label><div class="slds-form-element__control slds-box slds-scrollable_y" style="background-color: #ecebea; background-color: #ecebea; max-height: 300px;"><iframe [(srcdoc)]="currentObjRepo.description" width="100%" height="100%" frameborder="0" seamless></iframe></div></div><div class="slds-table_edit_container slds-is-relative"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_CONFIGURATION\')}}</label><table class="slds-table slds-table_bordered" role="grid" style="width: 100%;"><thead><tr class="slds-line-height_reset"><th scope="col"><span class="slds-truncate" title="Name">{{language.getAppLanglabel(\'LBL_NAME\')}}</span></th><th scope="col"><span class="slds-truncate" title="Name">{{language.getAppLanglabel(\'LBL_TYPE\')}}</span></th><th scope="col"><span class="slds-truncate" title="Name">{{language.getAppLanglabel(\'LBL_DESCRIPTION\')}}</span></th><th scope="col"></th></tr></thead><tbody><ng-container *ngFor="let currentConfig of currentConfigArray; index as i"><tr class="slds-hint-parent"><td class="slds-cell-edit" role="gridcell" style="width: 30%;"><span class="slds-grid slds-grid_align-spread"><div class="slds-form-element__control" style="width: 100%;"><input [disabled]="!view.isEditMode()" aria-describedby="error-message" type="text" class="slds-input" [(ngModel)]="currentConfig.name"></div></span></td><td class="slds-cell-edit" role="gridcell" style="width: 12%;"><span class="slds-grid slds-grid_align-spread"><div class="slds-form-element__control"><div class="slds-select_container"><select [disabled]="!view.isEditMode()" class="slds-select" [(ngModel)]="currentConfig.type"><option *ngFor="let fieldType of fieldTypeList" [value]="fieldType">{{fieldType}}</option></select></div></div></span></td><td class="slds-cell-edit" role="gridcell" style="width: 100%;"><span class="slds-grid slds-grid_align-spread"><div class="slds-form-element__control" style="width: 100%;"><input [disabled]="!view.isEditMode()" aria-describedby="error-message" type="text" class="slds-input" [(ngModel)]="currentConfig.description"></div></span></td><td class="slds-cell-edit" role="gridcell"><div class="slds-p-around--small slds-align--absolute-center slds-float_right"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="delete item" (click)="deleteConfig(i)"><system-button-icon [icon]="\'delete\'"></system-button-icon></button></div></td></tr></ng-container></tbody></table><div class="slds-p-around--small slds-align--absolute-center slds-border--bottom"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="add item" (click)="addConfig()"><system-button-icon [icon]="\'new\'"></system-button-icon></button></div></div><div class="slds-text-align--right slds-p-vertical--x-small"><button [disabled]="!view.isEditMode()" type="button" class="slds-button slds-button--brand" (click)="saveChanges()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></div></div>',providers:[services_7.view]}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_3.modal,services_8.modelutilities,services_3.modal,services_9.toast,services_12.configurationService,services_7.view])],ObjectRepositoryManager)}();exports.ObjectRepositoryManager=ObjectRepositoryManager;var ObjectRepositoryManagerAddRepo=function(){function ObjectRepositoryManagerAddRepo(e,t,s){this.backend=e,this.language=t,this.modelutilities=s,this.closedialog=new core_1.EventEmitter,this.objRepo={component:"",componentconfig:"",description:"",id:"",module:"",object:"",package:""},this.currentObject="",this.currentComponent="",this.addType="fieldsetadd",this.addName="",this.addFieldset="",this.fieldsettype="custom",this.moduleFields=[]}return ObjectRepositoryManagerAddRepo.prototype.ngOnInit=function(){},ObjectRepositoryManagerAddRepo.prototype.closeDialog=function(){this.self.destroy()},ObjectRepositoryManagerAddRepo.prototype.onModalEscX=function(){this.closeDialog()},ObjectRepositoryManagerAddRepo.prototype.add=function(){this.closedialog.emit(!0),this.self.destroy()},ObjectRepositoryManagerAddRepo.prototype.copyObject=function(){this.objRepo.component=this.objRepo.object},__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],ObjectRepositoryManagerAddRepo.prototype,"closedialog",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ObjectRepositoryManagerAddRepo.prototype,"objRepo",void 0),ObjectRepositoryManagerAddRepo=__decorate([core_1.Component({selector:"objectrepositorymanager-add-repo",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium">{{language.getAppLanglabel(\'LBL_ADD_REPOSITORY\')}}</h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_OBJECT\')}}</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="objRepo.object"></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label" for="text-input-id-1">{{language.getAppLanglabel(\'LBL_COMPONENT\')}}</label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right slds-input-has-icon_group-right"><input type="text" id="text-input-id-1" class="slds-input" [(ngModel)]="objRepo.component"><div class="slds-input__icon-group slds-input__icon-group_right"><button class="slds-button slds-button--icon" title="add item" (click)="copyObject()"><system-utility-icon [icon]="\'redo\'" [size]="\'xx-small\'" [addclasses]="\'slds-section__title-action-icon slds-button__icon slds-button__icon_left\'"></system-utility-icon></button></div></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()">{{language.getAppLanglabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" (click)="add()">{{language.getAppLanglabel(\'LBL_ADD\')}}</button></div></div></div>'}),__metadata("design:paramtypes",[services_6.backend,services_4.language,services_8.modelutilities])],ObjectRepositoryManagerAddRepo)}();exports.ObjectRepositoryManagerAddRepo=ObjectRepositoryManagerAddRepo;var ObjectRepositoryManagerAddModule=function(){function ObjectRepositoryManagerAddModule(e,t,s){this.backend=e,this.language=t,this.modelutilities=s,this.closedialog=new core_1.EventEmitter,this.mode="add",this.edit_mode="custom",this.moduleRepo={id:"",module:"",path:"",description:"",package:"",version:"",scope:"custom"},this.scopes=["custom","global"]}return ObjectRepositoryManagerAddModule.prototype.ngOnInit=function(){"custom"==this.edit_mode?this.scopes=["custom"]:this.scopes=["custom","global"]},ObjectRepositoryManagerAddModule.prototype.closeDialog=function(){this.self.destroy()},ObjectRepositoryManagerAddModule.prototype.onModalEscX=function(){this.closeDialog()},ObjectRepositoryManagerAddModule.prototype.add=function(){this.closedialog.emit(!0),this.self.destroy()},ObjectRepositoryManagerAddModule.prototype.updateField=function(e){this.moduleRepo.description=e},__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],ObjectRepositoryManagerAddModule.prototype,"closedialog",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ObjectRepositoryManagerAddModule.prototype,"mode",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ObjectRepositoryManagerAddModule.prototype,"edit_mode",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ObjectRepositoryManagerAddModule.prototype,"moduleRepo",void 0),ObjectRepositoryManagerAddModule=__decorate([core_1.Component({selector:"objectrepositorymanager-add-module",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 *ngIf="mode == \'add\'" id="header43" class="slds-text-heading--medium">{{language.getAppLanglabel(\'LBL_ADD_Module\')}}</h2><h2 *ngIf="mode == \'edit\'" id="header44" class="slds-text-heading--medium">{{language.getAppLanglabel(\'LBL_EDIT_Module\')}}</h2></div><div class="slds-modal__content slds-p-around--medium"><div *ngIf="mode == \'add\'" class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">Scope</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="moduleRepo.scope"><option *ngFor="let scope of scopes" [ngValue]="scope">{{scope}}</option></select></div></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_NAME\')}}</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="moduleRepo.module"></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_PATH\')}}</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="moduleRepo.path"></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">{{language.getAppLanglabel(\'LBL_DESCRIPTION\')}}</label><div class="slds-form-element__control"><system-richtext-editor [(ngModel)]="moduleRepo.description"></system-richtext-editor></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()">{{language.getAppLanglabel(\'LBL_CANCEL\')}}</button> <button *ngIf="mode == \'add\'" class="slds-button slds-button--brand" (click)="add()">{{language.getAppLanglabel(\'LBL_ADD\')}}</button> <button *ngIf="mode == \'edit\'" class="slds-button slds-button--brand" (click)="add()">{{language.getAppLanglabel(\'LBL_SAVE\')}}</button></div></div></div>',styles:[":host >>> .mce-ico{font-size: 12px; color: #54698d;}",":host >>> .mce-text{font-size: 12px; color: #54698d;}",":host >>> .mce-btn button{font-size: 12px; color: #54698d;}",":host >>> .mce-tinymce{border-radius: 4px}",":host >>> .mce-widget{font-family: 'Titillium Web', sans-serif;}"]}),__metadata("design:paramtypes",[services_6.backend,services_4.language,services_8.modelutilities])],ObjectRepositoryManagerAddModule)}();exports.ObjectRepositoryManagerAddModule=ObjectRepositoryManagerAddModule;var CRMLogViewer=function(){function CRMLogViewer(e,t,s,l,o,i){this.backend=e,this.metadata=t,this.lang=s,this.prefs=l,this.modalservice=o,this.toast=i,this.routeBase="crmlog",this.levels=["debug","info","warn","deprecated","error","fatal","security"],this.limit="5000",this.linesPerPage=20,this.lines=[],this.linesToShow=[],this.userlistIndexes={},this.currPage=1,this.filter={level:"fatal",processId:"",userId:""},this.period={year:"",month:"",day:"",hour:""},this.filtertext="",this.isLoading=!1,this.isLoaded=!1,this.isBuildingTextfilter=!1,this.yearNow=(new Date).getFullYear().toString()}return CRMLogViewer.prototype.getUsername=function(e){return e&&this.userlistIndexes.hasOwnProperty(e)?this.userlist[this.userlistIndexes[e]].user_name:e},CRMLogViewer.prototype.loadData=function(){var s=this;if(this.canLoad()){var e=this.routeBase;this.isLoading=!0,this.isLoaded=!1,this.linesToShow=[],this.period.year.length&&(this.period.month.length?this.period.day.length?this.period.hour.length?e+="/day/"+this.period.year+this.period.month+this.period.day+"/hour/"+this.period.hour:e+="/day/"+this.period.year+this.period.month+this.period.day:e+="/month/"+this.period.year+this.period.month:e+="/year/"+this.period.year);var t={limit:this.limit.length?this.limit:void 0,level:this.filter.level.length?this.filter.level:void 0,processId:this.filter.processId.length?this.filter.processId:void 0,userId:this.filter.userId.length?this.filter.userId:void 0};this.backend.getRequest(e,t).subscribe(function(e){s.lines=e.lines.reverse(),s.lines.forEach(function(e,t){e.date=moment.unix(e.dtx).tz(s.prefs.toUse.timezone).format(s.prefs.getDateFormat()),e.time=moment.unix(e.dtx).tz(s.prefs.toUse.timezone).format(s.prefs.getTimeFormat()),e.i=t}),s.doTextFilter(),s.isLoaded=!0,s.isLoading=!1},function(e){s.toast.sendToast("Error loading log data!","error",null,!1),s.isLoading=!1})}},CRMLogViewer.prototype.canLoad=function(){return!(this.period.year.length&&!this.period.year.match(/^\d{4}$/))&&(!(this.filter.processId.length&&!this.filter.processId.match(/\d$/))&&!(this.limit.length&&!this.limit.match(/\d$/)))},CRMLogViewer.prototype.ngAfterViewChecked=function(){var e;this.tbody&&this.tbody.nativeElement&&(e=this.tbody.nativeElement.childNodes)&&e.forEach(function(e){if(!("TR"!==e.tagName||e.childNodes.length<2)){var t=e.childNodes[5].childNodes[0];e.childNodes[6].childNodes[0].style.visibility=t.scrollWidth===t.clientWidth?"hidden":"auto"}})},CRMLogViewer.prototype.buttonLoad=function(){this.loadData()},CRMLogViewer.prototype.daysInMonth=function(e,t){return new Date(t,e,0).getDate()},Object.defineProperty(CRMLogViewer.prototype,"daylist",{get:function(){for(var e=[],t=1;t<=this.daysInMonth(parseInt(this.period.month,10),parseInt(this.period.year,10));t++)e.push((t<10?"0":"")+t);return e},enumerable:!0,configurable:!0}),CRMLogViewer.prototype.checkYear=function(){return this.period.year.match(/^\d{4}$/)},CRMLogViewer.prototype.showLineInModal=function(t){var s=this;this.modalservice.openModal("CRMLogViewerModal").subscribe(function(e){e.instance.line=s.linesToShow[t],e.instance.username=s.getUsername(s.linesToShow[t].uid),e.instance.routeBase=s.routeBase})},CRMLogViewer.prototype.doTextFilter=function(){this.filtertext.length?this.lines.length&&this.buildLinesToShow():this.isFiltered&&this.clearTextFilter()},CRMLogViewer.prototype.buildLinesToShow=function(){var t=this;this.isBuildingTextfilter=!0,this.linesToShow=[],this.lines.forEach(function(e){-1!==e.txt.toLowerCase().indexOf(t.filtertext.toLowerCase())&&t.linesToShow.push(e)}),this.currPage=1,window.setTimeout(function(){return t.isBuildingTextfilter=!1},750)},CRMLogViewer.prototype.clearTextFilter=function(){this.filtertext="",this.isFiltered&&this.resetLinesToShow()},CRMLogViewer.prototype.resetLinesToShow=function(){var t=this;this.isBuildingTextfilter=!0,this.linesToShow=[],this.lines.forEach(function(e){t.linesToShow.push(e)}),this.currPage=1,window.setTimeout(function(){return t.isBuildingTextfilter=!1},750)},Object.defineProperty(CRMLogViewer.prototype,"isFiltered",{get:function(){return this.lines.length!=this.linesToShow.length},enumerable:!0,configurable:!0}),CRMLogViewer.prototype.collapseLinesOfPage=function(e){for(var t=(e-1)*this.linesPerPage;t<e*this.linesPerPage;t++)this.lines[t].expand=!1},__decorate([core_1.ViewChild("tbody"),__metadata("design:type",core_1.ElementRef)],CRMLogViewer.prototype,"tbody",void 0),CRMLogViewer=__decorate([core_1.Component({template:'<h2 class="slds-m-horizontal--medium slds-m-top--medium slds-m-bottom--small slds-text-heading--medium">CRM Log Viewer (BETA)</h2><div class="slds-grid slds-grid--vertical-align-end slds-m-horizontal--medium slds-m-bottom--medium slds-m-top--small"><div class="slds-col_bump-right"><div class="slds-grid slds-grid--vertical-align-end"><div class="slds-form-element slds-m-right--x-small"><label class="slds-form-element__label" for="year">{{lang.getLabel(\'LBL_YEAR\')}}</label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input id="year" class="slds-input slds-text-align--right" size="4" type="text" maxlength="4" trim [(ngModel)]="period.year" (change)="period.year"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="period.year=\'\'"><svg class="slds-button__icon slds-icon-text-light" aria-hidden="true"><use xlink:href="./sldassets/icons/utility-sprite/svg/symbols.svg#clear" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg></button></div></div><div class="slds-m-right--x-small"><button class="slds-button slds-button_outline-brand" (click)="period.year=yearNow">{{yearNow}}</button></div><div class="slds-form-element slds-m-right--x-small"><label class="slds-form-element__label" for="month">{{lang.getLabel(\'LBL_MONTH\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" id="month" [(ngModel)]="period.month" [disabled]="!checkYear()"><option></option><option value="01">{{lang.getLabel(\'LBL_JAN\')}}</option><option value="02">{{lang.getLabel(\'LBL_FEB\')}}</option><option value="03">{{lang.getLabel(\'LBL_MAR\')}}</option><option value="04">{{lang.getLabel(\'LBL_APR\')}}</option><option value="05">{{lang.getLabel(\'LBL_MAY\')}}</option><option value="06">{{lang.getLabel(\'LBL_JUN\')}}</option><option value="07">{{lang.getLabel(\'LBL_JUL\')}}</option><option value="08">{{lang.getLabel(\'LBL_AUG\')}}</option><option value="09">{{lang.getLabel(\'LBL_SEP\')}}</option><option value="10">{{lang.getLabel(\'LBL_OCT\')}}</option><option value="11">{{lang.getLabel(\'LBL_NOV\')}}</option><option value="12">{{lang.getLabel(\'LBL_DEC\')}}</option></select></div></div></div><div class="slds-form-element slds-m-right--x-small"><label class="slds-form-element__label" for="day">{{lang.getLabel(\'LBL_DAY\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" id="day" [(ngModel)]="period.day" [disabled]="!checkYear() || period.month===\'\'"><option></option><option *ngFor="let day of daylist">{{day}}</option></select></div></div></div><div class="slds-form-element"><label class="slds-form-element__label" for="hour">{{lang.getLabel(\'LBL_HOUR\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" id="hour" [(ngModel)]="period.hour" [disabled]="!checkYear() || period.day===\'\'"><option></option><option *ngFor="let hour of [ \'00\',\'01\',\'02\',\'03\',\'04\',\'05\',\'06\',\'07\',\'08\',\'09\',\'10\',\'11\',\'12\',\'13\',\'14\',\'15\',\'16\',\'17\',\'18\',\'19\',\'20\',\'21\',\'22\',\'23\' ]">{{hour}}</option></select></div></div></div></div><div class="slds-grid slds-grid--vertical-align-end slds-m-top--xxx-small"><div class="slds-form-element slds-m-right--x-small"><label class="slds-form-element__label" for="processId">{{lang.getLabel(\'LBL_PROCESS_ID\')}}</label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input id="processId" class="slds-input slds-text-align--right" type="text" size="5" trim [(ngModel)]="filter.processId"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="filter.processId=\'\'"><svg class="slds-button__icon slds-icon-text-light" aria-hidden="true"><use xlink:href="./sldassets/icons/utility-sprite/svg/symbols.svg#clear" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg></button></div></div><div class="slds-form-element slds-m-right--x-small"><label class="slds-form-element__label" for="user">{{lang.getLabel(\'LBL_USER\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" id="user" [(ngModel)]="filter.userId"><option></option><option *ngFor="let user of userlist" value="{{user.id}}">{{user.user_name}}</option><option value="-none-">-none-</option></select></div></div></div><div class="slds-form-element slds-m-right--x-small"><label class="slds-form-element__label" for="level">{{lang.getLabel(\'LBL_LEVEL\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" id="level" [(ngModel)]="filter.level"><option></option><option *ngFor="let level of levels" value="{{level}}">{{level}}</option></select></div></div></div><div class="slds-form-element slds-m-right--large"><label class="slds-form-element__label" for="level">Zeilenlimit</label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input id="limit" class="slds-input slds-text-align--right" type="text" size="8" trim [(ngModel)]="limit"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="limit=\'\'"><svg class="slds-button__icon slds-icon-text-light" aria-hidden="true"><use xlink:href="./sldassets/icons/utility-sprite/svg/symbols.svg#clear" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg></button></div></div><div><button class="slds-button slds-button--brand" (click)="buttonLoad()" [attr.disabled]="!canLoad()?true:null">{{lang.getLabel(\'LBL_LOAD\')}}</button></div></div></div><div class="slds-form-element"><label class="slds-form-element__label" for="level">{{lang.getLabel(\'LBL_TEXT_FILTER\')}} (by client)</label><div class="slds-form-element__control slds-grid"><input id="filtertext" class="slds-input" type="text" trim="blur" [(ngModel)]="filtertext" (keyup.enter)="doTextFilter()"> <button class="slds-button slds-button--icon-border slds-m-left--xx-small" (click)="doTextFilter()" [attr.disabled]="filtertext===\'\'?true:null"><system-button-icon [icon]="\'filterList\'" [size]="\'small\'"></system-button-icon></button> <button class="slds-button slds-button--icon-border" (click)="clearTextFilter()" [attr.disabled]="filtertext===\'\'?true:null"><system-button-icon [icon]="\'clear\'" [size]="\'small\'"></system-button-icon></button></div></div></div><system-spinner *ngIf="isLoading" class="slds-m-top--xx-large" style="display:block"></system-spinner><div *ngIf="isLoaded" class="slds-m-top--large"><div class="slds-m-horizontal--medium slds-m-bottom--small slds-grid"><div *ngIf="isFiltered"><span style="text-transform:uppercase">{{lang.getLabel(\'LBL_FILTERED\')}}</span> ({{lines.length-linesToShow.length}} {{lang.getLabel(\'LBL_NOT_SHOWN\')}})</div><pagination-controls class="slds-col_bump-left" [(page)]="currPage" [limit]="linesPerPage" [total_records]="linesToShow.length" (leftPage)="collapseLinesOfPage($event)"></pagination-controls></div><table class="slds-table slds-table--bordered slds-table--col-bordered slds-table--striped slds-table_cell-buffer" style="max-height:400px" [ngStyle]="{\'opacity\':isBuildingTextfilter?0.25:1}"><thead><tr><th style="width:1%">{{lang.getLabel(\'LBL_DATE\')}}</th><th style="width:1%">{{lang.getLabel(\'LBL_TIME\')}}</th><th style="width:1%" class="slds-text-align--right">PID</th><th style="width:1%">{{lang.getLabel(\'LBL_USER\')}}</th><th style="width:1%">{{lang.getLabel(\'LBL_LEVEL\')}}</th><th style="width:100%">{{lang.getLabel(\'LBL_TEXT\')}}</th><th style="width:2rem;border-left:0"></th><th style="width:2rem;border-left:0"></th></tr></thead><tbody #tbody><tr *ngFor="let line of linesToShow | paginate: { page: currPage, limit: 20 }"><td class="slds-text-align--right">{{line.date}}</td><td class="slds-text-align--right">{{line.time}}</td><td class="slds-text-align--right">{{line.pid}}</td><td>{{getUsername(line.uid)}}</td><td>{{line.lev}}</td><td [ngClass]="{expanded:line.expand,collapsed:!line.expand}"><div class="slds-text-font_monospace" [ngClass]="{\'slds-truncate\':!line.expand}">{{line.txt}}</div></td><td class="slds-p-left--none" style="border-left:0"><button class="slds-button slds-button--icon-border slds-button_icon-small" (click)="line.expand=true"><system-button-icon [icon]="\'threedots\'" [size]="\'small\'"></system-button-icon></button></td><td><button class="slds-button slds-button--icon-border slds-button_icon-small" (click)="showLineInModal(line.i)" [ngClass]="{\'slds-hidden\':!line.txtTruncated}"><system-button-icon [icon]="\'expand\'" [size]="\'medium\'"></system-button-icon></button></td></tr><tr *ngIf="lines.length === 0"><td colspan="8"><div class="slds-p-vertical--x-large slds-text-align--center slds-text-heading--small">Empty list.</div></td></tr><tr *ngIf="isFiltered && linesToShow.length === 0"><td colspan="8" class="slds-p-around--x-large"><div class="slds-p-vertical--x-large slds-text-align--center slds-text-heading--small">Empty list (filter is active).</div></td></tr></tbody></table></div>',styles:["td.expanded { white-space: normal; }","td.collapsed > div { position: absolute; top:0; bottom:0; right:0; left:0; padding: calc(0.25rem + 4px) calc(0.5rem + 0px); }"]}),__metadata("design:paramtypes",[services_6.backend,services_1.metadata,services_4.language,services_14.userpreferences,services_3.modal,services_9.toast])],CRMLogViewer)}();exports.CRMLogViewer=CRMLogViewer;var CRMLogViewerModal=function(){function CRMLogViewerModal(e,t,s){this.language=e,this.backend=t,this.toast=s,this.username="",this.isLoaded=!1,this.isLoading=!0}return CRMLogViewerModal.prototype.ngOnInit=function(){this.line.fullText?this.isLoading=!(this.isLoaded=!0):this.loadFullData()},CRMLogViewerModal.prototype.loadFullData=function(){var t=this;this.backend.getRequest(this.routeBase+"/fullLine/"+this.line.fnr+"/"+this.line.lnr).subscribe(function(e){t.isLoaded=!0,t.isLoading=!1,t.line.fullText=e.line.txt},function(e){t.toast.sendToast("Error loading line of log file!","error","Line "+t.line.lnr+" of log file "+t.line.fnr+" couldnt be fetched.",!1),console.log(e),t.isLoading=!1})},CRMLogViewerModal.prototype.closeModal=function(){this.self.destroy()},CRMLogViewerModal.prototype.onModalEscX=function(){this.closeModal()},__decorate([core_1.Input(),__metadata("design:type",Object)],CRMLogViewerModal.prototype,"line",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],CRMLogViewerModal.prototype,"username",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],CRMLogViewerModal.prototype,"routeBase",void 0),CRMLogViewerModal=__decorate([core_1.Component({template:'<system-modal size="large"><system-modal-header (close)="closeModal()">{{line.date}}  {{line.time}}  {{line.pid}}  {{username}}  {{line.lev}}</system-modal-header><system-modal-content style="height:100%"><system-spinner *ngIf="isLoading" class="slds-m-top--medium" style="display:block"></system-spinner><div *ngIf="isLoaded" class="slds-m-bottom--x-small slds-m-horizontal--x-small slds-text-font_monospace" style="overflow-wrap:break-word">{{line.fullText}}</div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="closeModal()">{{language.getLabel(\'LBL_CLOSE\')}}</button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_4.language,services_6.backend,services_9.toast])],CRMLogViewerModal)}();exports.CRMLogViewerModal=CRMLogViewerModal;var PackageLoader=function(){function PackageLoader(e,t,s,l){var d=this;this.language=e,this.backend=t,this.toast=s,this.metadata=l,this.scope="packages",this.loading=!0,this.packagefilterterm="",this.packages=[],this.versions=[],this.languages=[],this.opencrs=!1,this.errorpackages=[],this.backend.getRequest("/packages").subscribe(function(e){d.loading=!1;try{for(var s=d.language.getAvialableLanguages(!0),t=function(t){s.some(function(e){if(e.language==t.language_code)return t.installed=!0}),d.languages.push(t)},l=0,o=e.languages;l<o.length;l++){t(o[l])}for(var i=0,a=e.packages;i<a.length;i++){var n=a[i];n.installed=0<=e.loaded.packages.indexOf(n.package),d.packages.push(n),e.loaded.packages.splice(e.loaded.packages.indexOf(n.package),1)}d.versions=e.versions,d.opencrs=e.opencrs,d.errorpackages=e.loaded.packages}catch(e){console.error(e)}},function(e){d.loading=!1})}return Object.defineProperty(PackageLoader.prototype,"errorpackagesdisplay",{get:function(){return this.errorpackages.join(", ")},enumerable:!0,configurable:!0}),PackageLoader=__decorate([core_1.Component({selector:"package-loader",template:'<div class="slds-p-around--medium slds-theme--shade"><div class="slds-page-header__row"><div class="slds-page-header__col-title"><div class="slds-media"><system-icon icon="custom19" sprite="custom"></system-icon><div class="slds-media__body"><div class="slds-page-header__name"><div class="slds-page-header__name-title"><h1><span class="slds-page-header__title slds-truncate">{{language.getLabel(\'LBL_PACKAGE_LOADER\')}}</span></h1></div></div><div class="slds-page-header__name-meta slds-grid"><div *ngIf="opencrs" class="slds-grid slds-grid_vertical-align-center slds-p-right--small"><system-icon addclasses="slds-icon slds-icon-text-warning" divClass icon="warning" sprite="utility" size="xx-small"></system-icon><span class="slds-p-left--xx-small">open change Requests</span></div><div *ngIf="errorpackages.length > 0" class="slds-grid slds-grid_vertical-align-center"><system-icon addclasses="slds-icon slds-icon-text-warning" divClass icon="warning" sprite="utility" size="xx-small"></system-icon><span class="slds-p-left--xx-small">erroneous packages: {{errorpackagesdisplay}}</span></div></div></div></div></div></div></div><div *ngIf="!loading" class="slds-theme--default"><ul class="slds-tabs_default__nav" role="tablist"><li class="slds-tabs_default__item" [ngClass]="{\'slds-is-active\':scope == \'packages\'}" [title]="language.getLabel(\'LBL_PACKAGES\')" role="presentation"><a class="slds-tabs_default__link" href="javascript:void(0);" role="tab" tabindex="0" (click)="scope=\'packages\'">{{language.getLabel(\'LBL_PACKAGES\')}}</a></li><li class="slds-tabs_default__item" [ngClass]="{\'slds-is-active\':scope == \'languages\'}" title="language.getLabel(\'LBL_LANGUAGES\')" role="presentation"><a class="slds-tabs_default__link" href="javascript:void(0);" role="tab" tabindex="0" (click)="scope=\'languages\'">{{language.getLabel(\'LBL_LANGUAGES\')}}</a></li></ul><package-loader-packages [ngClass]="{\'slds-show\': scope == \'packages\', \'slds-hide\': scope != \'packages\'}" [packages]="packages"></package-loader-packages><package-loader-languages [ngClass]="{\'slds-show\': scope == \'languages\', \'slds-hide\': scope != \'languages\'}" [languages]="languages"></package-loader-languages></div><div tobottom class="slds-align_absolute-center" *ngIf="loading"><div class="slds-grid slds-grid_vertical-align-center"><system-spinner size="16"></system-spinner><div class="slds-p-horizontal--small">{{language.getLabel(\'LBL_RETRIEVING_PACKAGES\')}}</div></div></div>'}),__metadata("design:paramtypes",[services_4.language,services_6.backend,services_9.toast,services_1.metadata])],PackageLoader)}();exports.PackageLoader=PackageLoader;var PackageLoaderPipe=function(){function e(){}return e.prototype.transform=function(e,t){if(!t)return e;for(var s=[],l=0,o=e;l<o.length;l++){var i=o[l];0<=i.name.toLowerCase().indexOf(t.toLowerCase())&&s.push(i)}return s},e=__decorate([core_1.Pipe({name:"packageloaderpipe"})],e)}();exports.PackageLoaderPipe=PackageLoaderPipe;var PackageLoaderPackages=function(){function e(e){this.language=e,this.packagefilterterm="",this.packages=[]}return __decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"packages",void 0),e=__decorate([core_1.Component({selector:"package-loader-packages",template:'<div tobottom role="tabpanel"><div class="slds-p-vertical--x-small slds-p-horizontal--xx-small"><div class="slds-form-element"><div class="slds-form-element__control"><input class="slds-input" type="text" [(ngModel)]="packagefilterterm" [placeholder]="language.getLabel(\'LBL_SEARCH\')"></div></div></div><div class="slds-grid slds-wrap"><div class="slds-size--1-of-2 slds-p-around--xx-small" *ngFor="let package of packages|packageloaderpipe:packagefilterterm"><package-loader-package [package]="package"></package-loader-package></div></div></div>'}),__metadata("design:paramtypes",[services_4.language])],e)}();exports.PackageLoaderPackages=PackageLoaderPackages;var PackageLoaderPackage=function(){function e(e,t,s,l,o){this.language=e,this.backend=t,this.configurationService=s,this.loader=l,this.broadcast=o,this.extensions=[],this.disabled=!0,this.loading=""}return e.prototype.ngOnInit=function(){var e=!1;if(this.package.extensions)for(var t=0,s=this.package.extensions.split(",");t<s.length;t++){var l=s[t],o=this.configurationService.checkCapability(l);this.extensions.push({name:l,status:o}),o||(e=!0)}this.disabled=e},e.prototype.loadPackage=function(e){var t=this;this.loading="package",this.backend.getRequest("/packages/package/"+e).subscribe(function(e){t.loading="configuration",t.loader.reloadPrimary().subscribe(function(e){t.package.installed=!0,t.broadcast.broadcastMessage("loader.reloaded"),t.loading=""})})},e.prototype.deletePackage=function(e){var t=this;this.loading="package",this.backend.deleteRequest("/packages/package/"+e).subscribe(function(e){t.loading="configuration",t.loader.reloadPrimary().subscribe(function(e){t.package.installed=!1,t.broadcast.broadcastMessage("loader.reloaded"),t.loading=""})})},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"package",void 0),e=__decorate([core_1.Component({selector:"package-loader-package",template:'<article class="slds-card" [ngClass]="{\'slds-disabled-text\': disabled}"><div [ngClass]="{\'slds-hidden\': loading}"><div class="slds-card__header slds-grid"><header class="slds-media slds-media_center slds-has-flexi-truncate"><system-icon size="small" icon="custom13" sprite="custom" class="slds-p-right--xx-small"></system-icon><div class="slds-media__body"><h2 class="slds-card__header-title"><div class="slds-card__header-link slds-truncate" [title]="package.name">{{package.name}}</div></h2></div><div class="slds-no-flex"><div class="slds-button-group" role="group"><button [disabled]="disabled" *ngIf="!package.installed" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="loadPackage(package.package)"><system-button-icon icon="download"></system-button-icon></button> <button [disabled]="disabled" *ngIf="package.installed && package.package != \'core\'" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="deletePackage(package.package)"><system-button-icon icon="delete"></system-button-icon></button> <button [disabled]="disabled" *ngIf="package.installed" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="loadPackage(package.package)"><system-button-icon icon="refresh"></system-button-icon></button></div></div></header></div><div class="slds-card__body slds-p-horizontal--small"><div class="slds-grid slds-gutters_direct-x-small"><div class="slds-size--1-of-2 slds-col"><div class="slds-text-heading_small slds-p-vertical--xx-small">{{language.getLabel(\'LBL_DETAILS\')}}</div><div class="slds-text-align--justify">{{package.description}}</div></div><div class="slds-size--1-of-2 slds-col"><div class="slds-text-heading_small slds-p-vertical--xx-small">{{language.getLabel(\'LBL_REQUIRED_EXTENSIONS\')}}</div><div class="slds-grid slds-grid_vertical-align-center slds-p-vertical--xxx-small" *ngFor="let extension of extensions"><div class="slds-size--1-of-2">{{extension.name}}</div><div class="slds-size--1-of-2 slds-text-align--right"><system-utility-icon size="xx-small" [icon]="extension.status ? \'check\' : \'close\'"></system-utility-icon></div></div><div class="slds-text-align--center slds-p-around--medium" *ngIf="extensions.length == 0">{{language.getLabel(\'LBL_NO_PREREQUISITES\')}}</div></div></div></div></div><div *ngIf="loading" class="slds-is-absolute__top slds-size_full slds-height_full slds-align_absolute-center"><div *ngIf="loading == \'package\'" class="slds-grid slds-grid_vertical-align-center"><system-spinner size="16"></system-spinner><span class="slds-p-left--small">{{language.getLabel(\'LBL_LOADING\')}}</span></div><global-loader-progress *ngIf="loading == \'configuration\'" class="slds-size_full"></global-loader-progress></div></article>'}),__metadata("design:paramtypes",[services_4.language,services_6.backend,services_12.configurationService,services_15.loader,services_5.broadcast])],e)}();exports.PackageLoaderPackage=PackageLoaderPackage;var PackageLoaderLanguages=function(){function e(){this.languages=[]}return __decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"languages",void 0),e=__decorate([core_1.Component({selector:"package-loader-languages",template:'<div tobottom role="tabpanel"><div class="slds-grid slds-wrap"><div class="slds-size--1-of-2 slds-p-around--xx-small" *ngFor="let language of languages"><package-loader-language [package]="language"></package-loader-language></div></div></div>'})],e)}();exports.PackageLoaderLanguages=PackageLoaderLanguages;var PackageLoaderLanguage=function(){function e(e,t,s,l,o){this.language=e,this.backend=t,this.configurationService=s,this.loader=l,this.broadcast=o,this.loading=!1}return Object.defineProperty(e.prototype,"isDefault",{get:function(){return this.package.language_code==this.language.getDefaultLanguage()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deletedisabled",{get:function(){return this.isDefault||this.package.language_code==this.language.currentlanguage},enumerable:!0,configurable:!0}),e.prototype.setDefault=function(){this.isDefault||this.language.setDefaultLanguage(this.package.language_code)},e.prototype.loadLanguage=function(t){var s=this;this.loading=!0,this.backend.getRequest("/packages/language/"+t).subscribe(function(e){s.loading=!1,e.success&&(s.package.installed=!0,s.language.addAvailableLanguage(e.languages[t]),s.language.currentlanguage==t?s.language.loadLanguage().subscribe(function(e){s.package.installed=!0}):s.package.installed=!0)})},e.prototype.deleteLanguage=function(t){var s=this;this.loading=!0,this.backend.deleteRequest("/packages/language/"+t).subscribe(function(e){s.loading=!1,e&&(s.package.installed=!1,s.language.removeAvailableLanguage(t))})},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"package",void 0),e=__decorate([core_1.Component({selector:"package-loader-language",template:'<article class="slds-card"><div class="slds-card__header slds-grid"><header class="slds-media slds-media_center slds-has-flexi-truncate"><system-icon size="small" icon="custom68" sprite="custom" class="slds-p-right--xx-small"></system-icon><div class="slds-media__body"><h2 class="slds-card__header-title"><div class="slds-card__header-link slds-truncate" [title]="package.language_name">{{package.language_name}}</div></h2></div><div class="slds-no-flex"><system-spinner size="12" *ngIf="loading"></system-spinner><div *ngIf="!loading" class="slds-grid slds-grid_vertical-align-center"><system-custom-icon *ngIf="package.installed" class="slds-p-horizontal--xx-small" size="x-small" [icon]="isDefault ? \'light-bulb-on\' : \'light-bulb-off\'" (click)="setDefault()"></system-custom-icon><div class="slds-button-group" role="group"><button [disabled]="disabled" *ngIf="!package.installed" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="loadLanguage(package.language_code)"><system-button-icon icon="download"></system-button-icon></button> <button [disabled]="deletedisabled" *ngIf="package.installed && !isDefault" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="deleteLanguage(package.language_code)"><system-button-icon icon="delete"></system-button-icon></button> <button [disabled]="disabled" *ngIf="package.installed" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="loadLanguage(package.language_code)"><system-button-icon icon="refresh"></system-button-icon></button></div></div></div></header></div></article>'}),__metadata("design:paramtypes",[services_4.language,services_6.backend,services_12.configurationService,services_15.loader,services_5.broadcast])],e)}();exports.PackageLoaderLanguage=PackageLoaderLanguage;var WorkbenchModule=function(){function WorkbenchModule(e){this.vms=e,this.version="1.0",this.build_date="2018-11-30",e.registerModule(this)}return WorkbenchModule=__decorate([core_1.NgModule({imports:[common_1.CommonModule,forms_1.FormsModule,systemcomponents_1.SystemComponents,directives_1.DirectivesModule,objectfields_1.ObjectFields,globalcomponents_1.GlobalComponents],declarations:[DomainManager,DomainManagerFieldDetails,DictionaryManager,DictionaryManagerItem,DictionaryManagerItemString,DictionaryManagerItemDomain,FieldsetManager,FieldsetManagerFieldsetDetails,FieldsetManagerFieldDetails,FieldsetManagerAddDialog,FieldsetManagerEditDialog,FieldsetManagerCopyDialog,ComponentsetManager,ComponentsetManagerComponentsetDetails,WorkbenchConfigOptionDefault,WorkbenchConfigOptionFieldset,ComponentsetManagerModulePipeCustom,ComponentsetManagerModulePipeGlobal,WorkbenchConfigOptionComponentset,WorkbenchConfigOptionModule,WorkbenchConfigOptionActionset,WorkbenchConfigOptionBoolean,ComponentsetManagerAddDialog,ComponentsetManagerEditDialog,ComponentConfigManager,ComponentConfigManagerComponentDetails,ValidationRulesManager,ValidationRulesConditions,ValidationRulesActions,MaybeJsonPipe,LanguageLabelManagerComponent,LanguageLabelModal,LanguageLabelReferenceConfigForm,LanguageLabelReferenceConfigModal,ComponentConfigManagerComponentDetails,MailboxesManager,LanguageLabelModal,MailboxManagerAddDialog,MailboxesmanagerTestModal,MailboxesmanagerTestIMAPModal,MailboxesImapSmtpTrafficManager,MailboxesMailgunTrafficManager,MailboxesSendgridTrafficManager,MailboxesIMAPSMTPSelectFoldersModal,SortPipe,LabelSelectorComponent,ServiceCategoryManagerComponent,ReferenceConfigManager,ReferenceConfigForm,MailboxesProcessors,SelectTreeComponent,SelectTreeAddDialog,ModuleConfigManager,ModuleConfigAddDialog,WorkbenchConfig,ConfigCleaner,GoogleCalendarManager,ObjectRepositoryManager,ObjectRepositoryManagerFilter,ObjectRepositoryManagerAddRepo,ObjectRepositoryManagerAddModule,PackageLoader,PackageLoaderPipe,PackageLoaderPackages,PackageLoaderPackage,PackageLoaderLanguages,PackageLoaderLanguage,CRMLogViewer,CRMLogViewerModal],entryComponents:[DomainManager,DictionaryManager,FieldsetManager,ComponentsetManager,WorkbenchConfigOptionDefault,WorkbenchConfigOptionFieldset,WorkbenchConfigOptionComponentset,WorkbenchConfigOptionActionset,ComponentConfigManager,ModuleConfigManager,WorkbenchConfig,ObjectRepositoryManager,CRMLogViewer,CRMLogViewerModal],exports:[SortPipe]}),__metadata("design:paramtypes",[services_11.VersionManagerService])],WorkbenchModule)}();exports.WorkbenchModule=WorkbenchModule;